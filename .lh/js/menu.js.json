{
    "sourceFile": "js/menu.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 153,
            "patches": [
                {
                    "date": 1756837676171,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1756935423383,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,12 +18,15 @@\n   }\r\n }\r\n \r\n // --- DESKTOP: hover ---\r\n+// Función para activar eventos en escritorio\r\n function activarEventosDesktop() {\r\n+  // Mostrar el menú cuando el mouse pase por encima\r\n   menuToggle.addEventListener(\"mouseenter\", showMenu);\r\n   nav.addEventListener(\"mouseenter\", showMenu);\r\n \r\n+  // Ocultar el menú cuando el mouse salga de él\r\n   menuToggle.addEventListener(\"mouseleave\", () => {\r\n     setTimeout(() => {\r\n       if (!nav.matches(\":hover\") && !menuToggle.matches(\":hover\")) {\r\n         hideMenu();\r\n@@ -40,33 +43,43 @@\n   });\r\n }\r\n \r\n // --- MOBILE: click ---\r\n+// Función para activar eventos en móvil\r\n function activarEventosMobile() {\r\n   menuToggle.addEventListener(\"click\", () => {\r\n     if (nav.classList.contains(\"active\")) {\r\n       hideMenu();\r\n     } else {\r\n       showMenu();\r\n     }\r\n   });\r\n+\r\n+  // Cerrar el menú cuando el usuario haga clic fuera de él\r\n+  document.addEventListener(\"click\", (e) => {\r\n+    if (!nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n+      hideMenu();\r\n+    }\r\n+  });\r\n }\r\n \r\n-// --- Inicialización según ancho ---\r\n+// --- Inicialización según ancho de la pantalla ---\r\n function inicializarMenu() {\r\n   if (window.innerWidth > 768) {\r\n+    // Activar el comportamiento de escritorio\r\n     activarEventosDesktop();\r\n     hideMenu();\r\n   } else {\r\n+    // Activar el comportamiento de móvil\r\n     activarEventosMobile();\r\n     hideMenu();\r\n   }\r\n }\r\n \r\n-// Ejecutar al cargar\r\n+// Ejecutar al cargar la página\r\n document.addEventListener(\"DOMContentLoaded\", inicializarMenu);\r\n \r\n-// Reajustar al redimensionar\r\n+// Reajustar al redimensionar la ventana\r\n window.addEventListener(\"resize\", () => {\r\n   hideMenu();\r\n   inicializarMenu();\r\n });\r\n"
                },
                {
                    "date": 1756935832183,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,85 +1,46 @@\n // Seleccionamos elementos\r\n const menuToggle = document.getElementById(\"menu-toggle\");\r\n const nav = document.getElementById(\"nav\");\r\n \r\n-// Función para abrir menú\r\n+// Función para abrir el menú\r\n function showMenu() {\r\n   nav.classList.add(\"active\");\r\n   if (window.innerWidth <= 768) {\r\n-    menuToggle.textContent = \"✖\"; // Cambiar icono en móvil\r\n+    menuToggle.textContent = \"✖\"; // Cambiar el ícono en móviles cuando el menú se abre\r\n   }\r\n }\r\n \r\n-// Función para cerrar menú\r\n+// Función para cerrar el menú\r\n function hideMenu() {\r\n   nav.classList.remove(\"active\");\r\n   if (window.innerWidth <= 768) {\r\n-    menuToggle.textContent = \"☰\"; // Restaurar icono en móvil\r\n+    menuToggle.textContent = \"☰\"; // Restaurar el ícono en móviles cuando el menú se cierra\r\n   }\r\n }\r\n \r\n-// --- DESKTOP: hover ---\r\n-// Función para activar eventos en escritorio\r\n-function activarEventosDesktop() {\r\n-  // Mostrar el menú cuando el mouse pase por encima\r\n-  menuToggle.addEventListener(\"mouseenter\", showMenu);\r\n-  nav.addEventListener(\"mouseenter\", showMenu);\r\n-\r\n-  // Ocultar el menú cuando el mouse salga de él\r\n-  menuToggle.addEventListener(\"mouseleave\", () => {\r\n-    setTimeout(() => {\r\n-      if (!nav.matches(\":hover\") && !menuToggle.matches(\":hover\")) {\r\n-        hideMenu();\r\n-      }\r\n-    }, 200);\r\n-  });\r\n-\r\n-  nav.addEventListener(\"mouseleave\", () => {\r\n-    setTimeout(() => {\r\n-      if (!nav.matches(\":hover\") && !menuToggle.matches(\":hover\")) {\r\n-        hideMenu();\r\n-      }\r\n-    }, 200);\r\n-  });\r\n-}\r\n-\r\n-// --- MOBILE: click ---\r\n-// Función para activar eventos en móvil\r\n-function activarEventosMobile() {\r\n-  menuToggle.addEventListener(\"click\", () => {\r\n-    if (nav.classList.contains(\"active\")) {\r\n-      hideMenu();\r\n-    } else {\r\n-      showMenu();\r\n-    }\r\n-  });\r\n-\r\n-  // Cerrar el menú cuando el usuario haga clic fuera de él\r\n-  document.addEventListener(\"click\", (e) => {\r\n-    if (!nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n-      hideMenu();\r\n-    }\r\n-  });\r\n-}\r\n-\r\n-// --- Inicialización según ancho de la pantalla ---\r\n-function inicializarMenu() {\r\n-  if (window.innerWidth > 768) {\r\n-    // Activar el comportamiento de escritorio\r\n-    activarEventosDesktop();\r\n-    hideMenu();\r\n+// Función para manejar el clic en el menú de hamburguesa\r\n+menuToggle.addEventListener(\"click\", () => {\r\n+  if (nav.classList.contains(\"active\")) {\r\n+    hideMenu(); // Si el menú está abierto, lo cierra\r\n   } else {\r\n-    // Activar el comportamiento de móvil\r\n-    activarEventosMobile();\r\n-    hideMenu();\r\n+    showMenu(); // Si el menú está cerrado, lo abre\r\n   }\r\n-}\r\n+});\r\n \r\n-// Ejecutar al cargar la página\r\n-document.addEventListener(\"DOMContentLoaded\", inicializarMenu);\r\n+// Función para cerrar el menú si el usuario hace clic fuera de él\r\n+document.addEventListener(\"click\", (e) => {\r\n+  if (!nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n+    hideMenu(); // Cierra el menú si el clic es fuera del menú y el botón\r\n+  }\r\n+});\r\n \r\n-// Reajustar al redimensionar la ventana\r\n+// Aseguramos que el menú esté cerrado al cargar\r\n+document.addEventListener(\"DOMContentLoaded\", () => {\r\n+  hideMenu();\r\n+});\r\n+\r\n+// Redimensionar la ventana\r\n window.addEventListener(\"resize\", () => {\r\n   hideMenu();\r\n-  inicializarMenu();\r\n+  // Re-ajustar el menú al tamaño de la ventana\r\n });\r\n"
                },
                {
                    "date": 1756936161626,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,42 +5,41 @@\n // Función para abrir el menú\r\n function showMenu() {\r\n   nav.classList.add(\"active\");\r\n   if (window.innerWidth <= 768) {\r\n-    menuToggle.textContent = \"✖\"; // Cambiar el ícono en móviles cuando el menú se abre\r\n+    menuToggle.textContent = \"✖\"; // Cambiar icono a \"✖\" cuando el menú se abre en móviles\r\n   }\r\n }\r\n \r\n // Función para cerrar el menú\r\n function hideMenu() {\r\n   nav.classList.remove(\"active\");\r\n   if (window.innerWidth <= 768) {\r\n-    menuToggle.textContent = \"☰\"; // Restaurar el ícono en móviles cuando el menú se cierra\r\n+    menuToggle.textContent = \"☰\"; // Restaurar icono a \"☰\" cuando el menú se cierra en móviles\r\n   }\r\n }\r\n \r\n-// Función para manejar el clic en el menú de hamburguesa\r\n+// Manejo del clic en el botón de hamburguesa\r\n menuToggle.addEventListener(\"click\", () => {\r\n   if (nav.classList.contains(\"active\")) {\r\n-    hideMenu(); // Si el menú está abierto, lo cierra\r\n+    hideMenu(); // Si el menú está abierto, lo cerramos\r\n   } else {\r\n-    showMenu(); // Si el menú está cerrado, lo abre\r\n+    showMenu(); // Si el menú está cerrado, lo abrimos\r\n   }\r\n });\r\n \r\n-// Función para cerrar el menú si el usuario hace clic fuera de él\r\n+// Cerrar el menú si el usuario hace clic fuera de él\r\n document.addEventListener(\"click\", (e) => {\r\n   if (!nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n-    hideMenu(); // Cierra el menú si el clic es fuera del menú y el botón\r\n+    hideMenu(); // Cierra el menú si el clic es fuera del menú y el botón hamburguesa\r\n   }\r\n });\r\n \r\n // Aseguramos que el menú esté cerrado al cargar\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n   hideMenu();\r\n });\r\n \r\n-// Redimensionar la ventana\r\n+// Reajustar el menú en función del tamaño de la pantalla al redimensionar\r\n window.addEventListener(\"resize\", () => {\r\n-  hideMenu();\r\n-  // Re-ajustar el menú al tamaño de la ventana\r\n+  hideMenu(); // Cierra el menú al cambiar el tamaño de la ventana\r\n });\r\n"
                },
                {
                    "date": 1756936892049,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,45 +1,7 @@\n-// Seleccionamos elementos\r\n-const menuToggle = document.getElementById(\"menu-toggle\");\r\n-const nav = document.getElementById(\"nav\");\r\n+// Mostrar el menú en móviles al hacer clic en el botón hamburguesa\r\n+const menuToggle = document.getElementById('menu-toggle');\r\n+const nav = document.getElementById('nav');\r\n \r\n-// Función para abrir el menú\r\n-function showMenu() {\r\n-  nav.classList.add(\"active\");\r\n-  if (window.innerWidth <= 768) {\r\n-    menuToggle.textContent = \"✖\"; // Cambiar icono a \"✖\" cuando el menú se abre en móviles\r\n-  }\r\n-}\r\n-\r\n-// Función para cerrar el menú\r\n-function hideMenu() {\r\n-  nav.classList.remove(\"active\");\r\n-  if (window.innerWidth <= 768) {\r\n-    menuToggle.textContent = \"☰\"; // Restaurar icono a \"☰\" cuando el menú se cierra en móviles\r\n-  }\r\n-}\r\n-\r\n-// Manejo del clic en el botón de hamburguesa\r\n-menuToggle.addEventListener(\"click\", () => {\r\n-  if (nav.classList.contains(\"active\")) {\r\n-    hideMenu(); // Si el menú está abierto, lo cerramos\r\n-  } else {\r\n-    showMenu(); // Si el menú está cerrado, lo abrimos\r\n-  }\r\n+menuToggle.addEventListener('click', () => {\r\n+  nav.classList.toggle('active'); // Cambia la visibilidad del menú\r\n });\r\n-\r\n-// Cerrar el menú si el usuario hace clic fuera de él\r\n-document.addEventListener(\"click\", (e) => {\r\n-  if (!nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n-    hideMenu(); // Cierra el menú si el clic es fuera del menú y el botón hamburguesa\r\n-  }\r\n-});\r\n-\r\n-// Aseguramos que el menú esté cerrado al cargar\r\n-document.addEventListener(\"DOMContentLoaded\", () => {\r\n-  hideMenu();\r\n-});\r\n-\r\n-// Reajustar el menú en función del tamaño de la pantalla al redimensionar\r\n-window.addEventListener(\"resize\", () => {\r\n-  hideMenu(); // Cierra el menú al cambiar el tamaño de la ventana\r\n-});\r\n"
                },
                {
                    "date": 1756937686046,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,45 @@\n-// Mostrar el menú en móviles al hacer clic en el botón hamburguesa\r\n-const menuToggle = document.getElementById('menu-toggle');\r\n-const nav = document.getElementById('nav');\r\n+// Seleccionamos elementos\r\n+const menuToggle = document.getElementById(\"menu-toggle\");\r\n+const nav = document.getElementById(\"nav\");\r\n \r\n-menuToggle.addEventListener('click', () => {\r\n-  nav.classList.toggle('active'); // Cambia la visibilidad del menú\r\n+// Función para abrir el menú\r\n+function showMenu() {\r\n+  nav.classList.add(\"active\");\r\n+  if (window.innerWidth <= 768) {\r\n+    menuToggle.textContent = \"✖\"; // Cambiar icono a \"✖\" cuando el menú se abre en móviles\r\n+  }\r\n+}\r\n+\r\n+// Función para cerrar el menú\r\n+function hideMenu() {\r\n+  nav.classList.remove(\"active\");\r\n+  if (window.innerWidth <= 768) {\r\n+    menuToggle.textContent = \"☰\"; // Restaurar icono a \"☰\" cuando el menú se cierra en móviles\r\n+  }\r\n+}\r\n+\r\n+// Manejo del clic en el botón de hamburguesa\r\n+menuToggle.addEventListener(\"click\", () => {\r\n+  if (nav.classList.contains(\"active\")) {\r\n+    hideMenu(); // Si el menú está abierto, lo cerramos\r\n+  } else {\r\n+    showMenu(); // Si el menú está cerrado, lo abrimos\r\n+  }\r\n });\r\n+\r\n+// Cerrar el menú si el usuario hace clic fuera de él\r\n+document.addEventListener(\"click\", (e) => {\r\n+  if (!nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n+    hideMenu(); // Cierra el menú si el clic es fuera del menú y el botón hamburguesa\r\n+  }\r\n+});\r\n+\r\n+// Aseguramos que el menú esté cerrado al cargar\r\n+document.addEventListener(\"DOMContentLoaded\", () => {\r\n+  hideMenu();\r\n+});\r\n+\r\n+// Reajustar el menú en función del tamaño de la pantalla al redimensionar\r\n+window.addEventListener(\"resize\", () => {\r\n+  hideMenu(); // Cierra el menú al cambiar el tamaño de la ventana\r\n+});\r\n"
                },
                {
                    "date": 1756937936499,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,20 +3,16 @@\n const nav = document.getElementById(\"nav\");\r\n \r\n // Función para abrir el menú\r\n function showMenu() {\r\n-  nav.classList.add(\"active\");\r\n-  if (window.innerWidth <= 768) {\r\n-    menuToggle.textContent = \"✖\"; // Cambiar icono a \"✖\" cuando el menú se abre en móviles\r\n-  }\r\n+  nav.classList.add(\"active\"); // Agrega la clase 'active' al menú\r\n+  menuToggle.textContent = \"✖\"; // Cambia el icono a \"✖\" cuando el menú se abre\r\n }\r\n \r\n // Función para cerrar el menú\r\n function hideMenu() {\r\n-  nav.classList.remove(\"active\");\r\n-  if (window.innerWidth <= 768) {\r\n-    menuToggle.textContent = \"☰\"; // Restaurar icono a \"☰\" cuando el menú se cierra en móviles\r\n-  }\r\n+  nav.classList.remove(\"active\"); // Elimina la clase 'active' del menú\r\n+  menuToggle.textContent = \"☰\"; // Restaura el icono a \"☰\" cuando el menú se cierra\r\n }\r\n \r\n // Manejo del clic en el botón de hamburguesa\r\n menuToggle.addEventListener(\"click\", () => {\r\n@@ -40,6 +36,10 @@\n });\r\n \r\n // Reajustar el menú en función del tamaño de la pantalla al redimensionar\r\n window.addEventListener(\"resize\", () => {\r\n-  hideMenu(); // Cierra el menú al cambiar el tamaño de la ventana\r\n+  if (window.innerWidth > 768) {\r\n+    showMenu(); // Abre el menú en pantallas grandes\r\n+  } else {\r\n+    hideMenu(); // Cierra el menú en pantallas pequeñas\r\n+  }\r\n });\r\n"
                },
                {
                    "date": 1756938159099,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,45 +1,72 @@\n // Seleccionamos elementos\r\n const menuToggle = document.getElementById(\"menu-toggle\");\r\n const nav = document.getElementById(\"nav\");\r\n \r\n-// Función para abrir el menú\r\n+// Función para abrir menú\r\n function showMenu() {\r\n-  nav.classList.add(\"active\"); // Agrega la clase 'active' al menú\r\n-  menuToggle.textContent = \"✖\"; // Cambia el icono a \"✖\" cuando el menú se abre\r\n+  nav.classList.add(\"active\");\r\n+  if (window.innerWidth <= 768) {\r\n+    menuToggle.textContent = \"✖\"; // Cambiar icono en móvil\r\n+  }\r\n }\r\n \r\n-// Función para cerrar el menú\r\n+// Función para cerrar menú\r\n function hideMenu() {\r\n-  nav.classList.remove(\"active\"); // Elimina la clase 'active' del menú\r\n-  menuToggle.textContent = \"☰\"; // Restaura el icono a \"☰\" cuando el menú se cierra\r\n+  nav.classList.remove(\"active\");\r\n+  if (window.innerWidth <= 768) {\r\n+    menuToggle.textContent = \"☰\"; // Restaurar icono en móvil\r\n+  }\r\n }\r\n \r\n-// Manejo del clic en el botón de hamburguesa\r\n-menuToggle.addEventListener(\"click\", () => {\r\n-  if (nav.classList.contains(\"active\")) {\r\n-    hideMenu(); // Si el menú está abierto, lo cerramos\r\n-  } else {\r\n-    showMenu(); // Si el menú está cerrado, lo abrimos\r\n-  }\r\n-});\r\n+// --- DESKTOP: hover ---\r\n+function activarEventosDesktop() {\r\n+  menuToggle.addEventListener(\"mouseenter\", showMenu);\r\n+  nav.addEventListener(\"mouseenter\", showMenu);\r\n \r\n-// Cerrar el menú si el usuario hace clic fuera de él\r\n-document.addEventListener(\"click\", (e) => {\r\n-  if (!nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n-    hideMenu(); // Cierra el menú si el clic es fuera del menú y el botón hamburguesa\r\n-  }\r\n-});\r\n+  menuToggle.addEventListener(\"mouseleave\", () => {\r\n+    setTimeout(() => {\r\n+      if (!nav.matches(\":hover\") && !menuToggle.matches(\":hover\")) {\r\n+        hideMenu();\r\n+      }\r\n+    }, 200);\r\n+  });\r\n \r\n-// Aseguramos que el menú esté cerrado al cargar\r\n-document.addEventListener(\"DOMContentLoaded\", () => {\r\n-  hideMenu();\r\n-});\r\n+  nav.addEventListener(\"mouseleave\", () => {\r\n+    setTimeout(() => {\r\n+      if (!nav.matches(\":hover\") && !menuToggle.matches(\":hover\")) {\r\n+        hideMenu();\r\n+      }\r\n+    }, 200);\r\n+  });\r\n+}\r\n \r\n-// Reajustar el menú en función del tamaño de la pantalla al redimensionar\r\n-window.addEventListener(\"resize\", () => {\r\n+// --- MOBILE: click ---\r\n+function activarEventosMobile() {\r\n+  menuToggle.addEventListener(\"click\", () => {\r\n+    if (nav.classList.contains(\"active\")) {\r\n+      hideMenu();\r\n+    } else {\r\n+      showMenu();\r\n+    }\r\n+  });\r\n+}\r\n+\r\n+// --- Inicialización según ancho ---\r\n+function inicializarMenu() {\r\n   if (window.innerWidth > 768) {\r\n-    showMenu(); // Abre el menú en pantallas grandes\r\n+    activarEventosDesktop();\r\n+    hideMenu();\r\n   } else {\r\n-    hideMenu(); // Cierra el menú en pantallas pequeñas\r\n+    activarEventosMobile();\r\n+    hideMenu();\r\n   }\r\n+}\r\n+\r\n+// Ejecutar al cargar\r\n+document.addEventListener(\"DOMContentLoaded\", inicializarMenu);\r\n+\r\n+// Reajustar al redimensionar\r\n+window.addEventListener(\"resize\", () => {\r\n+  hideMenu();\r\n+  inicializarMenu();\r\n });\r\n"
                },
                {
                    "date": 1757520439666,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,72 +1,47 @@\n-// Seleccionamos elementos\r\n-const menuToggle = document.getElementById(\"menu-toggle\");\r\n-const nav = document.getElementById(\"nav\");\r\n+// Obtener los elementos del DOM\r\n+const menuToggle = document.getElementById('menu-toggle');\r\n+const nav = document.getElementById('nav');\r\n+const overlayMenu = document.getElementById('overlay-menu');\r\n+const promoBar = document.querySelector('.promo-bar');\r\n+const topBar = document.querySelector('.top-bar');\r\n+const header = document.querySelector('.main-header');\r\n \r\n-// Función para abrir menú\r\n-function showMenu() {\r\n-  nav.classList.add(\"active\");\r\n-  if (window.innerWidth <= 768) {\r\n-    menuToggle.textContent = \"✖\"; // Cambiar icono en móvil\r\n-  }\r\n-}\r\n+let lastScrollTop = 0; // Guarda la última posición del scroll\r\n \r\n-// Función para cerrar menú\r\n-function hideMenu() {\r\n-  nav.classList.remove(\"active\");\r\n-  if (window.innerWidth <= 768) {\r\n-    menuToggle.textContent = \"☰\"; // Restaurar icono en móvil\r\n-  }\r\n-}\r\n+// Abrir y cerrar el menú al hacer clic en el botón de hamburguesa\r\n+menuToggle.addEventListener('click', () => {\r\n+    nav.classList.toggle('activo'); // Muestra el menú\r\n+    overlayMenu.classList.toggle('activo'); // Muestra el fondo oscuro\r\n+});\r\n \r\n-// --- DESKTOP: hover ---\r\n-function activarEventosDesktop() {\r\n-  menuToggle.addEventListener(\"mouseenter\", showMenu);\r\n-  nav.addEventListener(\"mouseenter\", showMenu);\r\n+// Cerrar el menú al hacer clic en el overlay (fondo oscuro)\r\n+overlayMenu.addEventListener('click', () => {\r\n+    nav.classList.remove('activo');\r\n+    overlayMenu.classList.remove('activo');\r\n+});\r\n \r\n-  menuToggle.addEventListener(\"mouseleave\", () => {\r\n-    setTimeout(() => {\r\n-      if (!nav.matches(\":hover\") && !menuToggle.matches(\":hover\")) {\r\n-        hideMenu();\r\n-      }\r\n-    }, 200);\r\n-  });\r\n+// Cerrar el menú si se hace clic fuera de él en pantallas grandes\r\n+document.addEventListener('click', function(event) {\r\n+    if (!nav.contains(event.target) && !menuToggle.contains(event.target)) {\r\n+        nav.classList.remove('activo'); // Cierra el menú\r\n+        overlayMenu.classList.remove('activo'); // Cierra el fondo oscuro\r\n+    }\r\n+});\r\n \r\n-  nav.addEventListener(\"mouseleave\", () => {\r\n-    setTimeout(() => {\r\n-      if (!nav.matches(\":hover\") && !menuToggle.matches(\":hover\")) {\r\n-        hideMenu();\r\n-      }\r\n-    }, 200);\r\n-  });\r\n-}\r\n+// Función para manejar el comportamiento del scroll y ocultar las barras\r\n+window.addEventListener('scroll', function() {\r\n+    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-// --- MOBILE: click ---\r\n-function activarEventosMobile() {\r\n-  menuToggle.addEventListener(\"click\", () => {\r\n-    if (nav.classList.contains(\"active\")) {\r\n-      hideMenu();\r\n+    // Si estamos haciendo scroll hacia abajo y no estamos en la parte superior\r\n+    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+        // Oculta las barras (promo y top bar)\r\n+        promoBar.classList.add('hidden');\r\n+        topBar.classList.add('hidden');\r\n     } else {\r\n-      showMenu();\r\n+        // Muestra las barras de nuevo cuando hacemos scroll hacia arriba\r\n+        promoBar.classList.remove('hidden');\r\n+        topBar.classList.remove('hidden');\r\n     }\r\n-  });\r\n-}\r\n \r\n-// --- Inicialización según ancho ---\r\n-function inicializarMenu() {\r\n-  if (window.innerWidth > 768) {\r\n-    activarEventosDesktop();\r\n-    hideMenu();\r\n-  } else {\r\n-    activarEventosMobile();\r\n-    hideMenu();\r\n-  }\r\n-}\r\n-\r\n-// Ejecutar al cargar\r\n-document.addEventListener(\"DOMContentLoaded\", inicializarMenu);\r\n-\r\n-// Reajustar al redimensionar\r\n-window.addEventListener(\"resize\", () => {\r\n-  hideMenu();\r\n-  inicializarMenu();\r\n+    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll; // Para no tener valores negativos en scroll\r\n });\r\n"
                },
                {
                    "date": 1757521441604,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,8 +4,9 @@\n const overlayMenu = document.getElementById('overlay-menu');\r\n const promoBar = document.querySelector('.promo-bar');\r\n const topBar = document.querySelector('.top-bar');\r\n const header = document.querySelector('.main-header');\r\n+const body = document.body;\r\n \r\n let lastScrollTop = 0; // Guarda la última posición del scroll\r\n \r\n // Abrir y cerrar el menú al hacer clic en el botón de hamburguesa\r\n@@ -36,12 +37,18 @@\n     if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n         // Oculta las barras (promo y top bar)\r\n         promoBar.classList.add('hidden');\r\n         topBar.classList.add('hidden');\r\n+        // Ajusta el header para que ocupe el espacio vacío\r\n+        header.style.top = '0';\r\n+        body.style.paddingTop = '0'; // Elimina el espacio vacío cuando las barras se ocultan\r\n     } else {\r\n         // Muestra las barras de nuevo cuando hacemos scroll hacia arriba\r\n         promoBar.classList.remove('hidden');\r\n         topBar.classList.remove('hidden');\r\n+        // Ajuste el espacio cuando las barras se muestran\r\n+        header.style.top = '42px'; // Vuelve a colocar el main-header debajo de las barras\r\n+        body.style.paddingTop = '150px'; // Ajusta el espacio de padding cuando las barras están visibles\r\n     }\r\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll; // Para no tener valores negativos en scroll\r\n });\r\n"
                },
                {
                    "date": 1757521575843,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,9 +38,9 @@\n         // Oculta las barras (promo y top bar)\r\n         promoBar.classList.add('hidden');\r\n         topBar.classList.add('hidden');\r\n         // Ajusta el header para que ocupe el espacio vacío\r\n-        header.style.top = '0';\r\n+        header.style.top = '10px'; // Ajustar el top del header para que el logo sea más visible\r\n         body.style.paddingTop = '0'; // Elimina el espacio vacío cuando las barras se ocultan\r\n     } else {\r\n         // Muestra las barras de nuevo cuando hacemos scroll hacia arriba\r\n         promoBar.classList.remove('hidden');\r\n"
                },
                {
                    "date": 1757522046447,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,17 +38,17 @@\n         // Oculta las barras (promo y top bar)\r\n         promoBar.classList.add('hidden');\r\n         topBar.classList.add('hidden');\r\n         // Ajusta el header para que ocupe el espacio vacío\r\n-        header.style.top = '10px'; // Ajustar el top del header para que el logo sea más visible\r\n+        header.style.top = '0'; // Mueve el header hacia arriba para ocupar el espacio vacío\r\n         body.style.paddingTop = '0'; // Elimina el espacio vacío cuando las barras se ocultan\r\n     } else {\r\n         // Muestra las barras de nuevo cuando hacemos scroll hacia arriba\r\n         promoBar.classList.remove('hidden');\r\n         topBar.classList.remove('hidden');\r\n         // Ajuste el espacio cuando las barras se muestran\r\n-        header.style.top = '42px'; // Vuelve a colocar el main-header debajo de las barras\r\n-        body.style.paddingTop = '150px'; // Ajusta el espacio de padding cuando las barras están visibles\r\n+        header.style.top = '72px'; // Coloca el main-header debajo de las barras\r\n+        body.style.paddingTop = '180px'; // Ajusta el espacio de padding cuando las barras están visibles\r\n     }\r\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll; // Para no tener valores negativos en scroll\r\n });\r\n"
                },
                {
                    "date": 1757604701758,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,9 @@\n // Obtener los elementos del DOM\r\n const menuToggle = document.getElementById('menu-toggle');\r\n const nav = document.getElementById('nav');\r\n const overlayMenu = document.getElementById('overlay-menu');\r\n+const closeMenu = document.getElementById('close-menu'); // Botón cerrar\r\n const promoBar = document.querySelector('.promo-bar');\r\n const topBar = document.querySelector('.top-bar');\r\n const header = document.querySelector('.main-header');\r\n const body = document.body;\r\n@@ -14,8 +15,16 @@\n     nav.classList.toggle('activo'); // Muestra el menú\r\n     overlayMenu.classList.toggle('activo'); // Muestra el fondo oscuro\r\n });\r\n \r\n+// Cerrar el menú al hacer clic en el botón ❌\r\n+if (closeMenu) {\r\n+    closeMenu.addEventListener('click', () => {\r\n+        nav.classList.remove('activo');\r\n+        overlayMenu.classList.remove('activo');\r\n+    });\r\n+}\r\n+\r\n // Cerrar el menú al hacer clic en el overlay (fondo oscuro)\r\n overlayMenu.addEventListener('click', () => {\r\n     nav.classList.remove('activo');\r\n     overlayMenu.classList.remove('activo');\r\n@@ -38,17 +47,17 @@\n         // Oculta las barras (promo y top bar)\r\n         promoBar.classList.add('hidden');\r\n         topBar.classList.add('hidden');\r\n         // Ajusta el header para que ocupe el espacio vacío\r\n-        header.style.top = '0'; // Mueve el header hacia arriba para ocupar el espacio vacío\r\n-        body.style.paddingTop = '0'; // Elimina el espacio vacío cuando las barras se ocultan\r\n+        header.style.top = '0'; \r\n+        body.style.paddingTop = '0'; \r\n     } else {\r\n         // Muestra las barras de nuevo cuando hacemos scroll hacia arriba\r\n         promoBar.classList.remove('hidden');\r\n         topBar.classList.remove('hidden');\r\n         // Ajuste el espacio cuando las barras se muestran\r\n-        header.style.top = '72px'; // Coloca el main-header debajo de las barras\r\n-        body.style.paddingTop = '180px'; // Ajusta el espacio de padding cuando las barras están visibles\r\n+        header.style.top = '72px'; \r\n+        body.style.paddingTop = '180px'; \r\n     }\r\n \r\n-    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll; // Para no tener valores negativos en scroll\r\n+    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll; \r\n });\r\n"
                },
                {
                    "date": 1757630924297,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,63 +1,70 @@\n-// Obtener los elementos del DOM\r\n-const menuToggle = document.getElementById('menu-toggle');\r\n-const nav = document.getElementById('nav');\r\n-const overlayMenu = document.getElementById('overlay-menu');\r\n-const closeMenu = document.getElementById('close-menu'); // Botón cerrar\r\n-const promoBar = document.querySelector('.promo-bar');\r\n-const topBar = document.querySelector('.top-bar');\r\n-const header = document.querySelector('.main-header');\r\n+// =========================\r\n+// MENU Y BARRAS SUPERIORES\r\n+// =========================\r\n+\r\n+// Elementos principales\r\n+const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n+const nav = document.getElementById(\"nav\"); // Menú lateral\r\n+const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n+const closeMenu = document.getElementById(\"close-menu\"); // Botón cerrar (❌)\r\n+const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo (si existe)\r\n+const topBar = document.querySelector(\".top-bar\"); // Barra superior (login, etc.)\r\n+const header = document.querySelector(\".main-header\"); // Header principal\r\n const body = document.body;\r\n \r\n let lastScrollTop = 0; // Guarda la última posición del scroll\r\n \r\n-// Abrir y cerrar el menú al hacer clic en el botón de hamburguesa\r\n-menuToggle.addEventListener('click', () => {\r\n-    nav.classList.toggle('activo'); // Muestra el menú\r\n-    overlayMenu.classList.toggle('activo'); // Muestra el fondo oscuro\r\n+// =========================\r\n+// ABRIR Y CERRAR MENÚ\r\n+// =========================\r\n+\r\n+// Abrir menú con botón hamburguesa\r\n+menuToggle?.addEventListener(\"click\", () => {\r\n+  nav.classList.toggle(\"activo\");\r\n+  overlayMenu.classList.toggle(\"activo\");\r\n });\r\n \r\n-// Cerrar el menú al hacer clic en el botón ❌\r\n-if (closeMenu) {\r\n-    closeMenu.addEventListener('click', () => {\r\n-        nav.classList.remove('activo');\r\n-        overlayMenu.classList.remove('activo');\r\n-    });\r\n-}\r\n+// Cerrar menú con botón ❌\r\n+closeMenu?.addEventListener(\"click\", () => {\r\n+  nav.classList.remove(\"activo\");\r\n+  overlayMenu.classList.remove(\"activo\");\r\n+});\r\n \r\n-// Cerrar el menú al hacer clic en el overlay (fondo oscuro)\r\n-overlayMenu.addEventListener('click', () => {\r\n-    nav.classList.remove('activo');\r\n-    overlayMenu.classList.remove('activo');\r\n+// Cerrar menú al hacer clic en el overlay (fondo oscuro)\r\n+overlayMenu?.addEventListener(\"click\", () => {\r\n+  nav.classList.remove(\"activo\");\r\n+  overlayMenu.classList.remove(\"activo\");\r\n });\r\n \r\n-// Cerrar el menú si se hace clic fuera de él en pantallas grandes\r\n-document.addEventListener('click', function(event) {\r\n-    if (!nav.contains(event.target) && !menuToggle.contains(event.target)) {\r\n-        nav.classList.remove('activo'); // Cierra el menú\r\n-        overlayMenu.classList.remove('activo'); // Cierra el fondo oscuro\r\n-    }\r\n+// Cerrar menú si se hace clic fuera de él (en desktop)\r\n+document.addEventListener(\"click\", (e) => {\r\n+  if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n+  }\r\n });\r\n \r\n-// Función para manejar el comportamiento del scroll y ocultar las barras\r\n-window.addEventListener('scroll', function() {\r\n-    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+// =========================\r\n+// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+// =========================\r\n+window.addEventListener(\"scroll\", () => {\r\n+  let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-    // Si estamos haciendo scroll hacia abajo y no estamos en la parte superior\r\n-    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-        // Oculta las barras (promo y top bar)\r\n-        promoBar.classList.add('hidden');\r\n-        topBar.classList.add('hidden');\r\n-        // Ajusta el header para que ocupe el espacio vacío\r\n-        header.style.top = '0'; \r\n-        body.style.paddingTop = '0'; \r\n-    } else {\r\n-        // Muestra las barras de nuevo cuando hacemos scroll hacia arriba\r\n-        promoBar.classList.remove('hidden');\r\n-        topBar.classList.remove('hidden');\r\n-        // Ajuste el espacio cuando las barras se muestran\r\n-        header.style.top = '72px'; \r\n-        body.style.paddingTop = '180px'; \r\n-    }\r\n+  if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+    // Scrolleando hacia abajo → oculta barras\r\n+    promoBar?.classList.add(\"hidden\");\r\n+    topBar?.classList.add(\"hidden\");\r\n \r\n-    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll; \r\n+    header.style.top = \"0\";\r\n+    body.style.paddingTop = \"0\";\r\n+  } else {\r\n+    // Scrolleando hacia arriba → muestra barras\r\n+    promoBar?.classList.remove(\"hidden\");\r\n+    topBar?.classList.remove(\"hidden\");\r\n+\r\n+    header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n+    body.style.paddingTop = \"180px\"; // Ajusta el espacio total del header\r\n+  }\r\n+\r\n+  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n });\r\n"
                },
                {
                    "date": 1758638094857,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,70 +1,74 @@\n-// =========================\r\n-// MENU Y BARRAS SUPERIORES\r\n-// =========================\r\n+// Esperar a que el DOM esté completamente cargado\r\n+document.addEventListener(\"DOMContentLoaded\", () => {\r\n+  // Elementos principales\r\n+  const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n+  const nav = document.getElementById(\"nav\"); // Menú lateral\r\n+  const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n+  const closeMenu = document.getElementById(\"close-menu\"); // Botón cerrar (❌)\r\n+  const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo (si existe)\r\n+  const topBar = document.querySelector(\".top-bar\"); // Barra superior (login, etc.)\r\n+  const header = document.querySelector(\".main-header\"); // Header principal\r\n+  const body = document.body;\r\n \r\n-// Elementos principales\r\n-const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n-const nav = document.getElementById(\"nav\"); // Menú lateral\r\n-const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n-const closeMenu = document.getElementById(\"close-menu\"); // Botón cerrar (❌)\r\n-const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo (si existe)\r\n-const topBar = document.querySelector(\".top-bar\"); // Barra superior (login, etc.)\r\n-const header = document.querySelector(\".main-header\"); // Header principal\r\n-const body = document.body;\r\n+  let lastScrollTop = 0; // Guarda la última posición del scroll\r\n \r\n-let lastScrollTop = 0; // Guarda la última posición del scroll\r\n+  // =========================\r\n+  // ABRIR Y CERRAR MENÚ\r\n+  // =========================\r\n \r\n-// =========================\r\n-// ABRIR Y CERRAR MENÚ\r\n-// =========================\r\n+  // Verificar si los elementos existen antes de asignarles eventos\r\n+  if (menuToggle && nav && overlayMenu) {\r\n+    // Abrir menú con botón hamburguesa\r\n+    menuToggle.addEventListener(\"click\", () => {\r\n+      nav.classList.toggle(\"activo\");\r\n+      overlayMenu.classList.toggle(\"activo\");\r\n+    });\r\n \r\n-// Abrir menú con botón hamburguesa\r\n-menuToggle?.addEventListener(\"click\", () => {\r\n-  nav.classList.toggle(\"activo\");\r\n-  overlayMenu.classList.toggle(\"activo\");\r\n-});\r\n+    // Cerrar menú con botón ❌\r\n+    if (closeMenu) {\r\n+      closeMenu.addEventListener(\"click\", () => {\r\n+        nav.classList.remove(\"activo\");\r\n+        overlayMenu.classList.remove(\"activo\");\r\n+      });\r\n+    }\r\n \r\n-// Cerrar menú con botón ❌\r\n-closeMenu?.addEventListener(\"click\", () => {\r\n-  nav.classList.remove(\"activo\");\r\n-  overlayMenu.classList.remove(\"activo\");\r\n-});\r\n+    // Cerrar menú al hacer clic en el overlay (fondo oscuro)\r\n+    overlayMenu.addEventListener(\"click\", () => {\r\n+      nav.classList.remove(\"activo\");\r\n+      overlayMenu.classList.remove(\"activo\");\r\n+    });\r\n \r\n-// Cerrar menú al hacer clic en el overlay (fondo oscuro)\r\n-overlayMenu?.addEventListener(\"click\", () => {\r\n-  nav.classList.remove(\"activo\");\r\n-  overlayMenu.classList.remove(\"activo\");\r\n-});\r\n-\r\n-// Cerrar menú si se hace clic fuera de él (en desktop)\r\n-document.addEventListener(\"click\", (e) => {\r\n-  if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n+    // Cerrar menú si se hace clic fuera de él (en desktop)\r\n+    document.addEventListener(\"click\", (e) => {\r\n+      if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n+        nav.classList.remove(\"activo\");\r\n+        overlayMenu.classList.remove(\"activo\");\r\n+      }\r\n+    });\r\n   }\r\n-});\r\n \r\n-// =========================\r\n-// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-// =========================\r\n-window.addEventListener(\"scroll\", () => {\r\n-  let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+  // =========================\r\n+  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+  // =========================\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-  if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-    // Scrolleando hacia abajo → oculta barras\r\n-    promoBar?.classList.add(\"hidden\");\r\n-    topBar?.classList.add(\"hidden\");\r\n+    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+      // Scrolleando hacia abajo → oculta barras\r\n+      promoBar?.classList.add(\"hidden\");\r\n+      topBar?.classList.add(\"hidden\");\r\n \r\n-    header.style.top = \"0\";\r\n-    body.style.paddingTop = \"0\";\r\n-  } else {\r\n-    // Scrolleando hacia arriba → muestra barras\r\n-    promoBar?.classList.remove(\"hidden\");\r\n-    topBar?.classList.remove(\"hidden\");\r\n+      header.style.top = \"0\";\r\n+      body.style.paddingTop = \"0\";\r\n+    } else {\r\n+      // Scrolleando hacia arriba → muestra barras\r\n+      promoBar?.classList.remove(\"hidden\");\r\n+      topBar?.classList.remove(\"hidden\");\r\n \r\n-    header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n-    body.style.paddingTop = \"180px\"; // Ajusta el espacio total del header\r\n-  }\r\n+      header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n+      body.style.paddingTop = \"180px\"; // Ajusta el espacio total del header\r\n+    }\r\n \r\n-  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+  });\r\n });\r\n"
                },
                {
                    "date": 1758638294687,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,74 +1,84 @@\n-// Esperar a que el DOM esté completamente cargado\r\n-document.addEventListener(\"DOMContentLoaded\", () => {\r\n-  // Elementos principales\r\n-  const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n-  const nav = document.getElementById(\"nav\"); // Menú lateral\r\n-  const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n-  const closeMenu = document.getElementById(\"close-menu\"); // Botón cerrar (❌)\r\n-  const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo (si existe)\r\n-  const topBar = document.querySelector(\".top-bar\"); // Barra superior (login, etc.)\r\n-  const header = document.querySelector(\".main-header\"); // Header principal\r\n-  const body = document.body;\r\n+// =========================\r\n+// MENU Y BARRAS SUPERIORES\r\n+// =========================\r\n \r\n-  let lastScrollTop = 0; // Guarda la última posición del scroll\r\n+// Elementos principales\r\n+const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n+const nav = document.getElementById(\"nav\"); // Menú lateral\r\n+const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n+const closeMenu = document.getElementById(\"close-menu\"); // Botón cerrar (❌)\r\n+const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo (si existe)\r\n+const topBar = document.querySelector(\".top-bar\"); // Barra superior (login, etc.)\r\n+const header = document.querySelector(\".main-header\"); // Header principal\r\n+const body = document.body;\r\n \r\n-  // =========================\r\n-  // ABRIR Y CERRAR MENÚ\r\n-  // =========================\r\n+let lastScrollTop = 0; // Guarda la última posición del scroll\r\n \r\n-  // Verificar si los elementos existen antes de asignarles eventos\r\n-  if (menuToggle && nav && overlayMenu) {\r\n-    // Abrir menú con botón hamburguesa\r\n-    menuToggle.addEventListener(\"click\", () => {\r\n-      nav.classList.toggle(\"activo\");\r\n-      overlayMenu.classList.toggle(\"activo\");\r\n-    });\r\n+// =========================\r\n+// ABRIR Y CERRAR MENÚ\r\n+// =========================\r\n \r\n-    // Cerrar menú con botón ❌\r\n-    if (closeMenu) {\r\n-      closeMenu.addEventListener(\"click\", () => {\r\n-        nav.classList.remove(\"activo\");\r\n-        overlayMenu.classList.remove(\"activo\");\r\n-      });\r\n-    }\r\n+// Abrir menú con botón hamburguesa\r\n+menuToggle?.addEventListener(\"click\", () => {\r\n+  nav.classList.toggle(\"activo\");\r\n+  overlayMenu.classList.toggle(\"activo\");\r\n+  // Agregar una animación de fondo oscuro (overlay) al abrir\r\n+  overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n+});\r\n \r\n-    // Cerrar menú al hacer clic en el overlay (fondo oscuro)\r\n-    overlayMenu.addEventListener(\"click\", () => {\r\n-      nav.classList.remove(\"activo\");\r\n-      overlayMenu.classList.remove(\"activo\");\r\n-    });\r\n+// Cerrar menú con botón ❌\r\n+closeMenu?.addEventListener(\"click\", () => {\r\n+  nav.classList.remove(\"activo\");\r\n+  overlayMenu.classList.remove(\"activo\");\r\n+  // Eliminar la animación de fondo oscuro (overlay) al cerrarlo\r\n+  overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n+});\r\n \r\n-    // Cerrar menú si se hace clic fuera de él (en desktop)\r\n-    document.addEventListener(\"click\", (e) => {\r\n-      if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n-        nav.classList.remove(\"activo\");\r\n-        overlayMenu.classList.remove(\"activo\");\r\n-      }\r\n-    });\r\n+// Cerrar menú al hacer clic en el overlay (fondo oscuro)\r\n+overlayMenu?.addEventListener(\"click\", () => {\r\n+  nav.classList.remove(\"activo\");\r\n+  overlayMenu.classList.remove(\"activo\");\r\n+});\r\n+\r\n+// Cerrar menú si se hace clic fuera de él (en desktop)\r\n+document.addEventListener(\"click\", (e) => {\r\n+  if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n   }\r\n+});\r\n \r\n-  // =========================\r\n-  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-  // =========================\r\n-  window.addEventListener(\"scroll\", () => {\r\n-    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+// =========================\r\n+// CERRAR MENÚ CON ESCAPE\r\n+// =========================\r\n+document.addEventListener(\"keydown\", (e) => {\r\n+  if (e.key === \"Escape\" && nav.classList.contains(\"activo\")) {\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n+  }\r\n+});\r\n \r\n-    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-      // Scrolleando hacia abajo → oculta barras\r\n-      promoBar?.classList.add(\"hidden\");\r\n-      topBar?.classList.add(\"hidden\");\r\n+// =========================\r\n+// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+// =========================\r\n+window.addEventListener(\"scroll\", () => {\r\n+  let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-      header.style.top = \"0\";\r\n-      body.style.paddingTop = \"0\";\r\n-    } else {\r\n-      // Scrolleando hacia arriba → muestra barras\r\n-      promoBar?.classList.remove(\"hidden\");\r\n-      topBar?.classList.remove(\"hidden\");\r\n+  if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+    // Scrolleando hacia abajo → oculta barras\r\n+    promoBar?.classList.add(\"hidden\");\r\n+    topBar?.classList.add(\"hidden\");\r\n \r\n-      header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n-      body.style.paddingTop = \"180px\"; // Ajusta el espacio total del header\r\n-    }\r\n+    header.style.top = \"0\";\r\n+    body.style.paddingTop = \"0\";\r\n+  } else {\r\n+    // Scrolleando hacia arriba → muestra barras\r\n+    promoBar?.classList.remove(\"hidden\");\r\n+    topBar?.classList.remove(\"hidden\");\r\n \r\n-    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n-  });\r\n+    header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n+    body.style.paddingTop = \"180px\"; // Ajusta el espacio total del header\r\n+  }\r\n+\r\n+  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n });\r\n"
                },
                {
                    "date": 1758639067991,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,84 +1,88 @@\n-// =========================\r\n-// MENU Y BARRAS SUPERIORES\r\n-// =========================\r\n+document.addEventListener('DOMContentLoaded', () => {\r\n+  // Elementos principales\r\n+  const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n+  const nav = document.getElementById(\"nav\"); // Menú lateral\r\n+  const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n+  const closeMenu = document.getElementById(\"close-menu\"); // Botón cerrar (❌)\r\n+  const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo (si existe)\r\n+  const topBar = document.querySelector(\".top-bar\"); // Barra superior (login, etc.)\r\n+  const header = document.querySelector(\".main-header\"); // Header principal\r\n+  const body = document.body;\r\n \r\n-// Elementos principales\r\n-const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n-const nav = document.getElementById(\"nav\"); // Menú lateral\r\n-const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n-const closeMenu = document.getElementById(\"close-menu\"); // Botón cerrar (❌)\r\n-const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo (si existe)\r\n-const topBar = document.querySelector(\".top-bar\"); // Barra superior (login, etc.)\r\n-const header = document.querySelector(\".main-header\"); // Header principal\r\n-const body = document.body;\r\n+  let lastScrollTop = 0; // Guarda la última posición del scroll\r\n \r\n-let lastScrollTop = 0; // Guarda la última posición del scroll\r\n+  // =========================\r\n+  // ABRIR Y CERRAR MENÚ\r\n+  // =========================\r\n \r\n-// =========================\r\n-// ABRIR Y CERRAR MENÚ\r\n-// =========================\r\n+  // Abrir menú con botón hamburguesa\r\n+  if (menuToggle && nav && overlayMenu) {\r\n+    menuToggle.addEventListener(\"click\", () => {\r\n+      nav.classList.toggle(\"activo\");\r\n+      overlayMenu.classList.toggle(\"activo\");\r\n+      overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n+    });\r\n+  } else {\r\n+    console.error(\"⚠️ Los elementos del menú no están en el DOM.\");\r\n+  }\r\n \r\n-// Abrir menú con botón hamburguesa\r\n-menuToggle?.addEventListener(\"click\", () => {\r\n-  nav.classList.toggle(\"activo\");\r\n-  overlayMenu.classList.toggle(\"activo\");\r\n-  // Agregar una animación de fondo oscuro (overlay) al abrir\r\n-  overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n-});\r\n+  // Cerrar menú con botón ❌\r\n+  if (closeMenu) {\r\n+    closeMenu.addEventListener(\"click\", () => {\r\n+      nav.classList.remove(\"activo\");\r\n+      overlayMenu.classList.remove(\"activo\");\r\n+      overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n+    });\r\n+  }\r\n \r\n-// Cerrar menú con botón ❌\r\n-closeMenu?.addEventListener(\"click\", () => {\r\n-  nav.classList.remove(\"activo\");\r\n-  overlayMenu.classList.remove(\"activo\");\r\n-  // Eliminar la animación de fondo oscuro (overlay) al cerrarlo\r\n-  overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n-});\r\n+  // Cerrar menú al hacer clic en el overlay (fondo oscuro)\r\n+  if (overlayMenu) {\r\n+    overlayMenu.addEventListener(\"click\", () => {\r\n+      nav.classList.remove(\"activo\");\r\n+      overlayMenu.classList.remove(\"activo\");\r\n+    });\r\n+  }\r\n \r\n-// Cerrar menú al hacer clic en el overlay (fondo oscuro)\r\n-overlayMenu?.addEventListener(\"click\", () => {\r\n-  nav.classList.remove(\"activo\");\r\n-  overlayMenu.classList.remove(\"activo\");\r\n-});\r\n+  // Cerrar menú si se hace clic fuera de él (en desktop)\r\n+  document.addEventListener(\"click\", (e) => {\r\n+    if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n+      nav.classList.remove(\"activo\");\r\n+      overlayMenu.classList.remove(\"activo\");\r\n+    }\r\n+  });\r\n \r\n-// Cerrar menú si se hace clic fuera de él (en desktop)\r\n-document.addEventListener(\"click\", (e) => {\r\n-  if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n-  }\r\n-});\r\n+  // =========================\r\n+  // CERRAR MENÚ CON ESCAPE\r\n+  // =========================\r\n+  document.addEventListener(\"keydown\", (e) => {\r\n+    if (e.key === \"Escape\" && nav.classList.contains(\"activo\")) {\r\n+      nav.classList.remove(\"activo\");\r\n+      overlayMenu.classList.remove(\"activo\");\r\n+    }\r\n+  });\r\n \r\n-// =========================\r\n-// CERRAR MENÚ CON ESCAPE\r\n-// =========================\r\n-document.addEventListener(\"keydown\", (e) => {\r\n-  if (e.key === \"Escape\" && nav.classList.contains(\"activo\")) {\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n-  }\r\n-});\r\n+  // =========================\r\n+  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+  // =========================\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-// =========================\r\n-// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-// =========================\r\n-window.addEventListener(\"scroll\", () => {\r\n-  let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+      // Scrolleando hacia abajo → oculta barras\r\n+      promoBar?.classList.add(\"hidden\");\r\n+      topBar?.classList.add(\"hidden\");\r\n \r\n-  if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-    // Scrolleando hacia abajo → oculta barras\r\n-    promoBar?.classList.add(\"hidden\");\r\n-    topBar?.classList.add(\"hidden\");\r\n+      header.style.top = \"0\";\r\n+      body.style.paddingTop = \"0\";\r\n+    } else {\r\n+      // Scrolleando hacia arriba → muestra barras\r\n+      promoBar?.classList.remove(\"hidden\");\r\n+      topBar?.classList.remove(\"hidden\");\r\n \r\n-    header.style.top = \"0\";\r\n-    body.style.paddingTop = \"0\";\r\n-  } else {\r\n-    // Scrolleando hacia arriba → muestra barras\r\n-    promoBar?.classList.remove(\"hidden\");\r\n-    topBar?.classList.remove(\"hidden\");\r\n+      header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n+      body.style.paddingTop = \"180px\"; // Ajusta el espacio total del header\r\n+    }\r\n \r\n-    header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n-    body.style.paddingTop = \"180px\"; // Ajusta el espacio total del header\r\n-  }\r\n-\r\n-  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+  });\r\n });\r\n"
                },
                {
                    "date": 1758639973318,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-document.addEventListener('DOMContentLoaded', () => {\r\n+document.addEventListener(\"DOMContentLoaded\", () => {\r\n   // Elementos principales\r\n   const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n   const nav = document.getElementById(\"nav\"); // Menú lateral\r\n   const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n@@ -15,34 +15,28 @@\n   // ABRIR Y CERRAR MENÚ\r\n   // =========================\r\n \r\n   // Abrir menú con botón hamburguesa\r\n-  if (menuToggle && nav && overlayMenu) {\r\n-    menuToggle.addEventListener(\"click\", () => {\r\n-      nav.classList.toggle(\"activo\");\r\n-      overlayMenu.classList.toggle(\"activo\");\r\n-      overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n-    });\r\n-  } else {\r\n-    console.error(\"⚠️ Los elementos del menú no están en el DOM.\");\r\n-  }\r\n+  menuToggle?.addEventListener(\"click\", () => {\r\n+    nav.classList.toggle(\"activo\");\r\n+    overlayMenu.classList.toggle(\"activo\");\r\n+    // Agregar una animación de fondo oscuro (overlay) al abrir\r\n+    overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n+  });\r\n \r\n   // Cerrar menú con botón ❌\r\n-  if (closeMenu) {\r\n-    closeMenu.addEventListener(\"click\", () => {\r\n-      nav.classList.remove(\"activo\");\r\n-      overlayMenu.classList.remove(\"activo\");\r\n-      overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n-    });\r\n-  }\r\n+  closeMenu?.addEventListener(\"click\", () => {\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n+    // Eliminar la animación de fondo oscuro (overlay) al cerrarlo\r\n+    overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n+  });\r\n \r\n   // Cerrar menú al hacer clic en el overlay (fondo oscuro)\r\n-  if (overlayMenu) {\r\n-    overlayMenu.addEventListener(\"click\", () => {\r\n-      nav.classList.remove(\"activo\");\r\n-      overlayMenu.classList.remove(\"activo\");\r\n-    });\r\n-  }\r\n+  overlayMenu?.addEventListener(\"click\", () => {\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n+  });\r\n \r\n   // Cerrar menú si se hace clic fuera de él (en desktop)\r\n   document.addEventListener(\"click\", (e) => {\r\n     if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n"
                },
                {
                    "date": 1758641675394,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,4 +79,36 @@\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n });\r\n+\r\n+\r\n+// Obtener las categorías del JSON\r\n+fetch('productos.json')\r\n+  .then(response => response.json())\r\n+  .then(data => {\r\n+    const categorias = data.categorias; // Aquí están las categorías\r\n+    const menuCategorias = document.getElementById('menu-categorias'); // Contenedor del menú en HTML\r\n+    \r\n+    // Limpiar el menú antes de cargar las categorías\r\n+    menuCategorias.innerHTML = '';\r\n+\r\n+    categorias.forEach(categoria => {\r\n+      let categoriaElemento = document.createElement('li');\r\n+      \r\n+      // Crear enlace para la categoría\r\n+      categoriaElemento.innerHTML = `<a href=\"#\" onclick=\"mostrarProductosPorCategoria(${categoria.id})\">${categoria.nombre}</a>`;\r\n+      menuCategorias.appendChild(categoriaElemento);\r\n+      \r\n+      // Crear subcategorías si las tiene\r\n+      if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n+        let subMenu = document.createElement('ul');\r\n+        categoria.subcategorias.forEach(subcategoria => {\r\n+          let subcategoriaElemento = document.createElement('li');\r\n+          subcategoriaElemento.innerHTML = `<a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id})\">${subcategoria.nombre}</a>`;\r\n+          subMenu.appendChild(subcategoriaElemento);\r\n+        });\r\n+        categoriaElemento.appendChild(subMenu);\r\n+      }\r\n+    });\r\n+  })\r\n+  .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n"
                },
                {
                    "date": 1758641731248,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -81,9 +81,11 @@\n   });\r\n });\r\n \r\n \r\n-// Obtener las categorías del JSON\r\n+// // =========================\r\n+  // OBTENEMOS LAS CATEGORIAS DE PRODUCTOS.JSON\r\n+  // =========================\r\n fetch('productos.json')\r\n   .then(response => response.json())\r\n   .then(data => {\r\n     const categorias = data.categorias; // Aquí están las categorías\r\n"
                },
                {
                    "date": 1758641961424,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -84,8 +84,9 @@\n \r\n // // =========================\r\n   // OBTENEMOS LAS CATEGORIAS DE PRODUCTOS.JSON\r\n   // =========================\r\n+// Obtener las categorías del JSON y cargarlas en el menú\r\n fetch('productos.json')\r\n   .then(response => response.json())\r\n   .then(data => {\r\n     const categorias = data.categorias; // Aquí están las categorías\r\n"
                },
                {
                    "date": 1758641987534,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -82,11 +82,11 @@\n });\r\n \r\n \r\n // // =========================\r\n-  // OBTENEMOS LAS CATEGORIAS DE PRODUCTOS.JSON\r\n+  // OBTENEMOS LAS CATEGORIAS DE PRODUCTOS.JSON Y CARGARLOS EN MENU\r\n   // =========================\r\n-// Obtener las categorías del JSON y cargarlas en el menú\r\n+\r\n fetch('productos.json')\r\n   .then(response => response.json())\r\n   .then(data => {\r\n     const categorias = data.categorias; // Aquí están las categorías\r\n"
                },
                {
                    "date": 1758643109661,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -81,11 +81,11 @@\n   });\r\n });\r\n \r\n \r\n-// // =========================\r\n-  // OBTENEMOS LAS CATEGORIAS DE PRODUCTOS.JSON Y CARGARLOS EN MENU\r\n-  // =========================\r\n+// =========================\r\n+// OBTENEMOS LAS CATEGORIAS DE PRODUCTOS.JSON Y CARGARLOS EN MENU\r\n+// =========================\r\n \r\n fetch('productos.json')\r\n   .then(response => response.json())\r\n   .then(data => {\r\n@@ -111,7 +111,21 @@\n           subMenu.appendChild(subcategoriaElemento);\r\n         });\r\n         categoriaElemento.appendChild(subMenu);\r\n       }\r\n+\r\n+      // Agregar interactividad para mostrar/ocultar subcategorías\r\n+      categoriaElemento.addEventListener('click', function (event) {\r\n+        event.stopPropagation(); // Evitar que el clic se propague a los elementos padres\r\n+        toggleSubcategorias(categoriaElemento); // Alternar subcategorías\r\n+      });\r\n     });\r\n   })\r\n   .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n+\r\n+// =========================\r\n+// Función para alternar la visibilidad de las subcategorías\r\n+// =========================\r\n+function toggleSubcategorias(categoriaElemento) {\r\n+  // Añadir o quitar la clase 'active' para mostrar/ocultar subcategorías\r\n+  categoriaElemento.classList.toggle('active');\r\n+}\r\n"
                },
                {
                    "date": 1758643299667,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -128,4 +128,5 @@\n function toggleSubcategorias(categoriaElemento) {\r\n   // Añadir o quitar la clase 'active' para mostrar/ocultar subcategorías\r\n   categoriaElemento.classList.toggle('active');\r\n }\r\n+  \n\\ No newline at end of file\n"
                },
                {
                    "date": 1758643604018,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -121,12 +121,12 @@\n     });\r\n   })\r\n   .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n \r\n+\r\n // =========================\r\n // Función para alternar la visibilidad de las subcategorías\r\n // =========================\r\n function toggleSubcategorias(categoriaElemento) {\r\n   // Añadir o quitar la clase 'active' para mostrar/ocultar subcategorías\r\n   categoriaElemento.classList.toggle('active');\r\n }\r\n\\ No newline at end of file\n-  \n"
                },
                {
                    "date": 1758644066544,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,17 +18,15 @@\n   // Abrir menú con botón hamburguesa\r\n   menuToggle?.addEventListener(\"click\", () => {\r\n     nav.classList.toggle(\"activo\");\r\n     overlayMenu.classList.toggle(\"activo\");\r\n-    // Agregar una animación de fondo oscuro (overlay) al abrir\r\n     overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n   });\r\n \r\n   // Cerrar menú con botón ❌\r\n   closeMenu?.addEventListener(\"click\", () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n-    // Eliminar la animación de fondo oscuro (overlay) al cerrarlo\r\n     overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n   });\r\n \r\n   // Cerrar menú al hacer clic en el overlay (fondo oscuro)\r\n@@ -61,16 +59,14 @@\n   window.addEventListener(\"scroll\", () => {\r\n     let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n     if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-      // Scrolleando hacia abajo → oculta barras\r\n       promoBar?.classList.add(\"hidden\");\r\n       topBar?.classList.add(\"hidden\");\r\n \r\n       header.style.top = \"0\";\r\n       body.style.paddingTop = \"0\";\r\n     } else {\r\n-      // Scrolleando hacia arriba → muestra barras\r\n       promoBar?.classList.remove(\"hidden\");\r\n       topBar?.classList.remove(\"hidden\");\r\n \r\n       header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n@@ -80,9 +76,8 @@\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n });\r\n \r\n-\r\n // =========================\r\n // OBTENEMOS LAS CATEGORIAS DE PRODUCTOS.JSON Y CARGARLOS EN MENU\r\n // =========================\r\n \r\n@@ -128,5 +123,5 @@\n // =========================\r\n function toggleSubcategorias(categoriaElemento) {\r\n   // Añadir o quitar la clase 'active' para mostrar/ocultar subcategorías\r\n   categoriaElemento.classList.toggle('active');\r\n-}\n\\ No newline at end of file\n+}\r\n"
                },
                {
                    "date": 1758644295765,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -117,11 +117,14 @@\n   })\r\n   .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n \r\n \r\n-// =========================\r\n // Función para alternar la visibilidad de las subcategorías\r\n-// =========================\r\n function toggleSubcategorias(categoriaElemento) {\r\n-  // Añadir o quitar la clase 'active' para mostrar/ocultar subcategorías\r\n-  categoriaElemento.classList.toggle('active');\r\n+  // Verificamos que categoriaElemento no sea null o undefined\r\n+  if (categoriaElemento) {\r\n+    categoriaElemento.classList.toggle('active'); // Añadir o quitar la clase 'active' para mostrar/ocultar subcategorías\r\n+  } else {\r\n+    console.error(\"No se pudo encontrar el elemento para alternar las subcategorías.\");\r\n+  }\r\n }\r\n+\r\n"
                },
                {
                    "date": 1758644662421,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -126,5 +126,4 @@\n   } else {\r\n     console.error(\"No se pudo encontrar el elemento para alternar las subcategorías.\");\r\n   }\r\n }\r\n-\r\n"
                },
                {
                    "date": 1758644745539,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -93,9 +93,9 @@\n     categorias.forEach(categoria => {\r\n       let categoriaElemento = document.createElement('li');\r\n       \r\n       // Crear enlace para la categoría\r\n-      categoriaElemento.innerHTML = `<a href=\"#\" onclick=\"mostrarProductosPorCategoria(${categoria.id})\">${categoria.nombre}</a>`;\r\n+      categoriaElemento.innerHTML = `<a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">${categoria.nombre}</a>`;\r\n       menuCategorias.appendChild(categoriaElemento);\r\n       \r\n       // Crear subcategorías si las tiene\r\n       if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n@@ -106,24 +106,26 @@\n           subMenu.appendChild(subcategoriaElemento);\r\n         });\r\n         categoriaElemento.appendChild(subMenu);\r\n       }\r\n-\r\n-      // Agregar interactividad para mostrar/ocultar subcategorías\r\n-      categoriaElemento.addEventListener('click', function (event) {\r\n-        event.stopPropagation(); // Evitar que el clic se propague a los elementos padres\r\n-        toggleSubcategorias(categoriaElemento); // Alternar subcategorías\r\n-      });\r\n     });\r\n   })\r\n   .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n \r\n+// Función para alternar la visibilidad de las subcategorías\r\n+function toggleSubcategorias(event, categoriaElemento) {\r\n+  event.preventDefault(); // Prevenir el comportamiento por defecto del enlace\r\n \r\n-// Función para alternar la visibilidad de las subcategorías\r\n-function toggleSubcategorias(categoriaElemento) {\r\n   // Verificamos que categoriaElemento no sea null o undefined\r\n   if (categoriaElemento) {\r\n-    categoriaElemento.classList.toggle('active'); // Añadir o quitar la clase 'active' para mostrar/ocultar subcategorías\r\n+    // Alternamos la visibilidad de las subcategorías\r\n+    categoriaElemento.classList.toggle('active'); \r\n+\r\n+    // Toggle de visibilidad de subcategorías (mostrar/ocultar)\r\n+    const subMenu = categoriaElemento.querySelector('ul');\r\n+    if (subMenu) {\r\n+      subMenu.style.display = subMenu.style.display === 'block' ? 'none' : 'block';\r\n+    }\r\n   } else {\r\n     console.error(\"No se pudo encontrar el elemento para alternar las subcategorías.\");\r\n   }\r\n }\r\n"
                },
                {
                    "date": 1758644981186,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -111,21 +111,19 @@\n   })\r\n   .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n \r\n // Función para alternar la visibilidad de las subcategorías\r\n-function toggleSubcategorias(event, categoriaElemento) {\r\n-  event.preventDefault(); // Prevenir el comportamiento por defecto del enlace\r\n+function toggleSubcategorias(event) {\r\n+  // Prevenir el comportamiento predeterminado del enlace (no recargar la página)\r\n+  event.preventDefault();\r\n \r\n-  // Verificamos que categoriaElemento no sea null o undefined\r\n-  if (categoriaElemento) {\r\n-    // Alternamos la visibilidad de las subcategorías\r\n-    categoriaElemento.classList.toggle('active'); \r\n-\r\n-    // Toggle de visibilidad de subcategorías (mostrar/ocultar)\r\n-    const subMenu = categoriaElemento.querySelector('ul');\r\n-    if (subMenu) {\r\n-      subMenu.style.display = subMenu.style.display === 'block' ? 'none' : 'block';\r\n-    }\r\n+  // Obtener el contenedor de las subcategorías\r\n+  const menuCategorias = document.getElementById('menu-categorias');\r\n+  \r\n+  // Alternar la visibilidad del menú de categorías\r\n+  if (menuCategorias.style.display === 'none' || menuCategorias.style.display === '') {\r\n+    menuCategorias.style.display = 'block'; // Mostrar subcategorías\r\n   } else {\r\n-    console.error(\"No se pudo encontrar el elemento para alternar las subcategorías.\");\r\n+    menuCategorias.style.display = 'none'; // Ocultar subcategorías\r\n   }\r\n }\r\n+\r\n"
                },
                {
                    "date": 1759011851249,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -75,55 +75,90 @@\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n });\r\n-\r\n // =========================\r\n // OBTENEMOS LAS CATEGORIAS DE PRODUCTOS.JSON Y CARGARLOS EN MENU\r\n // =========================\r\n \r\n+let productosGlobal = []; // Guardamos todos los productos y ofertas\r\n+\r\n fetch('productos.json')\r\n   .then(response => response.json())\r\n   .then(data => {\r\n-    const categorias = data.categorias; // Aquí están las categorías\r\n-    const menuCategorias = document.getElementById('menu-categorias'); // Contenedor del menú en HTML\r\n-    \r\n-    // Limpiar el menú antes de cargar las categorías\r\n+    const categorias = data.categorias; \r\n+    productosGlobal = data.productos.concat(data.ofertas); // unir productos + ofertas\r\n+\r\n+    const menuCategorias = document.getElementById('menu-categorias'); \r\n     menuCategorias.innerHTML = '';\r\n \r\n     categorias.forEach(categoria => {\r\n       let categoriaElemento = document.createElement('li');\r\n       \r\n-      // Crear enlace para la categoría\r\n-      categoriaElemento.innerHTML = `<a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">${categoria.nombre}</a>`;\r\n+      // Crear enlace de la categoría\r\n+      categoriaElemento.innerHTML = `\r\n+        <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n+          ${categoria.nombre}\r\n+        </a>\r\n+      `;\r\n       menuCategorias.appendChild(categoriaElemento);\r\n       \r\n-      // Crear subcategorías si las tiene\r\n+      // Crear subcategorías si existen\r\n       if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n         let subMenu = document.createElement('ul');\r\n+        subMenu.style.display = \"none\"; // oculto por defecto\r\n+\r\n         categoria.subcategorias.forEach(subcategoria => {\r\n           let subcategoriaElemento = document.createElement('li');\r\n-          subcategoriaElemento.innerHTML = `<a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id})\">${subcategoria.nombre}</a>`;\r\n+          subcategoriaElemento.innerHTML = `\r\n+            <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id})\">\r\n+              ${subcategoria.nombre}\r\n+            </a>\r\n+          `;\r\n           subMenu.appendChild(subcategoriaElemento);\r\n         });\r\n+\r\n         categoriaElemento.appendChild(subMenu);\r\n       }\r\n     });\r\n   })\r\n   .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n \r\n-// Función para alternar la visibilidad de las subcategorías\r\n-function toggleSubcategorias(event) {\r\n-  // Prevenir el comportamiento predeterminado del enlace (no recargar la página)\r\n+// =========================\r\n+// Función para alternar la visibilidad de subcategorías (solo esa categoría)\r\n+// =========================\r\n+function toggleSubcategorias(event, categoriaLi) {\r\n   event.preventDefault();\r\n \r\n-  // Obtener el contenedor de las subcategorías\r\n-  const menuCategorias = document.getElementById('menu-categorias');\r\n-  \r\n-  // Alternar la visibilidad del menú de categorías\r\n-  if (menuCategorias.style.display === 'none' || menuCategorias.style.display === '') {\r\n-    menuCategorias.style.display = 'block'; // Mostrar subcategorías\r\n-  } else {\r\n-    menuCategorias.style.display = 'none'; // Ocultar subcategorías\r\n+  const subMenu = categoriaLi.querySelector(\"ul\");\r\n+  if (subMenu) {\r\n+    subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n   }\r\n }\r\n \r\n+// =========================\r\n+// Mostrar productos filtrados por subcategoría\r\n+// =========================\r\n+function mostrarProductosPorSubcategoria(idSubcategoria) {\r\n+  const contenedor = document.getElementById(\"contenedor-productos\");\r\n+  contenedor.innerHTML = \"\";\r\n+\r\n+  const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n+\r\n+  if (filtrados.length === 0) {\r\n+    contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+    return;\r\n+  }\r\n+\r\n+  filtrados.forEach(prod => {\r\n+    let card = document.createElement(\"div\");\r\n+    card.classList.add(\"producto-card\");\r\n+    card.innerHTML = `\r\n+      <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+      <h3>${prod.nombre}</h3>\r\n+      <p>${prod.descripcion}</p>\r\n+      <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n+      <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+    `;\r\n+    contenedor.appendChild(card);\r\n+  });\r\n+}\r\n"
                },
                {
                    "date": 1759012229821,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -128,8 +128,10 @@\n // =========================\r\n function toggleSubcategorias(event, categoriaLi) {\r\n   event.preventDefault();\r\n \r\n+  if (!categoriaLi) return; // seguridad\r\n+\r\n   const subMenu = categoriaLi.querySelector(\"ul\");\r\n   if (subMenu) {\r\n     subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n   }\r\n"
                },
                {
                    "date": 1759012588014,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,174 @@\n+document.addEventListener(\"DOMContentLoaded\", () => {\r\n+  // Elementos principales\r\n+  const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n+  const nav = document.getElementById(\"nav\"); // Menú lateral\r\n+  const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n+  const closeMenu = document.getElementById(\"close-menu\"); // Botón cerrar (❌)\r\n+  const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo (si existe)\r\n+  const topBar = document.querySelector(\".top-bar\"); // Barra superior (login, etc.)\r\n+  const header = document.querySelector(\".main-header\"); // Header principal\r\n+  const body = document.body;\r\n+\r\n+  let lastScrollTop = 0; // Guarda la última posición del scroll\r\n+\r\n+  // =========================\r\n+  // ABRIR Y CERRAR MENÚ\r\n+  // =========================\r\n+\r\n+  // Abrir menú con botón hamburguesa\r\n+  menuToggle?.addEventListener(\"click\", () => {\r\n+    nav.classList.toggle(\"activo\");\r\n+    overlayMenu.classList.toggle(\"activo\");\r\n+    overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n+  });\r\n+\r\n+  // Cerrar menú con botón ❌\r\n+  closeMenu?.addEventListener(\"click\", () => {\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n+    overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n+  });\r\n+\r\n+  // Cerrar menú al hacer clic en el overlay (fondo oscuro)\r\n+  overlayMenu?.addEventListener(\"click\", () => {\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n+  });\r\n+\r\n+  // Cerrar menú si se hace clic fuera de él (en desktop)\r\n+  document.addEventListener(\"click\", (e) => {\r\n+    if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n+      nav.classList.remove(\"activo\");\r\n+      overlayMenu.classList.remove(\"activo\");\r\n+    }\r\n+  });\r\n+\r\n+  // =========================\r\n+  // CERRAR MENÚ CON ESCAPE\r\n+  // =========================\r\n+  document.addEventListener(\"keydown\", (e) => {\r\n+    if (e.key === \"Escape\" && nav.classList.contains(\"activo\")) {\r\n+      nav.classList.remove(\"activo\");\r\n+      overlayMenu.classList.remove(\"activo\");\r\n+    }\r\n+  });\r\n+\r\n+  // =========================\r\n+  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+  // =========================\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+\r\n+    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+      promoBar?.classList.add(\"hidden\");\r\n+      topBar?.classList.add(\"hidden\");\r\n+\r\n+      header.style.top = \"0\";\r\n+      body.style.paddingTop = \"0\";\r\n+    } else {\r\n+      promoBar?.classList.remove(\"hidden\");\r\n+      topBar?.classList.remove(\"hidden\");\r\n+\r\n+      header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n+      body.style.paddingTop = \"180px\"; // Ajusta el espacio total del header\r\n+    }\r\n+\r\n+    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+  });\r\n+});\r\n+// =========================\r\n+// OBTENEMOS LAS CATEGORIAS DE PRODUCTOS.JSON Y CARGARLOS EN MENU\r\n+// =========================\r\n+\r\n+let productosGlobal = []; // Guardamos todos los productos y ofertas\r\n+\r\n+fetch('productos.json')\r\n+  .then(response => response.json())\r\n+  .then(data => {\r\n+    const categorias = data.categorias; \r\n+    productosGlobal = data.productos.concat(data.ofertas); // unir productos + ofertas\r\n+\r\n+    const menuCategorias = document.getElementById('menu-categorias'); \r\n+    menuCategorias.innerHTML = '';\r\n+\r\n+    categorias.forEach(categoria => {\r\n+      let categoriaElemento = document.createElement('li');\r\n+      \r\n+      // Crear enlace de la categoría\r\n+      categoriaElemento.innerHTML = `\r\n+        <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n+          ${categoria.nombre}\r\n+        </a>\r\n+      `;\r\n+      menuCategorias.appendChild(categoriaElemento);\r\n+      \r\n+      // Crear subcategorías si existen\r\n+      if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n+        let subMenu = document.createElement('ul');\r\n+        subMenu.style.display = \"none\"; // oculto por defecto\r\n+\r\n+        categoria.subcategorias.forEach(subcategoria => {\r\n+          let subcategoriaElemento = document.createElement('li');\r\n+          subcategoriaElemento.innerHTML = `\r\n+            <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id})\">\r\n+              ${subcategoria.nombre}\r\n+            </a>\r\n+          `;\r\n+          subMenu.appendChild(subcategoriaElemento);\r\n+        });\r\n+\r\n+        categoriaElemento.appendChild(subMenu);\r\n+      }\r\n+    });\r\n+  })\r\n+  .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n+\r\n+// =========================\r\n+// Función para alternar la visibilidad de subcategorías (solo esa categoría)\r\n+// =========================\r\n+function toggleSubcategorias(event, categoriaLi) {\r\n+  event.preventDefault();\r\n+  if (!categoriaLi) return;\r\n+\r\n+  // Cerrar todos los demás submenús\r\n+  document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n+    if (ul !== categoriaLi.querySelector(\"ul\")) {\r\n+      ul.style.display = \"none\";\r\n+    }\r\n+  });\r\n+\r\n+  // Alternar solo el submenú clickeado\r\n+  const subMenu = categoriaLi.querySelector(\"ul\");\r\n+  if (subMenu) {\r\n+    subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n+  }\r\n+}\r\n+\r\n+\r\n+// =========================\r\n+// Mostrar productos filtrados por subcategoría\r\n+// =========================\r\n+function mostrarProductosPorSubcategoria(idSubcategoria) {\r\n+  const contenedor = document.getElementById(\"contenedor-productos\");\r\n+  contenedor.innerHTML = \"\";\r\n+\r\n+  const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n+\r\n+  if (filtrados.length === 0) {\r\n+    contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+    return;\r\n+  }\r\n+\r\n+  filtrados.forEach(prod => {\r\n+    let card = document.createElement(\"div\");\r\n+    card.classList.add(\"producto-card\");\r\n+    card.innerHTML = `\r\n+      <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+      <h3>${prod.nombre}</h3>\r\n+      <p>${prod.descripcion}</p>\r\n+      <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n+      <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+    `;\r\n+    contenedor.appendChild(card);\r\n+  });\r\n+}\r\n"
                },
                {
                    "date": 1759012755837,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -129,16 +129,16 @@\n function toggleSubcategorias(event, categoriaLi) {\r\n   event.preventDefault();\r\n   if (!categoriaLi) return;\r\n \r\n-  // Cerrar todos los demás submenús\r\n+  // 🔒 Cerrar todos los demás submenús\r\n   document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n     if (ul !== categoriaLi.querySelector(\"ul\")) {\r\n       ul.style.display = \"none\";\r\n     }\r\n   });\r\n \r\n-  // Alternar solo el submenú clickeado\r\n+  // 🎯 Alternar solo el submenú clickeado\r\n   const subMenu = categoriaLi.querySelector(\"ul\");\r\n   if (subMenu) {\r\n     subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n   }\r\n@@ -171,170 +171,4 @@\n     `;\r\n     contenedor.appendChild(card);\r\n   });\r\n }\r\n-document.addEventListener(\"DOMContentLoaded\", () => {\r\n-  // Elementos principales\r\n-  const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n-  const nav = document.getElementById(\"nav\"); // Menú lateral\r\n-  const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n-  const closeMenu = document.getElementById(\"close-menu\"); // Botón cerrar (❌)\r\n-  const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo (si existe)\r\n-  const topBar = document.querySelector(\".top-bar\"); // Barra superior (login, etc.)\r\n-  const header = document.querySelector(\".main-header\"); // Header principal\r\n-  const body = document.body;\r\n-\r\n-  let lastScrollTop = 0; // Guarda la última posición del scroll\r\n-\r\n-  // =========================\r\n-  // ABRIR Y CERRAR MENÚ\r\n-  // =========================\r\n-\r\n-  // Abrir menú con botón hamburguesa\r\n-  menuToggle?.addEventListener(\"click\", () => {\r\n-    nav.classList.toggle(\"activo\");\r\n-    overlayMenu.classList.toggle(\"activo\");\r\n-    overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n-  });\r\n-\r\n-  // Cerrar menú con botón ❌\r\n-  closeMenu?.addEventListener(\"click\", () => {\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n-    overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n-  });\r\n-\r\n-  // Cerrar menú al hacer clic en el overlay (fondo oscuro)\r\n-  overlayMenu?.addEventListener(\"click\", () => {\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n-  });\r\n-\r\n-  // Cerrar menú si se hace clic fuera de él (en desktop)\r\n-  document.addEventListener(\"click\", (e) => {\r\n-    if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n-      nav.classList.remove(\"activo\");\r\n-      overlayMenu.classList.remove(\"activo\");\r\n-    }\r\n-  });\r\n-\r\n-  // =========================\r\n-  // CERRAR MENÚ CON ESCAPE\r\n-  // =========================\r\n-  document.addEventListener(\"keydown\", (e) => {\r\n-    if (e.key === \"Escape\" && nav.classList.contains(\"activo\")) {\r\n-      nav.classList.remove(\"activo\");\r\n-      overlayMenu.classList.remove(\"activo\");\r\n-    }\r\n-  });\r\n-\r\n-  // =========================\r\n-  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-  // =========================\r\n-  window.addEventListener(\"scroll\", () => {\r\n-    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n-\r\n-    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-      promoBar?.classList.add(\"hidden\");\r\n-      topBar?.classList.add(\"hidden\");\r\n-\r\n-      header.style.top = \"0\";\r\n-      body.style.paddingTop = \"0\";\r\n-    } else {\r\n-      promoBar?.classList.remove(\"hidden\");\r\n-      topBar?.classList.remove(\"hidden\");\r\n-\r\n-      header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n-      body.style.paddingTop = \"180px\"; // Ajusta el espacio total del header\r\n-    }\r\n-\r\n-    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n-  });\r\n-});\r\n-// =========================\r\n-// OBTENEMOS LAS CATEGORIAS DE PRODUCTOS.JSON Y CARGARLOS EN MENU\r\n-// =========================\r\n-\r\n-let productosGlobal = []; // Guardamos todos los productos y ofertas\r\n-\r\n-fetch('productos.json')\r\n-  .then(response => response.json())\r\n-  .then(data => {\r\n-    const categorias = data.categorias; \r\n-    productosGlobal = data.productos.concat(data.ofertas); // unir productos + ofertas\r\n-\r\n-    const menuCategorias = document.getElementById('menu-categorias'); \r\n-    menuCategorias.innerHTML = '';\r\n-\r\n-    categorias.forEach(categoria => {\r\n-      let categoriaElemento = document.createElement('li');\r\n-      \r\n-      // Crear enlace de la categoría\r\n-      categoriaElemento.innerHTML = `\r\n-        <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n-          ${categoria.nombre}\r\n-        </a>\r\n-      `;\r\n-      menuCategorias.appendChild(categoriaElemento);\r\n-      \r\n-      // Crear subcategorías si existen\r\n-      if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n-        let subMenu = document.createElement('ul');\r\n-        subMenu.style.display = \"none\"; // oculto por defecto\r\n-\r\n-        categoria.subcategorias.forEach(subcategoria => {\r\n-          let subcategoriaElemento = document.createElement('li');\r\n-          subcategoriaElemento.innerHTML = `\r\n-            <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id})\">\r\n-              ${subcategoria.nombre}\r\n-            </a>\r\n-          `;\r\n-          subMenu.appendChild(subcategoriaElemento);\r\n-        });\r\n-\r\n-        categoriaElemento.appendChild(subMenu);\r\n-      }\r\n-    });\r\n-  })\r\n-  .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n-\r\n-// =========================\r\n-// Función para alternar la visibilidad de subcategorías (solo esa categoría)\r\n-// =========================\r\n-function toggleSubcategorias(event, categoriaLi) {\r\n-  event.preventDefault();\r\n-\r\n-  if (!categoriaLi) return; // seguridad\r\n-\r\n-  const subMenu = categoriaLi.querySelector(\"ul\");\r\n-  if (subMenu) {\r\n-    subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n-  }\r\n-}\r\n-\r\n-// =========================\r\n-// Mostrar productos filtrados por subcategoría\r\n-// =========================\r\n-function mostrarProductosPorSubcategoria(idSubcategoria) {\r\n-  const contenedor = document.getElementById(\"contenedor-productos\");\r\n-  contenedor.innerHTML = \"\";\r\n-\r\n-  const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n-\r\n-  if (filtrados.length === 0) {\r\n-    contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-    return;\r\n-  }\r\n-\r\n-  filtrados.forEach(prod => {\r\n-    let card = document.createElement(\"div\");\r\n-    card.classList.add(\"producto-card\");\r\n-    card.innerHTML = `\r\n-      <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n-      <h3>${prod.nombre}</h3>\r\n-      <p>${prod.descripcion}</p>\r\n-      <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n-      <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n-    `;\r\n-    contenedor.appendChild(card);\r\n-  });\r\n-}\r\n"
                },
                {
                    "date": 1759120406252,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,39 +91,40 @@\n     const menuCategorias = document.getElementById('menu-categorias'); \r\n     menuCategorias.innerHTML = '';\r\n \r\n     categorias.forEach(categoria => {\r\n-      let categoriaElemento = document.createElement('li');\r\n-      \r\n-      // Crear enlace de la categoría\r\n-      categoriaElemento.innerHTML = `\r\n-        <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n-          ${categoria.nombre}\r\n+  let categoriaElemento = document.createElement('li');\r\n+\r\n+  // ✅ Si el JSON trae \"icono\": \"fa-heartbeat\"\r\n+  const icono = categoria.icono ? `<i class=\"fa ${categoria.icono}\"></i>` : \"\";\r\n+\r\n+  // Crear enlace de la categoría con icono\r\n+  categoriaElemento.innerHTML = `\r\n+    <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n+      ${icono} ${categoria.nombre}\r\n+    </a>\r\n+  `;\r\n+  menuCategorias.appendChild(categoriaElemento);\r\n+\r\n+  // Crear subcategorías si existen\r\n+  if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n+    let subMenu = document.createElement('ul');\r\n+    subMenu.style.display = \"none\"; // oculto por defecto\r\n+\r\n+    categoria.subcategorias.forEach(subcategoria => {\r\n+      let subcategoriaElemento = document.createElement('li');\r\n+      subcategoriaElemento.innerHTML = `\r\n+        <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id})\">\r\n+          ${subcategoria.nombre}\r\n         </a>\r\n       `;\r\n-      menuCategorias.appendChild(categoriaElemento);\r\n-      \r\n-      // Crear subcategorías si existen\r\n-      if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n-        let subMenu = document.createElement('ul');\r\n-        subMenu.style.display = \"none\"; // oculto por defecto\r\n+      subMenu.appendChild(subcategoriaElemento);\r\n+    });\r\n \r\n-        categoria.subcategorias.forEach(subcategoria => {\r\n-          let subcategoriaElemento = document.createElement('li');\r\n-          subcategoriaElemento.innerHTML = `\r\n-            <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id})\">\r\n-              ${subcategoria.nombre}\r\n-            </a>\r\n-          `;\r\n-          subMenu.appendChild(subcategoriaElemento);\r\n-        });\r\n+    categoriaElemento.appendChild(subMenu);\r\n+  }\r\n+});\r\n \r\n-        categoriaElemento.appendChild(subMenu);\r\n-      }\r\n-    });\r\n-  })\r\n-  .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n-\r\n // =========================\r\n // Función para alternar la visibilidad de subcategorías (solo esa categoría)\r\n // =========================\r\n function toggleSubcategorias(event, categoriaLi) {\r\n"
                },
                {
                    "date": 1759121255418,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -91,40 +91,42 @@\n     const menuCategorias = document.getElementById('menu-categorias'); \r\n     menuCategorias.innerHTML = '';\r\n \r\n     categorias.forEach(categoria => {\r\n-  let categoriaElemento = document.createElement('li');\r\n+      let categoriaElemento = document.createElement('li');\r\n \r\n-  // ✅ Si el JSON trae \"icono\": \"fa-heartbeat\"\r\n-  const icono = categoria.icono ? `<i class=\"fa ${categoria.icono}\"></i>` : \"\";\r\n+      // ✅ Si el JSON trae \"icono\": \"fa-heartbeat\"\r\n+      const icono = categoria.icono ? `<i class=\"fa ${categoria.icono}\"></i>` : \"\";\r\n \r\n-  // Crear enlace de la categoría con icono\r\n-  categoriaElemento.innerHTML = `\r\n-    <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n-      ${icono} ${categoria.nombre}\r\n-    </a>\r\n-  `;\r\n-  menuCategorias.appendChild(categoriaElemento);\r\n-\r\n-  // Crear subcategorías si existen\r\n-  if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n-    let subMenu = document.createElement('ul');\r\n-    subMenu.style.display = \"none\"; // oculto por defecto\r\n-\r\n-    categoria.subcategorias.forEach(subcategoria => {\r\n-      let subcategoriaElemento = document.createElement('li');\r\n-      subcategoriaElemento.innerHTML = `\r\n-        <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id})\">\r\n-          ${subcategoria.nombre}\r\n+      // Crear enlace de la categoría con icono\r\n+      categoriaElemento.innerHTML = `\r\n+        <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n+          ${icono} ${categoria.nombre}\r\n         </a>\r\n       `;\r\n-      subMenu.appendChild(subcategoriaElemento);\r\n-    });\r\n+      menuCategorias.appendChild(categoriaElemento);\r\n \r\n-    categoriaElemento.appendChild(subMenu);\r\n-  }\r\n-});\r\n+      // Crear subcategorías si existen\r\n+      if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n+        let subMenu = document.createElement('ul');\r\n+        subMenu.style.display = \"none\"; // oculto por defecto\r\n \r\n+        categoria.subcategorias.forEach(subcategoria => {\r\n+          let subcategoriaElemento = document.createElement('li');\r\n+          subcategoriaElemento.innerHTML = `\r\n+            <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id})\">\r\n+              ${subcategoria.nombre}\r\n+            </a>\r\n+          `;\r\n+          subMenu.appendChild(subcategoriaElemento);\r\n+        });\r\n+\r\n+        categoriaElemento.appendChild(subMenu);\r\n+      }\r\n+    }); // ✅ cierre del forEach\r\n+\r\n+  }); // ✅ cierre del .then(data => { ... })\r\n+\r\n // =========================\r\n // Función para alternar la visibilidad de subcategorías (solo esa categoría)\r\n // =========================\r\n function toggleSubcategorias(event, categoriaLi) {\r\n"
                },
                {
                    "date": 1759123397501,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -158,8 +158,13 @@\n   const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n \r\n   if (filtrados.length === 0) {\r\n     contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+    // 🔒 Cerrar menú lateral aunque no haya productos\r\n+    const nav = document.getElementById(\"nav\");\r\n+    const overlayMenu = document.getElementById(\"overlay-menu\");\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n     return;\r\n   }\r\n \r\n   filtrados.forEach(prod => {\r\n@@ -173,5 +178,11 @@\n       <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n     `;\r\n     contenedor.appendChild(card);\r\n   });\r\n+\r\n+  // 🔒 Cerrar automáticamente el menú lateral al mostrar productos\r\n+  const nav = document.getElementById(\"nav\");\r\n+  const overlayMenu = document.getElementById(\"overlay-menu\");\r\n+  nav.classList.remove(\"activo\");\r\n+  overlayMenu.classList.remove(\"activo\");\r\n }\r\n"
                },
                {
                    "date": 1759123599379,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,20 +92,17 @@\n     menuCategorias.innerHTML = '';\r\n \r\n     categorias.forEach(categoria => {\r\n       let categoriaElemento = document.createElement('li');\r\n-\r\n-      // ✅ Si el JSON trae \"icono\": \"fa-heartbeat\"\r\n-      const icono = categoria.icono ? `<i class=\"fa ${categoria.icono}\"></i>` : \"\";\r\n-\r\n-      // Crear enlace de la categoría con icono\r\n+      \r\n+      // Crear enlace de la categoría\r\n       categoriaElemento.innerHTML = `\r\n         <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n-          ${icono} ${categoria.nombre}\r\n+          ${categoria.nombre}\r\n         </a>\r\n       `;\r\n       menuCategorias.appendChild(categoriaElemento);\r\n-\r\n+      \r\n       // Crear subcategorías si existen\r\n       if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n         let subMenu = document.createElement('ul');\r\n         subMenu.style.display = \"none\"; // oculto por defecto\r\n@@ -121,12 +118,12 @@\n         });\r\n \r\n         categoriaElemento.appendChild(subMenu);\r\n       }\r\n-    }); // ✅ cierre del forEach\r\n+    });\r\n+  })\r\n+  .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n \r\n-  }); // ✅ cierre del .then(data => { ... })\r\n-\r\n // =========================\r\n // Función para alternar la visibilidad de subcategorías (solo esa categoría)\r\n // =========================\r\n function toggleSubcategorias(event, categoriaLi) {\r\n@@ -158,13 +155,8 @@\n   const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n \r\n   if (filtrados.length === 0) {\r\n     contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-    // 🔒 Cerrar menú lateral aunque no haya productos\r\n-    const nav = document.getElementById(\"nav\");\r\n-    const overlayMenu = document.getElementById(\"overlay-menu\");\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n     return;\r\n   }\r\n \r\n   filtrados.forEach(prod => {\r\n@@ -178,11 +170,5 @@\n       <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n     `;\r\n     contenedor.appendChild(card);\r\n   });\r\n-\r\n-  // 🔒 Cerrar automáticamente el menú lateral al mostrar productos\r\n-  const nav = document.getElementById(\"nav\");\r\n-  const overlayMenu = document.getElementById(\"overlay-menu\");\r\n-  nav.classList.remove(\"activo\");\r\n-  overlayMenu.classList.remove(\"activo\");\r\n }\r\n"
                },
                {
                    "date": 1759124588219,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -122,27 +122,36 @@\n     });\r\n   })\r\n   .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n \r\n+\r\n // =========================\r\n // Función para alternar la visibilidad de subcategorías (solo esa categoría)\r\n // =========================\r\n function toggleSubcategorias(event, categoriaLi) {\r\n   event.preventDefault();\r\n   if (!categoriaLi) return;\r\n \r\n-  // 🔒 Cerrar todos los demás submenús\r\n+  const subMenu = categoriaLi.querySelector(\"ul\");\r\n+\r\n+  if (!subMenu) {\r\n+    // Si la categoría NO tiene subcategorías, cerrar el menú\r\n+    const nav = document.getElementById(\"nav\");\r\n+    const overlayMenu = document.getElementById(\"overlay-menu\");\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n+    return;\r\n+  }\r\n+\r\n+  // Cerrar todos los demás submenús\r\n   document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-    if (ul !== categoriaLi.querySelector(\"ul\")) {\r\n+    if (ul !== subMenu) {\r\n       ul.style.display = \"none\";\r\n     }\r\n   });\r\n \r\n-  // 🎯 Alternar solo el submenú clickeado\r\n-  const subMenu = categoriaLi.querySelector(\"ul\");\r\n-  if (subMenu) {\r\n-    subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n-  }\r\n+  // Alternar visibilidad del submenú\r\n+  subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n }\r\n \r\n \r\n // =========================\r\n@@ -155,20 +164,25 @@\n   const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n \r\n   if (filtrados.length === 0) {\r\n     contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-    return;\r\n+  } else {\r\n+    filtrados.forEach(prod => {\r\n+      let card = document.createElement(\"div\");\r\n+      card.classList.add(\"producto-card\");\r\n+      card.innerHTML = `\r\n+        <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+        <h3>${prod.nombre}</h3>\r\n+        <p>${prod.descripcion}</p>\r\n+        <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n+        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+      `;\r\n+      contenedor.appendChild(card);\r\n+    });\r\n   }\r\n \r\n-  filtrados.forEach(prod => {\r\n-    let card = document.createElement(\"div\");\r\n-    card.classList.add(\"producto-card\");\r\n-    card.innerHTML = `\r\n-      <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n-      <h3>${prod.nombre}</h3>\r\n-      <p>${prod.descripcion}</p>\r\n-      <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n-      <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n-    `;\r\n-    contenedor.appendChild(card);\r\n-  });\r\n+  // 🔒 Cerrar automáticamente el menú lateral al mostrar productos\r\n+  const nav = document.getElementById(\"nav\");\r\n+  const overlayMenu = document.getElementById(\"overlay-menu\");\r\n+  nav.classList.remove(\"activo\");\r\n+  overlayMenu.classList.remove(\"activo\");\r\n }\r\n"
                },
                {
                    "date": 1759124779980,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -122,39 +122,29 @@\n     });\r\n   })\r\n   .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n \r\n-\r\n // =========================\r\n // Función para alternar la visibilidad de subcategorías (solo esa categoría)\r\n // =========================\r\n function toggleSubcategorias(event, categoriaLi) {\r\n   event.preventDefault();\r\n   if (!categoriaLi) return;\r\n \r\n-  const subMenu = categoriaLi.querySelector(\"ul\");\r\n-\r\n-  if (!subMenu) {\r\n-    // Si la categoría NO tiene subcategorías, cerrar el menú\r\n-    const nav = document.getElementById(\"nav\");\r\n-    const overlayMenu = document.getElementById(\"overlay-menu\");\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n-    return;\r\n-  }\r\n-\r\n-  // Cerrar todos los demás submenús\r\n+  // 🔒 Cerrar todos los demás submenús\r\n   document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-    if (ul !== subMenu) {\r\n+    if (ul !== categoriaLi.querySelector(\"ul\")) {\r\n       ul.style.display = \"none\";\r\n     }\r\n   });\r\n \r\n-  // Alternar visibilidad del submenú\r\n-  subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n+  // 🎯 Alternar solo el submenú clickeado\r\n+  const subMenu = categoriaLi.querySelector(\"ul\");\r\n+  if (subMenu) {\r\n+    subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n+  }\r\n }\r\n \r\n-\r\n // =========================\r\n // Mostrar productos filtrados por subcategoría\r\n // =========================\r\n function mostrarProductosPorSubcategoria(idSubcategoria) {\r\n@@ -179,10 +169,10 @@\n       contenedor.appendChild(card);\r\n     });\r\n   }\r\n \r\n-  // 🔒 Cerrar automáticamente el menú lateral al mostrar productos\r\n+  // 🔒 Cerrar automáticamente el menú lateral al elegir una subcategoría\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n-  nav.classList.remove(\"activo\");\r\n-  overlayMenu.classList.remove(\"activo\");\r\n+  if(nav) nav.classList.remove(\"activo\");\r\n+  if(overlayMenu) overlayMenu.classList.remove(\"activo\");\r\n }\r\n"
                },
                {
                    "date": 1759125062358,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,26 +92,27 @@\n     menuCategorias.innerHTML = '';\r\n \r\n     categorias.forEach(categoria => {\r\n       let categoriaElemento = document.createElement('li');\r\n-      \r\n+\r\n       // Crear enlace de la categoría\r\n       categoriaElemento.innerHTML = `\r\n         <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n           ${categoria.nombre}\r\n         </a>\r\n       `;\r\n       menuCategorias.appendChild(categoriaElemento);\r\n-      \r\n+\r\n       // Crear subcategorías si existen\r\n       if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n         let subMenu = document.createElement('ul');\r\n         subMenu.style.display = \"none\"; // oculto por defecto\r\n \r\n         categoria.subcategorias.forEach(subcategoria => {\r\n           let subcategoriaElemento = document.createElement('li');\r\n+          // 🔹 Pasamos el evento al hacer clic para cerrar el menú\r\n           subcategoriaElemento.innerHTML = `\r\n-            <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id})\">\r\n+            <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id}, event)\">\r\n               ${subcategoria.nombre}\r\n             </a>\r\n           `;\r\n           subMenu.appendChild(subcategoriaElemento);\r\n@@ -146,9 +147,11 @@\n \r\n // =========================\r\n // Mostrar productos filtrados por subcategoría\r\n // =========================\r\n-function mostrarProductosPorSubcategoria(idSubcategoria) {\r\n+function mostrarProductosPorSubcategoria(idSubcategoria, event) {\r\n+  event.preventDefault(); // 🔹 Evita scroll al top\r\n+\r\n   const contenedor = document.getElementById(\"contenedor-productos\");\r\n   contenedor.innerHTML = \"\";\r\n \r\n   const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n@@ -169,9 +172,9 @@\n       contenedor.appendChild(card);\r\n     });\r\n   }\r\n \r\n-  // 🔒 Cerrar automáticamente el menú lateral al elegir una subcategoría\r\n+  // 🔒 Cerrar menú lateral automáticamente\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   if(nav) nav.classList.remove(\"activo\");\r\n   if(overlayMenu) overlayMenu.classList.remove(\"activo\");\r\n"
                },
                {
                    "date": 1759125323110,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -78,9 +78,8 @@\n });\r\n // =========================\r\n // OBTENEMOS LAS CATEGORIAS DE PRODUCTOS.JSON Y CARGARLOS EN MENU\r\n // =========================\r\n-\r\n let productosGlobal = []; // Guardamos todos los productos y ofertas\r\n \r\n fetch('productos.json')\r\n   .then(response => response.json())\r\n@@ -93,24 +92,23 @@\n \r\n     categorias.forEach(categoria => {\r\n       let categoriaElemento = document.createElement('li');\r\n \r\n-      // Crear enlace de la categoría\r\n+      // Enlace de categoría principal\r\n       categoriaElemento.innerHTML = `\r\n         <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n           ${categoria.nombre}\r\n         </a>\r\n       `;\r\n       menuCategorias.appendChild(categoriaElemento);\r\n \r\n-      // Crear subcategorías si existen\r\n+      // Subcategorías\r\n       if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n         let subMenu = document.createElement('ul');\r\n-        subMenu.style.display = \"none\"; // oculto por defecto\r\n+        subMenu.style.display = \"none\";\r\n \r\n         categoria.subcategorias.forEach(subcategoria => {\r\n           let subcategoriaElemento = document.createElement('li');\r\n-          // 🔹 Pasamos el evento al hacer clic para cerrar el menú\r\n           subcategoriaElemento.innerHTML = `\r\n             <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id}, event)\">\r\n               ${subcategoria.nombre}\r\n             </a>\r\n@@ -124,33 +122,27 @@\n   })\r\n   .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n \r\n // =========================\r\n-// Función para alternar la visibilidad de subcategorías (solo esa categoría)\r\n+// Alternar subcategorías\r\n // =========================\r\n function toggleSubcategorias(event, categoriaLi) {\r\n   event.preventDefault();\r\n   if (!categoriaLi) return;\r\n \r\n-  // 🔒 Cerrar todos los demás submenús\r\n   document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-    if (ul !== categoriaLi.querySelector(\"ul\")) {\r\n-      ul.style.display = \"none\";\r\n-    }\r\n+    if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n   });\r\n \r\n-  // 🎯 Alternar solo el submenú clickeado\r\n   const subMenu = categoriaLi.querySelector(\"ul\");\r\n-  if (subMenu) {\r\n-    subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n-  }\r\n+  if (subMenu) subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n }\r\n \r\n // =========================\r\n-// Mostrar productos filtrados por subcategoría\r\n+// Mostrar productos y cerrar menú lateral\r\n // =========================\r\n function mostrarProductosPorSubcategoria(idSubcategoria, event) {\r\n-  event.preventDefault(); // 🔹 Evita scroll al top\r\n+  event.preventDefault();\r\n \r\n   const contenedor = document.getElementById(\"contenedor-productos\");\r\n   contenedor.innerHTML = \"\";\r\n \r\n@@ -172,10 +164,10 @@\n       contenedor.appendChild(card);\r\n     });\r\n   }\r\n \r\n-  // 🔒 Cerrar menú lateral automáticamente\r\n+  // 🔒 Cerrar menú lateral y overlay\r\n   const nav = document.getElementById(\"nav\");\r\n-  const overlayMenu = document.getElementById(\"overlay-menu\");\r\n-  if(nav) nav.classList.remove(\"activo\");\r\n-  if(overlayMenu) overlayMenu.classList.remove(\"activo\");\r\n+  const overlay = document.getElementById(\"overlay-menu\");\r\n+  if (nav) nav.classList.remove(\"activo\");\r\n+  if (overlay) overlay.classList.remove(\"activo\");\r\n }\r\n"
                },
                {
                    "date": 1759125690364,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -136,38 +136,30 @@\n   const subMenu = categoriaLi.querySelector(\"ul\");\r\n   if (subMenu) subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n }\r\n \r\n-// =========================\r\n-// Mostrar productos y cerrar menú lateral\r\n-// =========================\r\n function mostrarProductosPorSubcategoria(idSubcategoria, event) {\r\n-  event.preventDefault();\r\n+  event.preventDefault(); // evita scroll al top\r\n \r\n+  // Carga de productos (tu código ya está correcto)\r\n   const contenedor = document.getElementById(\"contenedor-productos\");\r\n   contenedor.innerHTML = \"\";\r\n-\r\n   const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n+  filtrados.forEach(prod => {\r\n+    let card = document.createElement(\"div\");\r\n+    card.classList.add(\"producto-card\");\r\n+    card.innerHTML = `\r\n+      <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+      <h3>${prod.nombre}</h3>\r\n+      <p>${prod.descripcion}</p>\r\n+      <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n+      <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+    `;\r\n+    contenedor.appendChild(card);\r\n+  });\r\n \r\n-  if (filtrados.length === 0) {\r\n-    contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-  } else {\r\n-    filtrados.forEach(prod => {\r\n-      let card = document.createElement(\"div\");\r\n-      card.classList.add(\"producto-card\");\r\n-      card.innerHTML = `\r\n-        <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n-        <h3>${prod.nombre}</h3>\r\n-        <p>${prod.descripcion}</p>\r\n-        <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n-        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n-      `;\r\n-      contenedor.appendChild(card);\r\n-    });\r\n-  }\r\n-\r\n   // 🔒 Cerrar menú lateral y overlay\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlay = document.getElementById(\"overlay-menu\");\r\n-  if (nav) nav.classList.remove(\"activo\");\r\n-  if (overlay) overlay.classList.remove(\"activo\");\r\n+  nav?.classList.remove(\"activo\");\r\n+  overlay?.classList.remove(\"activo\");\r\n }\r\n"
                },
                {
                    "date": 1759126181048,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -136,30 +136,44 @@\n   const subMenu = categoriaLi.querySelector(\"ul\");\r\n   if (subMenu) subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n }\r\n \r\n+// =========================\r\n+// Mostrar productos y cerrar menú lateral\r\n+// =========================\r\n function mostrarProductosPorSubcategoria(idSubcategoria, event) {\r\n-  event.preventDefault(); // evita scroll al top\r\n+  event.preventDefault();\r\n \r\n-  // Carga de productos (tu código ya está correcto)\r\n   const contenedor = document.getElementById(\"contenedor-productos\");\r\n   contenedor.innerHTML = \"\";\r\n+\r\n+  // Filtrar productos por subcategoría\r\n   const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n-  filtrados.forEach(prod => {\r\n-    let card = document.createElement(\"div\");\r\n-    card.classList.add(\"producto-card\");\r\n-    card.innerHTML = `\r\n-      <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n-      <h3>${prod.nombre}</h3>\r\n-      <p>${prod.descripcion}</p>\r\n-      <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n-      <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n-    `;\r\n-    contenedor.appendChild(card);\r\n-  });\r\n \r\n+  if (filtrados.length === 0) {\r\n+    contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+  } else {\r\n+    filtrados.forEach(prod => {\r\n+      let card = document.createElement(\"div\");\r\n+      card.classList.add(\"producto-card\");\r\n+      card.innerHTML = `\r\n+        <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+        <h3>${prod.nombre}</h3>\r\n+        <p>${prod.descripcion}</p>\r\n+        <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n+        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+      `;\r\n+      contenedor.appendChild(card);\r\n+    });\r\n+  }\r\n+\r\n   // 🔒 Cerrar menú lateral y overlay\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlay = document.getElementById(\"overlay-menu\");\r\n-  nav?.classList.remove(\"activo\");\r\n-  overlay?.classList.remove(\"activo\");\r\n+  if (nav) nav.classList.remove(\"activo\");\r\n+  if (overlay) overlay.classList.remove(\"activo\");\r\n+\r\n+  // 🔹 Cerrar todas las subcategorías abiertas\r\n+  document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n+    ul.style.display = \"none\";\r\n+  });\r\n }\r\n"
                },
                {
                    "date": 1759126331648,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,50 +3,42 @@\n   const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n   const nav = document.getElementById(\"nav\"); // Menú lateral\r\n   const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n   const closeMenu = document.getElementById(\"close-menu\"); // Botón cerrar (❌)\r\n-  const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo (si existe)\r\n-  const topBar = document.querySelector(\".top-bar\"); // Barra superior (login, etc.)\r\n+  const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo\r\n+  const topBar = document.querySelector(\".top-bar\"); // Barra superior\r\n   const header = document.querySelector(\".main-header\"); // Header principal\r\n   const body = document.body;\r\n \r\n   let lastScrollTop = 0; // Guarda la última posición del scroll\r\n \r\n   // =========================\r\n   // ABRIR Y CERRAR MENÚ\r\n   // =========================\r\n-\r\n-  // Abrir menú con botón hamburguesa\r\n   menuToggle?.addEventListener(\"click\", () => {\r\n     nav.classList.toggle(\"activo\");\r\n     overlayMenu.classList.toggle(\"activo\");\r\n-    overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n   });\r\n \r\n-  // Cerrar menú con botón ❌\r\n   closeMenu?.addEventListener(\"click\", () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n-    overlayMenu.style.transition = \"background 0.3s ease-in-out\";\r\n   });\r\n \r\n-  // Cerrar menú al hacer clic en el overlay (fondo oscuro)\r\n   overlayMenu?.addEventListener(\"click\", () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n   });\r\n \r\n-  // Cerrar menú si se hace clic fuera de él (en desktop)\r\n+  // Cerrar menú si se hace clic fuera de él\r\n   document.addEventListener(\"click\", (e) => {\r\n     if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n       nav.classList.remove(\"activo\");\r\n       overlayMenu.classList.remove(\"activo\");\r\n     }\r\n   });\r\n \r\n-  // =========================\r\n-  // CERRAR MENÚ CON ESCAPE\r\n-  // =========================\r\n+  // Cerrar menú con ESC\r\n   document.addEventListener(\"keydown\", (e) => {\r\n     if (e.key === \"Escape\" && nav.classList.contains(\"activo\")) {\r\n       nav.classList.remove(\"activo\");\r\n       overlayMenu.classList.remove(\"activo\");\r\n@@ -61,40 +53,39 @@\n \r\n     if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n       promoBar?.classList.add(\"hidden\");\r\n       topBar?.classList.add(\"hidden\");\r\n-\r\n       header.style.top = \"0\";\r\n       body.style.paddingTop = \"0\";\r\n     } else {\r\n       promoBar?.classList.remove(\"hidden\");\r\n       topBar?.classList.remove(\"hidden\");\r\n-\r\n-      header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n-      body.style.paddingTop = \"180px\"; // Ajusta el espacio total del header\r\n+      header.style.top = \"72px\"; // Ajusta según altura de tus barras\r\n+      body.style.paddingTop = \"180px\"; \r\n     }\r\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n });\r\n+\r\n // =========================\r\n-// OBTENEMOS LAS CATEGORIAS DE PRODUCTOS.JSON Y CARGARLOS EN MENU\r\n+// OBTENER CATEGORÍAS Y CARGAR MENÚ\r\n // =========================\r\n-let productosGlobal = []; // Guardamos todos los productos y ofertas\r\n+let productosGlobal = [];\r\n \r\n fetch('productos.json')\r\n   .then(response => response.json())\r\n   .then(data => {\r\n-    const categorias = data.categorias; \r\n-    productosGlobal = data.productos.concat(data.ofertas); // unir productos + ofertas\r\n+    const categorias = data.categorias;\r\n+    productosGlobal = data.productos.concat(data.ofertas);\r\n \r\n-    const menuCategorias = document.getElementById('menu-categorias'); \r\n+    const menuCategorias = document.getElementById('menu-categorias');\r\n     menuCategorias.innerHTML = '';\r\n \r\n     categorias.forEach(categoria => {\r\n-      let categoriaElemento = document.createElement('li');\r\n+      const categoriaElemento = document.createElement('li');\r\n \r\n-      // Enlace de categoría principal\r\n+      // Enlace categoría principal\r\n       categoriaElemento.innerHTML = `\r\n         <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n           ${categoria.nombre}\r\n         </a>\r\n@@ -102,13 +93,13 @@\n       menuCategorias.appendChild(categoriaElemento);\r\n \r\n       // Subcategorías\r\n       if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n-        let subMenu = document.createElement('ul');\r\n+        const subMenu = document.createElement('ul');\r\n         subMenu.style.display = \"none\";\r\n \r\n         categoria.subcategorias.forEach(subcategoria => {\r\n-          let subcategoriaElemento = document.createElement('li');\r\n+          const subcategoriaElemento = document.createElement('li');\r\n           subcategoriaElemento.innerHTML = `\r\n             <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id}, event)\">\r\n               ${subcategoria.nombre}\r\n             </a>\r\n@@ -128,8 +119,9 @@\n function toggleSubcategorias(event, categoriaLi) {\r\n   event.preventDefault();\r\n   if (!categoriaLi) return;\r\n \r\n+  // Cerrar todas las demás subcategorías\r\n   document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n     if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n   });\r\n \r\n@@ -137,24 +129,23 @@\n   if (subMenu) subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n }\r\n \r\n // =========================\r\n-// Mostrar productos y cerrar menú lateral\r\n+// Mostrar productos y cerrar menú lateral y subcategorías\r\n // =========================\r\n function mostrarProductosPorSubcategoria(idSubcategoria, event) {\r\n   event.preventDefault();\r\n \r\n   const contenedor = document.getElementById(\"contenedor-productos\");\r\n   contenedor.innerHTML = \"\";\r\n \r\n-  // Filtrar productos por subcategoría\r\n   const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n \r\n   if (filtrados.length === 0) {\r\n     contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n   } else {\r\n     filtrados.forEach(prod => {\r\n-      let card = document.createElement(\"div\");\r\n+      const card = document.createElement(\"div\");\r\n       card.classList.add(\"producto-card\");\r\n       card.innerHTML = `\r\n         <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n         <h3>${prod.nombre}</h3>\r\n@@ -165,15 +156,13 @@\n       contenedor.appendChild(card);\r\n     });\r\n   }\r\n \r\n-  // 🔒 Cerrar menú lateral y overlay\r\n+  // Cerrar menú lateral y overlay\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlay = document.getElementById(\"overlay-menu\");\r\n   if (nav) nav.classList.remove(\"activo\");\r\n   if (overlay) overlay.classList.remove(\"activo\");\r\n \r\n-  // 🔹 Cerrar todas las subcategorías abiertas\r\n-  document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-    ul.style.display = \"none\";\r\n-  });\r\n+  // Cerrar todas las subcategorías abiertas\r\n+  document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => ul.style.display = \"none\");\r\n }\r\n"
                },
                {
                    "date": 1759126466868,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -131,12 +131,17 @@\n \r\n // =========================\r\n // Mostrar productos y cerrar menú lateral y subcategorías\r\n // =========================\r\n+// =========================\r\n+// Mostrar productos y cerrar menú lateral\r\n+// =========================\r\n function mostrarProductosPorSubcategoria(idSubcategoria, event) {\r\n-  event.preventDefault();\r\n+  if (event) event.preventDefault();\r\n \r\n+  // Filtrar productos\r\n   const contenedor = document.getElementById(\"contenedor-productos\");\r\n+  if (!contenedor) return; // Evita errores si el contenedor no existe\r\n   contenedor.innerHTML = \"\";\r\n \r\n   const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n \r\n@@ -156,13 +161,13 @@\n       contenedor.appendChild(card);\r\n     });\r\n   }\r\n \r\n-  // Cerrar menú lateral y overlay\r\n+  // 🔹 Cerrar menú lateral\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlay = document.getElementById(\"overlay-menu\");\r\n   if (nav) nav.classList.remove(\"activo\");\r\n   if (overlay) overlay.classList.remove(\"activo\");\r\n \r\n-  // Cerrar todas las subcategorías abiertas\r\n-  document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => ul.style.display = \"none\");\r\n+  // 🔹 Cerrar todas las subcategorías abiertas\r\n+  document.querySelectorAll(\"#menu-categorias ul\").forEach(ul => ul.style.display = \"none\");\r\n }\r\n"
                },
                {
                    "date": 1759126757477,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -65,14 +65,24 @@\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n });\r\n-\r\n // =========================\r\n // OBTENER CATEGORÍAS Y CARGAR MENÚ\r\n // =========================\r\n let productosGlobal = [];\r\n \r\n+// 🔸 Función reutilizable para cerrar menú y subcategorías\r\n+function cerrarMenuLateral() {\r\n+  const nav = document.getElementById(\"nav\");\r\n+  const overlay = document.getElementById(\"overlay-menu\");\r\n+  if (nav) nav.classList.remove(\"activo\");\r\n+  if (overlay) overlay.classList.remove(\"activo\");\r\n+\r\n+  // Cerrar todas las subcategorías\r\n+  document.querySelectorAll(\"#menu-categorias ul\").forEach(ul => ul.style.display = \"none\");\r\n+}\r\n+\r\n fetch('productos.json')\r\n   .then(response => response.json())\r\n   .then(data => {\r\n     const categorias = data.categorias;\r\n@@ -98,8 +108,9 @@\n         subMenu.style.display = \"none\";\r\n \r\n         categoria.subcategorias.forEach(subcategoria => {\r\n           const subcategoriaElemento = document.createElement('li');\r\n+          // ✅ Se asegura que al hacer clic, se llame correctamente a la función\r\n           subcategoriaElemento.innerHTML = `\r\n             <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id}, event)\">\r\n               ${subcategoria.nombre}\r\n             </a>\r\n@@ -131,17 +142,13 @@\n \r\n // =========================\r\n // Mostrar productos y cerrar menú lateral y subcategorías\r\n // =========================\r\n-// =========================\r\n-// Mostrar productos y cerrar menú lateral\r\n-// =========================\r\n function mostrarProductosPorSubcategoria(idSubcategoria, event) {\r\n   if (event) event.preventDefault();\r\n \r\n-  // Filtrar productos\r\n   const contenedor = document.getElementById(\"contenedor-productos\");\r\n-  if (!contenedor) return; // Evita errores si el contenedor no existe\r\n+  if (!contenedor) return;\r\n   contenedor.innerHTML = \"\";\r\n \r\n   const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n \r\n@@ -161,13 +168,7 @@\n       contenedor.appendChild(card);\r\n     });\r\n   }\r\n \r\n-  // 🔹 Cerrar menú lateral\r\n-  const nav = document.getElementById(\"nav\");\r\n-  const overlay = document.getElementById(\"overlay-menu\");\r\n-  if (nav) nav.classList.remove(\"activo\");\r\n-  if (overlay) overlay.classList.remove(\"activo\");\r\n-\r\n-  // 🔹 Cerrar todas las subcategorías abiertas\r\n-  document.querySelectorAll(\"#menu-categorias ul\").forEach(ul => ul.style.display = \"none\");\r\n+  // ✅ Cerrar menú y subcategorías correctamente\r\n+  cerrarMenuLateral();\r\n }\r\n"
                },
                {
                    "date": 1759127004135,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,19 +70,8 @@\n // OBTENER CATEGORÍAS Y CARGAR MENÚ\r\n // =========================\r\n let productosGlobal = [];\r\n \r\n-// 🔸 Función reutilizable para cerrar menú y subcategorías\r\n-function cerrarMenuLateral() {\r\n-  const nav = document.getElementById(\"nav\");\r\n-  const overlay = document.getElementById(\"overlay-menu\");\r\n-  if (nav) nav.classList.remove(\"activo\");\r\n-  if (overlay) overlay.classList.remove(\"activo\");\r\n-\r\n-  // Cerrar todas las subcategorías\r\n-  document.querySelectorAll(\"#menu-categorias ul\").forEach(ul => ul.style.display = \"none\");\r\n-}\r\n-\r\n fetch('productos.json')\r\n   .then(response => response.json())\r\n   .then(data => {\r\n     const categorias = data.categorias;\r\n@@ -108,14 +97,30 @@\n         subMenu.style.display = \"none\";\r\n \r\n         categoria.subcategorias.forEach(subcategoria => {\r\n           const subcategoriaElemento = document.createElement('li');\r\n-          // ✅ Se asegura que al hacer clic, se llame correctamente a la función\r\n-          subcategoriaElemento.innerHTML = `\r\n-            <a href=\"#\" onclick=\"mostrarProductosPorSubcategoria(${subcategoria.id}, event)\">\r\n-              ${subcategoria.nombre}\r\n-            </a>\r\n-          `;\r\n+          const enlace = document.createElement('a');\r\n+          enlace.href = \"#\";\r\n+          enlace.textContent = subcategoria.nombre;\r\n+\r\n+          // ✅ Aquí asignamos el evento correctamente\r\n+          enlace.addEventListener('click', (e) => {\r\n+            e.preventDefault();\r\n+            mostrarProductosPorSubcategoria(subcategoria.id);\r\n+            \r\n+            // ✅ Cerrar menú lateral al hacer clic en la subcategoría\r\n+            const nav = document.getElementById(\"nav\");\r\n+            const overlay = document.getElementById(\"overlay-menu\");\r\n+            if (nav) nav.classList.remove(\"activo\");\r\n+            if (overlay) overlay.classList.remove(\"activo\");\r\n+\r\n+            // Cerrar submenús abiertos\r\n+            document.querySelectorAll(\"#menu-categorias ul\").forEach(ul => {\r\n+              ul.style.display = \"none\";\r\n+            });\r\n+          });\r\n+\r\n+          subcategoriaElemento.appendChild(enlace);\r\n           subMenu.appendChild(subcategoriaElemento);\r\n         });\r\n \r\n         categoriaElemento.appendChild(subMenu);\r\n@@ -123,8 +128,9 @@\n     });\r\n   })\r\n   .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n \r\n+\r\n // =========================\r\n // Alternar subcategorías\r\n // =========================\r\n function toggleSubcategorias(event, categoriaLi) {\r\n"
                },
                {
                    "date": 1759127598361,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,38 +11,47 @@\n \r\n   let lastScrollTop = 0; // Guarda la última posición del scroll\r\n \r\n   // =========================\r\n+  // Función para cerrar menú lateral\r\n+  // =========================\r\n+  function cerrarMenuLateral() {\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n+\r\n+    // Cerrar todos los submenús desplegados\r\n+    document.querySelectorAll(\"#menu-categorias ul\").forEach(ul => {\r\n+      ul.style.display = \"none\";\r\n+    });\r\n+  }\r\n+\r\n+  // =========================\r\n   // ABRIR Y CERRAR MENÚ\r\n   // =========================\r\n   menuToggle?.addEventListener(\"click\", () => {\r\n     nav.classList.toggle(\"activo\");\r\n     overlayMenu.classList.toggle(\"activo\");\r\n   });\r\n \r\n   closeMenu?.addEventListener(\"click\", () => {\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n+    cerrarMenuLateral();\r\n   });\r\n \r\n   overlayMenu?.addEventListener(\"click\", () => {\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n+    cerrarMenuLateral();\r\n   });\r\n \r\n   // Cerrar menú si se hace clic fuera de él\r\n   document.addEventListener(\"click\", (e) => {\r\n     if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n-      nav.classList.remove(\"activo\");\r\n-      overlayMenu.classList.remove(\"activo\");\r\n+      cerrarMenuLateral();\r\n     }\r\n   });\r\n \r\n   // Cerrar menú con ESC\r\n   document.addEventListener(\"keydown\", (e) => {\r\n     if (e.key === \"Escape\" && nav.classList.contains(\"activo\")) {\r\n-      nav.classList.remove(\"activo\");\r\n-      overlayMenu.classList.remove(\"activo\");\r\n+      cerrarMenuLateral();\r\n     }\r\n   });\r\n \r\n   // =========================\r\n@@ -59,122 +68,113 @@\n     } else {\r\n       promoBar?.classList.remove(\"hidden\");\r\n       topBar?.classList.remove(\"hidden\");\r\n       header.style.top = \"72px\"; // Ajusta según altura de tus barras\r\n-      body.style.paddingTop = \"180px\"; \r\n+      body.style.paddingTop = \"180px\";\r\n     }\r\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n-});\r\n-// =========================\r\n-// OBTENER CATEGORÍAS Y CARGAR MENÚ\r\n-// =========================\r\n-let productosGlobal = [];\r\n \r\n-fetch('productos.json')\r\n-  .then(response => response.json())\r\n-  .then(data => {\r\n-    const categorias = data.categorias;\r\n-    productosGlobal = data.productos.concat(data.ofertas);\r\n+  // =========================\r\n+  // OBTENER CATEGORÍAS Y CARGAR MENÚ\r\n+  // =========================\r\n+  let productosGlobal = [];\r\n \r\n-    const menuCategorias = document.getElementById('menu-categorias');\r\n-    menuCategorias.innerHTML = '';\r\n+  fetch('productos.json')\r\n+    .then(response => response.json())\r\n+    .then(data => {\r\n+      const categorias = data.categorias;\r\n+      productosGlobal = data.productos.concat(data.ofertas);\r\n \r\n-    categorias.forEach(categoria => {\r\n-      const categoriaElemento = document.createElement('li');\r\n+      const menuCategorias = document.getElementById('menu-categorias');\r\n+      menuCategorias.innerHTML = '';\r\n \r\n-      // Enlace categoría principal\r\n-      categoriaElemento.innerHTML = `\r\n-        <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n-          ${categoria.nombre}\r\n-        </a>\r\n-      `;\r\n-      menuCategorias.appendChild(categoriaElemento);\r\n+      categorias.forEach(categoria => {\r\n+        const categoriaElemento = document.createElement('li');\r\n \r\n-      // Subcategorías\r\n-      if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n-        const subMenu = document.createElement('ul');\r\n-        subMenu.style.display = \"none\";\r\n+        // Enlace categoría principal\r\n+        categoriaElemento.innerHTML = `\r\n+          <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n+            ${categoria.nombre}\r\n+          </a>\r\n+        `;\r\n+        menuCategorias.appendChild(categoriaElemento);\r\n \r\n-        categoria.subcategorias.forEach(subcategoria => {\r\n-          const subcategoriaElemento = document.createElement('li');\r\n-          const enlace = document.createElement('a');\r\n-          enlace.href = \"#\";\r\n-          enlace.textContent = subcategoria.nombre;\r\n+        // Subcategorías\r\n+        if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n+          const subMenu = document.createElement('ul');\r\n+          subMenu.style.display = \"none\";\r\n \r\n-          // ✅ Aquí asignamos el evento correctamente\r\n-          enlace.addEventListener('click', (e) => {\r\n-            e.preventDefault();\r\n-            mostrarProductosPorSubcategoria(subcategoria.id);\r\n-            \r\n-            // ✅ Cerrar menú lateral al hacer clic en la subcategoría\r\n-            const nav = document.getElementById(\"nav\");\r\n-            const overlay = document.getElementById(\"overlay-menu\");\r\n-            if (nav) nav.classList.remove(\"activo\");\r\n-            if (overlay) overlay.classList.remove(\"activo\");\r\n+          categoria.subcategorias.forEach(subcategoria => {\r\n+            const subcategoriaElemento = document.createElement('li');\r\n+            const enlace = document.createElement('a');\r\n+            enlace.href = \"#\";\r\n+            enlace.textContent = subcategoria.nombre;\r\n \r\n-            // Cerrar submenús abiertos\r\n-            document.querySelectorAll(\"#menu-categorias ul\").forEach(ul => {\r\n-              ul.style.display = \"none\";\r\n+            // ✅ Evento de clic para subcategorías\r\n+            enlace.addEventListener('click', (e) => {\r\n+              e.preventDefault();\r\n+              mostrarProductosPorSubcategoria(subcategoria.id);\r\n+              cerrarMenuLateral();\r\n+\r\n+              // ✅ Scroll automático al contenedor de productos\r\n+              const contenedor = document.getElementById(\"contenedor-productos\");\r\n+              if (contenedor) {\r\n+                contenedor.scrollIntoView({ behavior: \"smooth\" });\r\n+              }\r\n             });\r\n+\r\n+            subcategoriaElemento.appendChild(enlace);\r\n+            subMenu.appendChild(subcategoriaElemento);\r\n           });\r\n \r\n-          subcategoriaElemento.appendChild(enlace);\r\n-          subMenu.appendChild(subcategoriaElemento);\r\n-        });\r\n+          categoriaElemento.appendChild(subMenu);\r\n+        }\r\n+      });\r\n+    })\r\n+    .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n \r\n-        categoriaElemento.appendChild(subMenu);\r\n-      }\r\n+  // =========================\r\n+  // Alternar subcategorías\r\n+  // =========================\r\n+  window.toggleSubcategorias = function(event, categoriaLi) {\r\n+    event.preventDefault();\r\n+    if (!categoriaLi) return;\r\n+\r\n+    // Cerrar todas las demás subcategorías\r\n+    document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n+      if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n     });\r\n-  })\r\n-  .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n \r\n+    const subMenu = categoriaLi.querySelector(\"ul\");\r\n+    if (subMenu) subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n+  };\r\n \r\n-// =========================\r\n-// Alternar subcategorías\r\n-// =========================\r\n-function toggleSubcategorias(event, categoriaLi) {\r\n-  event.preventDefault();\r\n-  if (!categoriaLi) return;\r\n+  // =========================\r\n+  // Mostrar productos por subcategoría\r\n+  // =========================\r\n+  window.mostrarProductosPorSubcategoria = function(idSubcategoria) {\r\n+    const contenedor = document.getElementById(\"contenedor-productos\");\r\n+    if (!contenedor) return;\r\n+    contenedor.innerHTML = \"\";\r\n \r\n-  // Cerrar todas las demás subcategorías\r\n-  document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-    if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n-  });\r\n+    const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n \r\n-  const subMenu = categoriaLi.querySelector(\"ul\");\r\n-  if (subMenu) subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n-}\r\n-\r\n-// =========================\r\n-// Mostrar productos y cerrar menú lateral y subcategorías\r\n-// =========================\r\n-function mostrarProductosPorSubcategoria(idSubcategoria, event) {\r\n-  if (event) event.preventDefault();\r\n-\r\n-  const contenedor = document.getElementById(\"contenedor-productos\");\r\n-  if (!contenedor) return;\r\n-  contenedor.innerHTML = \"\";\r\n-\r\n-  const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n-\r\n-  if (filtrados.length === 0) {\r\n-    contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-  } else {\r\n-    filtrados.forEach(prod => {\r\n-      const card = document.createElement(\"div\");\r\n-      card.classList.add(\"producto-card\");\r\n-      card.innerHTML = `\r\n-        <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n-        <h3>${prod.nombre}</h3>\r\n-        <p>${prod.descripcion}</p>\r\n-        <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n-        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n-      `;\r\n-      contenedor.appendChild(card);\r\n-    });\r\n-  }\r\n-\r\n-  // ✅ Cerrar menú y subcategorías correctamente\r\n-  cerrarMenuLateral();\r\n-}\r\n+    if (filtrados.length === 0) {\r\n+      contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+    } else {\r\n+      filtrados.forEach(prod => {\r\n+        const card = document.createElement(\"div\");\r\n+        card.classList.add(\"producto-card\");\r\n+        card.innerHTML = `\r\n+          <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+          <h3>${prod.nombre}</h3>\r\n+          <p>${prod.descripcion}</p>\r\n+          <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n+          <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+        `;\r\n+        contenedor.appendChild(card);\r\n+      });\r\n+    }\r\n+  };\r\n+});\r\n"
                },
                {
                    "date": 1759127980001,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,8 @@\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n-  // Elementos principales\r\n+  // =========================\r\n+  // ELEMENTOS PRINCIPALES\r\n+  // =========================\r\n   const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n   const nav = document.getElementById(\"nav\"); // Menú lateral\r\n   const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n   const closeMenu = document.getElementById(\"close-menu\"); // Botón cerrar (❌)\r\n@@ -9,11 +11,12 @@\n   const header = document.querySelector(\".main-header\"); // Header principal\r\n   const body = document.body;\r\n \r\n   let lastScrollTop = 0; // Guarda la última posición del scroll\r\n+  let productosGlobal = [];\r\n \r\n   // =========================\r\n-  // Función para cerrar menú lateral\r\n+  // FUNCIONES AUXILIARES\r\n   // =========================\r\n   function cerrarMenuLateral() {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n@@ -23,32 +26,67 @@\n       ul.style.display = \"none\";\r\n     });\r\n   }\r\n \r\n+  function toggleSubcategorias(event, categoriaLi) {\r\n+    event.preventDefault();\r\n+    if (!categoriaLi) return;\r\n+\r\n+    // Cerrar las demás subcategorías abiertas\r\n+    document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n+      if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n+    });\r\n+\r\n+    const subMenu = categoriaLi.querySelector(\"ul\");\r\n+    if (subMenu) {\r\n+      subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n+    }\r\n+  }\r\n+\r\n+  function mostrarProductosPorSubcategoria(idSubcategoria) {\r\n+    const contenedor = document.getElementById(\"contenedor-productos\");\r\n+    if (!contenedor) return;\r\n+\r\n+    contenedor.innerHTML = \"\";\r\n+    const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n+\r\n+    if (filtrados.length === 0) {\r\n+      contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+    } else {\r\n+      filtrados.forEach(prod => {\r\n+        const card = document.createElement(\"div\");\r\n+        card.classList.add(\"producto-card\");\r\n+        card.innerHTML = `\r\n+          <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+          <h3>${prod.nombre}</h3>\r\n+          <p>${prod.descripcion}</p>\r\n+          <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n+          <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+        `;\r\n+        contenedor.appendChild(card);\r\n+      });\r\n+    }\r\n+  }\r\n+\r\n   // =========================\r\n-  // ABRIR Y CERRAR MENÚ\r\n+  // EVENTOS DE MENÚ\r\n   // =========================\r\n   menuToggle?.addEventListener(\"click\", () => {\r\n     nav.classList.toggle(\"activo\");\r\n     overlayMenu.classList.toggle(\"activo\");\r\n   });\r\n \r\n-  closeMenu?.addEventListener(\"click\", () => {\r\n-    cerrarMenuLateral();\r\n-  });\r\n+  closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n+  overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n \r\n-  overlayMenu?.addEventListener(\"click\", () => {\r\n-    cerrarMenuLateral();\r\n-  });\r\n-\r\n-  // Cerrar menú si se hace clic fuera de él\r\n+  // Cerrar menú si se hace clic fuera\r\n   document.addEventListener(\"click\", (e) => {\r\n     if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n       cerrarMenuLateral();\r\n     }\r\n   });\r\n \r\n-  // Cerrar menú con ESC\r\n+  // Cerrar con tecla ESC\r\n   document.addEventListener(\"keydown\", (e) => {\r\n     if (e.key === \"Escape\" && nav.classList.contains(\"activo\")) {\r\n       cerrarMenuLateral();\r\n     }\r\n@@ -67,114 +105,67 @@\n       body.style.paddingTop = \"0\";\r\n     } else {\r\n       promoBar?.classList.remove(\"hidden\");\r\n       topBar?.classList.remove(\"hidden\");\r\n-      header.style.top = \"72px\"; // Ajusta según altura de tus barras\r\n+      header.style.top = \"72px\"; // Ajustar según altura de barras\r\n       body.style.paddingTop = \"180px\";\r\n     }\r\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n \r\n   // =========================\r\n-  // OBTENER CATEGORÍAS Y CARGAR MENÚ\r\n+  // CARGAR MENÚ DESDE productos.json\r\n   // =========================\r\n-  let productosGlobal = [];\r\n-\r\n   fetch('productos.json')\r\n     .then(response => response.json())\r\n     .then(data => {\r\n       const categorias = data.categorias;\r\n       productosGlobal = data.productos.concat(data.ofertas);\r\n+      const menuCategorias = document.getElementById('menu-categorias');\r\n \r\n-      const menuCategorias = document.getElementById('menu-categorias');\r\n+      if (!menuCategorias) return;\r\n       menuCategorias.innerHTML = '';\r\n \r\n       categorias.forEach(categoria => {\r\n         const categoriaElemento = document.createElement('li');\r\n \r\n         // Enlace categoría principal\r\n-        categoriaElemento.innerHTML = `\r\n-          <a href=\"#\" onclick=\"toggleSubcategorias(event, this.closest('li'))\">\r\n-            ${categoria.nombre}\r\n-          </a>\r\n-        `;\r\n-        menuCategorias.appendChild(categoriaElemento);\r\n+        const enlaceCategoria = document.createElement('a');\r\n+        enlaceCategoria.href = \"#\";\r\n+        enlaceCategoria.textContent = categoria.nombre;\r\n+        enlaceCategoria.addEventListener('click', (e) => toggleSubcategorias(e, categoriaElemento));\r\n+        categoriaElemento.appendChild(enlaceCategoria);\r\n \r\n         // Subcategorías\r\n         if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n           const subMenu = document.createElement('ul');\r\n           subMenu.style.display = \"none\";\r\n \r\n           categoria.subcategorias.forEach(subcategoria => {\r\n             const subcategoriaElemento = document.createElement('li');\r\n-            const enlace = document.createElement('a');\r\n-            enlace.href = \"#\";\r\n-            enlace.textContent = subcategoria.nombre;\r\n+            const enlaceSub = document.createElement('a');\r\n+            enlaceSub.href = \"#\";\r\n+            enlaceSub.textContent = subcategoria.nombre;\r\n \r\n-            // ✅ Evento de clic para subcategorías\r\n-            enlace.addEventListener('click', (e) => {\r\n+            enlaceSub.addEventListener('click', (e) => {\r\n               e.preventDefault();\r\n               mostrarProductosPorSubcategoria(subcategoria.id);\r\n               cerrarMenuLateral();\r\n \r\n-              // ✅ Scroll automático al contenedor de productos\r\n+              // Scroll automático al contenedor de productos\r\n               const contenedor = document.getElementById(\"contenedor-productos\");\r\n-              if (contenedor) {\r\n-                contenedor.scrollIntoView({ behavior: \"smooth\" });\r\n-              }\r\n+              if (contenedor) contenedor.scrollIntoView({ behavior: \"smooth\" });\r\n             });\r\n \r\n-            subcategoriaElemento.appendChild(enlace);\r\n+            subcategoriaElemento.appendChild(enlaceSub);\r\n             subMenu.appendChild(subcategoriaElemento);\r\n           });\r\n \r\n           categoriaElemento.appendChild(subMenu);\r\n         }\r\n+\r\n+        menuCategorias.appendChild(categoriaElemento);\r\n       });\r\n     })\r\n     .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n-\r\n-  // =========================\r\n-  // Alternar subcategorías\r\n-  // =========================\r\n-  window.toggleSubcategorias = function(event, categoriaLi) {\r\n-    event.preventDefault();\r\n-    if (!categoriaLi) return;\r\n-\r\n-    // Cerrar todas las demás subcategorías\r\n-    document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-      if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n-    });\r\n-\r\n-    const subMenu = categoriaLi.querySelector(\"ul\");\r\n-    if (subMenu) subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n-  };\r\n-\r\n-  // =========================\r\n-  // Mostrar productos por subcategoría\r\n-  // =========================\r\n-  window.mostrarProductosPorSubcategoria = function(idSubcategoria) {\r\n-    const contenedor = document.getElementById(\"contenedor-productos\");\r\n-    if (!contenedor) return;\r\n-    contenedor.innerHTML = \"\";\r\n-\r\n-    const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n-\r\n-    if (filtrados.length === 0) {\r\n-      contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-    } else {\r\n-      filtrados.forEach(prod => {\r\n-        const card = document.createElement(\"div\");\r\n-        card.classList.add(\"producto-card\");\r\n-        card.innerHTML = `\r\n-          <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n-          <h3>${prod.nombre}</h3>\r\n-          <p>${prod.descripcion}</p>\r\n-          <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n-          <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n-        `;\r\n-        contenedor.appendChild(card);\r\n-      });\r\n-    }\r\n-  };\r\n });\r\n"
                },
                {
                    "date": 1759128362490,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,23 +26,22 @@\n       ul.style.display = \"none\";\r\n     });\r\n   }\r\n \r\n-  function toggleSubcategorias(event, categoriaLi) {\r\n-    event.preventDefault();\r\n-    if (!categoriaLi) return;\r\n+window.toggleSubcategorias = function(event, categoriaLi) {\r\n+  event.preventDefault();\r\n+  if (!categoriaLi) return;\r\n \r\n-    // Cerrar las demás subcategorías abiertas\r\n-    document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-      if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n-    });\r\n+  // Cerrar otras subcategorías\r\n+  document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n+    if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n+  });\r\n \r\n-    const subMenu = categoriaLi.querySelector(\"ul\");\r\n-    if (subMenu) {\r\n-      subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n-    }\r\n+  const subMenu = categoriaLi.querySelector(\"ul\");\r\n+  if (subMenu) {\r\n+    subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n   }\r\n-\r\n+}\r\n   function mostrarProductosPorSubcategoria(idSubcategoria) {\r\n     const contenedor = document.getElementById(\"contenedor-productos\");\r\n     if (!contenedor) return;\r\n \r\n"
                },
                {
                    "date": 1759128628009,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,74 +1,33 @@\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n   // =========================\r\n   // ELEMENTOS PRINCIPALES\r\n   // =========================\r\n-  const menuToggle = document.getElementById(\"menu-toggle\"); // Botón hamburguesa\r\n-  const nav = document.getElementById(\"nav\"); // Menú lateral\r\n-  const overlayMenu = document.getElementById(\"overlay-menu\"); // Fondo oscuro\r\n-  const closeMenu = document.getElementById(\"close-menu\"); // Botón cerrar (❌)\r\n-  const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo\r\n-  const topBar = document.querySelector(\".top-bar\"); // Barra superior\r\n-  const header = document.querySelector(\".main-header\"); // Header principal\r\n+  const menuToggle = document.getElementById(\"menu-toggle\");\r\n+  const nav = document.getElementById(\"nav\");\r\n+  const overlayMenu = document.getElementById(\"overlay-menu\");\r\n+  const closeMenu = document.getElementById(\"close-menu\");\r\n+  const promoBar = document.querySelector(\".promo-bar\");\r\n+  const topBar = document.querySelector(\".top-bar\");\r\n+  const header = document.querySelector(\".main-header\");\r\n   const body = document.body;\r\n \r\n-  let lastScrollTop = 0; // Guarda la última posición del scroll\r\n+  let lastScrollTop = 0;\r\n   let productosGlobal = [];\r\n \r\n   // =========================\r\n-  // FUNCIONES AUXILIARES\r\n+  // FUNCIÓN: CERRAR MENÚ LATERAL\r\n   // =========================\r\n   function cerrarMenuLateral() {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n-\r\n-    // Cerrar todos los submenús desplegados\r\n     document.querySelectorAll(\"#menu-categorias ul\").forEach(ul => {\r\n       ul.style.display = \"none\";\r\n     });\r\n   }\r\n \r\n-window.toggleSubcategorias = function(event, categoriaLi) {\r\n-  event.preventDefault();\r\n-  if (!categoriaLi) return;\r\n-\r\n-  // Cerrar otras subcategorías\r\n-  document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-    if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n-  });\r\n-\r\n-  const subMenu = categoriaLi.querySelector(\"ul\");\r\n-  if (subMenu) {\r\n-    subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n-  }\r\n-}\r\n-  function mostrarProductosPorSubcategoria(idSubcategoria) {\r\n-    const contenedor = document.getElementById(\"contenedor-productos\");\r\n-    if (!contenedor) return;\r\n-\r\n-    contenedor.innerHTML = \"\";\r\n-    const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n-\r\n-    if (filtrados.length === 0) {\r\n-      contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-    } else {\r\n-      filtrados.forEach(prod => {\r\n-        const card = document.createElement(\"div\");\r\n-        card.classList.add(\"producto-card\");\r\n-        card.innerHTML = `\r\n-          <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n-          <h3>${prod.nombre}</h3>\r\n-          <p>${prod.descripcion}</p>\r\n-          <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n-          <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n-        `;\r\n-        contenedor.appendChild(card);\r\n-      });\r\n-    }\r\n-  }\r\n-\r\n   // =========================\r\n-  // EVENTOS DE MENÚ\r\n+  // ABRIR / CERRAR MENÚ\r\n   // =========================\r\n   menuToggle?.addEventListener(\"click\", () => {\r\n     nav.classList.toggle(\"activo\");\r\n     overlayMenu.classList.toggle(\"activo\");\r\n@@ -76,16 +35,14 @@\n \r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n \r\n-  // Cerrar menú si se hace clic fuera\r\n   document.addEventListener(\"click\", (e) => {\r\n     if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n       cerrarMenuLateral();\r\n     }\r\n   });\r\n \r\n-  // Cerrar con tecla ESC\r\n   document.addEventListener(\"keydown\", (e) => {\r\n     if (e.key === \"Escape\" && nav.classList.contains(\"activo\")) {\r\n       cerrarMenuLateral();\r\n     }\r\n@@ -104,67 +61,115 @@\n       body.style.paddingTop = \"0\";\r\n     } else {\r\n       promoBar?.classList.remove(\"hidden\");\r\n       topBar?.classList.remove(\"hidden\");\r\n-      header.style.top = \"72px\"; // Ajustar según altura de barras\r\n+      header.style.top = \"72px\"; // Ajustar según tu diseño\r\n       body.style.paddingTop = \"180px\";\r\n     }\r\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n \r\n   // =========================\r\n-  // CARGAR MENÚ DESDE productos.json\r\n+  // CARGAR CATEGORÍAS DESDE productos.json\r\n   // =========================\r\n-  fetch('productos.json')\r\n-    .then(response => response.json())\r\n+  fetch(\"productos.json\")\r\n+    .then(res => res.json())\r\n     .then(data => {\r\n-      const categorias = data.categorias;\r\n-      productosGlobal = data.productos.concat(data.ofertas);\r\n-      const menuCategorias = document.getElementById('menu-categorias');\r\n+      const categorias = data.categorias || [];\r\n+      productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n \r\n-      if (!menuCategorias) return;\r\n-      menuCategorias.innerHTML = '';\r\n+      const menuCategorias = document.getElementById(\"menu-categorias\");\r\n+      menuCategorias.innerHTML = \"\";\r\n \r\n       categorias.forEach(categoria => {\r\n-        const categoriaElemento = document.createElement('li');\r\n+        const categoriaLi = document.createElement(\"li\");\r\n \r\n-        // Enlace categoría principal\r\n-        const enlaceCategoria = document.createElement('a');\r\n-        enlaceCategoria.href = \"#\";\r\n-        enlaceCategoria.textContent = categoria.nombre;\r\n-        enlaceCategoria.addEventListener('click', (e) => toggleSubcategorias(e, categoriaElemento));\r\n-        categoriaElemento.appendChild(enlaceCategoria);\r\n+        // Enlace principal de categoría\r\n+        const enlaceCat = document.createElement(\"a\");\r\n+        enlaceCat.href = \"#\";\r\n+        enlaceCat.textContent = categoria.nombre;\r\n+        enlaceCat.addEventListener(\"click\", (e) => {\r\n+          e.preventDefault();\r\n+          window.toggleSubcategorias(e, categoriaLi);\r\n+        });\r\n \r\n+        categoriaLi.appendChild(enlaceCat);\r\n+\r\n         // Subcategorías\r\n         if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n-          const subMenu = document.createElement('ul');\r\n-          subMenu.style.display = \"none\";\r\n+          const subUl = document.createElement(\"ul\");\r\n+          subUl.style.display = \"none\";\r\n \r\n-          categoria.subcategorias.forEach(subcategoria => {\r\n-            const subcategoriaElemento = document.createElement('li');\r\n-            const enlaceSub = document.createElement('a');\r\n-            enlaceSub.href = \"#\";\r\n-            enlaceSub.textContent = subcategoria.nombre;\r\n+          categoria.subcategorias.forEach(sub => {\r\n+            const subLi = document.createElement(\"li\");\r\n+            const subA = document.createElement(\"a\");\r\n+            subA.href = \"#\";\r\n+            subA.textContent = sub.nombre;\r\n \r\n-            enlaceSub.addEventListener('click', (e) => {\r\n+            subA.addEventListener(\"click\", (e) => {\r\n               e.preventDefault();\r\n-              mostrarProductosPorSubcategoria(subcategoria.id);\r\n+              window.mostrarProductosPorSubcategoria(sub.id);\r\n               cerrarMenuLateral();\r\n \r\n-              // Scroll automático al contenedor de productos\r\n+              // Scroll al contenedor\r\n               const contenedor = document.getElementById(\"contenedor-productos\");\r\n               if (contenedor) contenedor.scrollIntoView({ behavior: \"smooth\" });\r\n             });\r\n \r\n-            subcategoriaElemento.appendChild(enlaceSub);\r\n-            subMenu.appendChild(subcategoriaElemento);\r\n+            subLi.appendChild(subA);\r\n+            subUl.appendChild(subLi);\r\n           });\r\n \r\n-          categoriaElemento.appendChild(subMenu);\r\n+          categoriaLi.appendChild(subUl);\r\n         }\r\n \r\n-        menuCategorias.appendChild(categoriaElemento);\r\n+        menuCategorias.appendChild(categoriaLi);\r\n       });\r\n     })\r\n-    .catch(error => console.error(\"Error al cargar categorías:\", error));\r\n+    .catch(err => console.error(\"Error al cargar categorías:\", err));\r\n+\r\n+  // =========================\r\n+  // FUNCIONES GLOBALES\r\n+  // =========================\r\n+\r\n+  // Alternar subcategorías\r\n+  window.toggleSubcategorias = function (event, categoriaLi) {\r\n+    event.preventDefault();\r\n+    if (!categoriaLi) return;\r\n+\r\n+    document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n+      if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n+    });\r\n+\r\n+    const subMenu = categoriaLi.querySelector(\"ul\");\r\n+    if (subMenu) {\r\n+      subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n+    }\r\n+  };\r\n+\r\n+  // Mostrar productos por subcategoría\r\n+  window.mostrarProductosPorSubcategoria = function (idSubcategoria) {\r\n+    const contenedor = document.getElementById(\"contenedor-productos\");\r\n+    if (!contenedor) return;\r\n+    contenedor.innerHTML = \"\";\r\n+\r\n+    const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n+\r\n+    if (filtrados.length === 0) {\r\n+      contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+    } else {\r\n+      filtrados.forEach(prod => {\r\n+        const card = document.createElement(\"div\");\r\n+        card.classList.add(\"producto-card\");\r\n+        card.innerHTML = `\r\n+          <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+          <h3>${prod.nombre}</h3>\r\n+          <p>${prod.descripcion}</p>\r\n+          <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n+          <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+        `;\r\n+        contenedor.appendChild(card);\r\n+      });\r\n+    }\r\n+  };\r\n });\r\n"
                },
                {
                    "date": 1759129381887,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,9 @@\n+// ===============================\r\n+// 📁 menu.js - Menú lateral dinámico\r\n+// ===============================\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n+\r\n   // =========================\r\n   // ELEMENTOS PRINCIPALES\r\n   // =========================\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n@@ -19,8 +23,10 @@\n   // =========================\r\n   function cerrarMenuLateral() {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n+\r\n+    // Cerrar todas las subcategorías abiertas\r\n     document.querySelectorAll(\"#menu-categorias ul\").forEach(ul => {\r\n       ul.style.display = \"none\";\r\n     });\r\n   }\r\n@@ -83,15 +89,15 @@\n \r\n       categorias.forEach(categoria => {\r\n         const categoriaLi = document.createElement(\"li\");\r\n \r\n-        // Enlace principal de categoría\r\n+        // Enlace de categoría\r\n         const enlaceCat = document.createElement(\"a\");\r\n         enlaceCat.href = \"#\";\r\n         enlaceCat.textContent = categoria.nombre;\r\n         enlaceCat.addEventListener(\"click\", (e) => {\r\n           e.preventDefault();\r\n-          window.toggleSubcategorias(e, categoriaLi);\r\n+          toggleSubcategorias(e, categoriaLi);\r\n         });\r\n \r\n         categoriaLi.appendChild(enlaceCat);\r\n \r\n@@ -107,12 +113,11 @@\n             subA.textContent = sub.nombre;\r\n \r\n             subA.addEventListener(\"click\", (e) => {\r\n               e.preventDefault();\r\n-              window.mostrarProductosPorSubcategoria(sub.id);\r\n+              mostrarProductosPorSubcategoria(sub.id);\r\n               cerrarMenuLateral();\r\n \r\n-              // Scroll al contenedor\r\n               const contenedor = document.getElementById(\"contenedor-productos\");\r\n               if (contenedor) contenedor.scrollIntoView({ behavior: \"smooth\" });\r\n             });\r\n \r\n@@ -125,31 +130,33 @@\n \r\n         menuCategorias.appendChild(categoriaLi);\r\n       });\r\n     })\r\n-    .catch(err => console.error(\"Error al cargar categorías:\", err));\r\n+    .catch(err => console.error(\"❌ Error al cargar categorías:\", err));\r\n \r\n   // =========================\r\n   // FUNCIONES GLOBALES\r\n   // =========================\r\n \r\n   // Alternar subcategorías\r\n-  window.toggleSubcategorias = function (event, categoriaLi) {\r\n+  function toggleSubcategorias(event, categoriaLi) {\r\n     event.preventDefault();\r\n     if (!categoriaLi) return;\r\n \r\n+    // Cierra todas las demás subcategorías\r\n     document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n       if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n     });\r\n \r\n+    // Alterna la visibilidad del submenú actual\r\n     const subMenu = categoriaLi.querySelector(\"ul\");\r\n     if (subMenu) {\r\n       subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n     }\r\n-  };\r\n+  }\r\n \r\n   // Mostrar productos por subcategoría\r\n-  window.mostrarProductosPorSubcategoria = function (idSubcategoria) {\r\n+  function mostrarProductosPorSubcategoria(idSubcategoria) {\r\n     const contenedor = document.getElementById(\"contenedor-productos\");\r\n     if (!contenedor) return;\r\n     contenedor.innerHTML = \"\";\r\n \r\n@@ -170,6 +177,7 @@\n         `;\r\n         contenedor.appendChild(card);\r\n       });\r\n     }\r\n-  };\r\n+  }\r\n+\r\n });\r\n"
                },
                {
                    "date": 1759129583373,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -136,24 +136,23 @@\n   // =========================\r\n   // FUNCIONES GLOBALES\r\n   // =========================\r\n \r\n-  // Alternar subcategorías\r\n-  function toggleSubcategorias(event, categoriaLi) {\r\n-    event.preventDefault();\r\n-    if (!categoriaLi) return;\r\n+window.toggleSubcategorias = function (event, categoriaLi) {\r\n+  event.preventDefault();\r\n+  if (!categoriaLi) return;\r\n \r\n-    // Cierra todas las demás subcategorías\r\n-    document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-      if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n-    });\r\n+  // Cerrar otros submenús abiertos\r\n+  document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n+    if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n+  });\r\n \r\n-    // Alterna la visibilidad del submenú actual\r\n-    const subMenu = categoriaLi.querySelector(\"ul\");\r\n-    if (subMenu) {\r\n-      subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n-    }\r\n+  // Alternar la subcategoría seleccionada\r\n+  const subMenu = categoriaLi.querySelector(\"ul\");\r\n+  if (subMenu) {\r\n+    subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n   }\r\n+}\r\n \r\n   // Mostrar productos por subcategoría\r\n   function mostrarProductosPorSubcategoria(idSubcategoria) {\r\n     const contenedor = document.getElementById(\"contenedor-productos\");\r\n"
                },
                {
                    "date": 1759129698720,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,12 +1,8 @@\n-// ===============================\r\n-// 📁 menu.js - Menú lateral dinámico\r\n-// ===============================\r\n+// js/menu.js (pegar todo esto)\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n+  console.log(\"menu.js arrancando…\");\r\n \r\n-  // =========================\r\n-  // ELEMENTOS PRINCIPALES\r\n-  // =========================\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n@@ -17,166 +13,254 @@\n \r\n   let lastScrollTop = 0;\r\n   let productosGlobal = [];\r\n \r\n-  // =========================\r\n-  // FUNCIÓN: CERRAR MENÚ LATERAL\r\n-  // =========================\r\n+  // helpers para mostrar logs y errores claros\r\n+  const log = (...args) => console.log(\"%c[menu.js]\", \"color: #0a84ff; font-weight:700\", ...args);\r\n+  const warn = (...args) => console.warn(\"%c[menu.js]\", \"color: #ff9f0a; font-weight:700\", ...args);\r\n+  const err = (...args) => console.error(\"%c[menu.js]\", \"color: #ff3b30; font-weight:700\", ...args);\r\n+\r\n+  // ---------------------------\r\n+  // Cerrar menú lateral\r\n+  // ---------------------------\r\n   function cerrarMenuLateral() {\r\n+    if (!nav || !overlayMenu) return;\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n \r\n-    // Cerrar todas las subcategorías abiertas\r\n-    document.querySelectorAll(\"#menu-categorias ul\").forEach(ul => {\r\n+    // quitar clase open y style display de submenus\r\n+    document.querySelectorAll(\"#menu-categorias ul, #menu-categorias .subcategorias\").forEach(ul => {\r\n+      ul.classList.remove(\"open\");\r\n       ul.style.display = \"none\";\r\n     });\r\n+\r\n+    log(\"Menú lateral cerrado\");\r\n   }\r\n \r\n-  // =========================\r\n-  // ABRIR / CERRAR MENÚ\r\n-  // =========================\r\n+  // ---------------------------\r\n+  // Toggle del menú principal (hamburguesa)\r\n+  // ---------------------------\r\n   menuToggle?.addEventListener(\"click\", () => {\r\n+    if (!nav || !overlayMenu) return;\r\n     nav.classList.toggle(\"activo\");\r\n     overlayMenu.classList.toggle(\"activo\");\r\n+    log(\"toggle menú (activo = \" + nav.classList.contains(\"activo\") + \")\");\r\n   });\r\n \r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n \r\n   document.addEventListener(\"click\", (e) => {\r\n-    if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n+    if (nav && nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle?.contains(e.target)) {\r\n       cerrarMenuLateral();\r\n     }\r\n   });\r\n \r\n   document.addEventListener(\"keydown\", (e) => {\r\n-    if (e.key === \"Escape\" && nav.classList.contains(\"activo\")) {\r\n+    if (e.key === \"Escape\" && nav?.classList.contains(\"activo\")) {\r\n       cerrarMenuLateral();\r\n     }\r\n   });\r\n \r\n-  // =========================\r\n-  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-  // =========================\r\n+  // ---------------------------\r\n+  // Scroll behaviour (tuya)\r\n+  // ---------------------------\r\n   window.addEventListener(\"scroll\", () => {\r\n     let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n     if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n       promoBar?.classList.add(\"hidden\");\r\n       topBar?.classList.add(\"hidden\");\r\n-      header.style.top = \"0\";\r\n-      body.style.paddingTop = \"0\";\r\n+      if (header) header.style.top = \"0\";\r\n+      if (body) body.style.paddingTop = \"0\";\r\n     } else {\r\n       promoBar?.classList.remove(\"hidden\");\r\n       topBar?.classList.remove(\"hidden\");\r\n-      header.style.top = \"72px\"; // Ajustar según tu diseño\r\n-      body.style.paddingTop = \"180px\";\r\n+      if (header) header.style.top = \"72px\";\r\n+      if (body) body.style.paddingTop = \"180px\";\r\n     }\r\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n \r\n-  // =========================\r\n-  // CARGAR CATEGORÍAS DESDE productos.json\r\n-  // =========================\r\n+  // ---------------------------\r\n+  // Funciones globales (expuestas)\r\n+  // ---------------------------\r\n+  // Exponemos toggleSubcategorias para que el onclick inline del HTML funcione\r\n+  window.toggleSubcategorias = function (event, categoriaLi) {\r\n+    try {\r\n+      event?.preventDefault();\r\n+    } catch (e) { /* nothing */ }\r\n+\r\n+    if (!categoriaLi) {\r\n+      warn(\"toggleSubcategorias: categoriaLi es null/undefined\");\r\n+      return;\r\n+    }\r\n+\r\n+    // Si el elemento pasado es el contenedor general (#menu-categorias), togglear ese UL\r\n+    const possibleUl = categoriaLi.querySelector(\"ul\");\r\n+    if (!possibleUl) {\r\n+      // si no encontró <ul>, intentar buscar #menu-categorias global\r\n+      const topMenu = document.getElementById(\"menu-categorias\");\r\n+      if (topMenu) {\r\n+        const isOpen = topMenu.style.display === \"block\" || topMenu.classList.contains(\"open\");\r\n+        topMenu.style.display = isOpen ? \"none\" : \"block\";\r\n+        topMenu.classList.toggle(\"open\", !isOpen);\r\n+        log(\"toggleSubcategorias: toggled top #menu-categorias (open=\", !isOpen, \")\");\r\n+      } else {\r\n+        warn(\"toggleSubcategorias: no se encontró submenú ni #menu-categorias\");\r\n+      }\r\n+      return;\r\n+    }\r\n+\r\n+    // cerrar otros submenus\r\n+    document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n+      if (ul !== possibleUl) {\r\n+        ul.style.display = \"none\";\r\n+        ul.classList.remove(\"open\");\r\n+      }\r\n+    });\r\n+\r\n+    const isOpen = possibleUl.style.display === \"block\" || possibleUl.classList.contains(\"open\");\r\n+    possibleUl.style.display = isOpen ? \"none\" : \"block\";\r\n+    possibleUl.classList.toggle(\"open\", !isOpen);\r\n+    log(\"toggleSubcategorias: toggled submenu para\", categoriaLi.querySelector(\"a\")?.textContent, \"open=\", !isOpen);\r\n+  };\r\n+\r\n+  // Mostrar productos por subcategoria: si render-catalogo define window.mostrarProductosPorSubcategoria, lo usamos.\r\n+  function fallbackMostrarProductosPorSubcategoria(idSubcategoria) {\r\n+    const cont = document.getElementById(\"contenedor-productos\");\r\n+    if (!cont) {\r\n+      warn(\"contenedor-productos no existe en DOM\");\r\n+      return;\r\n+    }\r\n+    cont.innerHTML = \"\";\r\n+    const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n+\r\n+    if (!filtrados.length) {\r\n+      cont.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+      return;\r\n+    }\r\n+\r\n+    filtrados.forEach(prod => {\r\n+      const card = document.createElement(\"div\");\r\n+      card.className = \"producto-card\";\r\n+      card.innerHTML = `\r\n+        <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+        <h3>${prod.nombre}</h3>\r\n+        <p>${prod.descripcion || \"\"}</p>\r\n+        <span class=\"precio\">S/ ${Number(prod.precio || 0).toFixed(2)}</span>\r\n+        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+      `;\r\n+      cont.appendChild(card);\r\n+    });\r\n+  }\r\n+\r\n+  // Exponemos una wrapper global que delega a window.mostrarProductosPorSubcategoria si existe\r\n+  window.mostrarProductosPorSubcategoria = function (idSubcategoria) {\r\n+    if (typeof window.__mostrarProductosPorSubcategoria === \"function\") {\r\n+      // si tienes otro script que define la lógica, preferimos usarlo\r\n+      window.__mostrarProductosPorSubcategoria(idSubcategoria);\r\n+    } else {\r\n+      fallbackMostrarProductosPorSubcategoria(idSubcategoria);\r\n+    }\r\n+  };\r\n+\r\n+  // Si render-catalogo.js define su propia función, permitimos registrarla como preferida:\r\n+  // Ejemplo: en render-catalogo.js puedes hacer window.__mostrarProductosPorSubcategoria = function(id){ ... }\r\n+  // Si no lo haces, usamos el fallback.\r\n+\r\n+  // ---------------------------\r\n+  // Cargar categorías (fetch)\r\n+  // ---------------------------\r\n+  const menuCategorias = document.getElementById(\"menu-categorias\");\r\n+  if (!menuCategorias) {\r\n+    err(\"No existe el elemento #menu-categorias en el DOM. Revisa tu HTML.\");\r\n+    return;\r\n+  }\r\n+\r\n+  log(\"Buscando productos.json… (ruta: productos.json)\");\r\n   fetch(\"productos.json\")\r\n-    .then(res => res.json())\r\n+    .then(resp => {\r\n+      if (!resp.ok) throw new Error(`HTTP ${resp.status} ${resp.statusText}`);\r\n+      return resp.json();\r\n+    })\r\n     .then(data => {\r\n-      const categorias = data.categorias || [];\r\n+      if (!data || !Array.isArray(data.categorias)) {\r\n+        throw new Error(\"El JSON no contiene data.categorias (array). Revisa productos.json\");\r\n+      }\r\n+\r\n+      const categorias = data.categorias;\r\n       productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n \r\n-      const menuCategorias = document.getElementById(\"menu-categorias\");\r\n-      menuCategorias.innerHTML = \"\";\r\n+      log(\"JSON cargado correctamente. Categorías encontradas:\", categorias.length);\r\n+      menuCategorias.innerHTML = \"\"; // limpiar\r\n \r\n-      categorias.forEach(categoria => {\r\n-        const categoriaLi = document.createElement(\"li\");\r\n+      categorias.forEach((categoria) => {\r\n+        const liCat = document.createElement(\"li\");\r\n+        liCat.className = \"categoria-item\";\r\n+        liCat.dataset.catId = categoria.id;\r\n \r\n-        // Enlace de categoría\r\n-        const enlaceCat = document.createElement(\"a\");\r\n-        enlaceCat.href = \"#\";\r\n-        enlaceCat.textContent = categoria.nombre;\r\n-        enlaceCat.addEventListener(\"click\", (e) => {\r\n+        // enlace categoria principal\r\n+        const aCat = document.createElement(\"a\");\r\n+        aCat.href = \"#\";\r\n+        aCat.textContent = categoria.nombre;\r\n+        aCat.addEventListener(\"click\", (e) => {\r\n           e.preventDefault();\r\n-          toggleSubcategorias(e, categoriaLi);\r\n+          // usamos la función global para compatibilidad con onclick inline\r\n+          window.toggleSubcategorias(e, liCat);\r\n         });\r\n \r\n-        categoriaLi.appendChild(enlaceCat);\r\n+        liCat.appendChild(aCat);\r\n \r\n-        // Subcategorías\r\n-        if (categoria.subcategorias && categoria.subcategorias.length > 0) {\r\n-          const subUl = document.createElement(\"ul\");\r\n-          subUl.style.display = \"none\";\r\n+        // subcategorias\r\n+        if (Array.isArray(categoria.subcategorias) && categoria.subcategorias.length) {\r\n+          const ulSub = document.createElement(\"ul\");\r\n+          ulSub.className = \"subcategorias\";\r\n+          ulSub.style.display = \"none\";\r\n \r\n           categoria.subcategorias.forEach(sub => {\r\n-            const subLi = document.createElement(\"li\");\r\n-            const subA = document.createElement(\"a\");\r\n-            subA.href = \"#\";\r\n-            subA.textContent = sub.nombre;\r\n+            const liSub = document.createElement(\"li\");\r\n+            liSub.dataset.subId = sub.id;\r\n \r\n-            subA.addEventListener(\"click\", (e) => {\r\n-              e.preventDefault();\r\n-              mostrarProductosPorSubcategoria(sub.id);\r\n+            const aSub = document.createElement(\"a\");\r\n+            aSub.href = \"#\";\r\n+            aSub.textContent = sub.nombre;\r\n+\r\n+            aSub.addEventListener(\"click\", (ev) => {\r\n+              ev.preventDefault();\r\n+              // preferimos la función que pueda venir de render-catalogo.js\r\n+              if (typeof window.mostrarProductosPorSubcategoria === \"function\") {\r\n+                window.mostrarProductosPorSubcategoria(sub.id);\r\n+              } else {\r\n+                fallbackMostrarProductosPorSubcategoria(sub.id);\r\n+              }\r\n               cerrarMenuLateral();\r\n-\r\n-              const contenedor = document.getElementById(\"contenedor-productos\");\r\n-              if (contenedor) contenedor.scrollIntoView({ behavior: \"smooth\" });\r\n+              document.getElementById(\"contenedor-productos\")?.scrollIntoView({ behavior: \"smooth\" });\r\n             });\r\n \r\n-            subLi.appendChild(subA);\r\n-            subUl.appendChild(subLi);\r\n+            liSub.appendChild(aSub);\r\n+            ulSub.appendChild(liSub);\r\n           });\r\n \r\n-          categoriaLi.appendChild(subUl);\r\n+          liCat.appendChild(ulSub);\r\n+        } else {\r\n+          // si no hay subcategorias, puedes decidir que el clic muestre productos por categoría\r\n+          aCat.addEventListener(\"click\", (ev) => {\r\n+            ev.preventDefault();\r\n+            // opcional: filtrar por categoria (si quieres)\r\n+            // fallbackMostrarProductosPorCategoria(categoria.id);\r\n+          }, { once: true });\r\n         }\r\n \r\n-        menuCategorias.appendChild(categoriaLi);\r\n+        menuCategorias.appendChild(liCat);\r\n       });\r\n+\r\n+      log(\"Menú construido: comprueba ahora si ves las categorías en el DOM.\");\r\n     })\r\n-    .catch(err => console.error(\"❌ Error al cargar categorías:\", err));\r\n+    .catch(error => {\r\n+      err(\"Error cargando productos.json:\", error);\r\n+      warn(\"Comprueba la ruta / permisos. Abre la pestaña Network y busca productos.json.\");\r\n+    });\r\n \r\n-  // =========================\r\n-  // FUNCIONES GLOBALES\r\n-  // =========================\r\n-\r\n-window.toggleSubcategorias = function (event, categoriaLi) {\r\n-  event.preventDefault();\r\n-  if (!categoriaLi) return;\r\n-\r\n-  // Cerrar otros submenús abiertos\r\n-  document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-    if (ul !== categoriaLi.querySelector(\"ul\")) ul.style.display = \"none\";\r\n-  });\r\n-\r\n-  // Alternar la subcategoría seleccionada\r\n-  const subMenu = categoriaLi.querySelector(\"ul\");\r\n-  if (subMenu) {\r\n-    subMenu.style.display = subMenu.style.display === \"block\" ? \"none\" : \"block\";\r\n-  }\r\n-}\r\n-\r\n-  // Mostrar productos por subcategoría\r\n-  function mostrarProductosPorSubcategoria(idSubcategoria) {\r\n-    const contenedor = document.getElementById(\"contenedor-productos\");\r\n-    if (!contenedor) return;\r\n-    contenedor.innerHTML = \"\";\r\n-\r\n-    const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n-\r\n-    if (filtrados.length === 0) {\r\n-      contenedor.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-    } else {\r\n-      filtrados.forEach(prod => {\r\n-        const card = document.createElement(\"div\");\r\n-        card.classList.add(\"producto-card\");\r\n-        card.innerHTML = `\r\n-          <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n-          <h3>${prod.nombre}</h3>\r\n-          <p>${prod.descripcion}</p>\r\n-          <span class=\"precio\">S/ ${prod.precio.toFixed(2)}</span>\r\n-          <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n-        `;\r\n-        contenedor.appendChild(card);\r\n-      });\r\n-    }\r\n-  }\r\n-\r\n+  // FIN DOMContentLoaded\r\n });\r\n"
                },
                {
                    "date": 1759129917253,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,73 +1,78 @@\n-// js/menu.js (pegar todo esto)\r\n+// js/menu.js\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n-  console.log(\"menu.js arrancando…\");\r\n+  const log = (...args) => console.log(\"%c[menu.js]\", \"color: #0a84ff; font-weight:700\", ...args);\r\n+  const warn = (...args) => console.warn(\"%c[menu.js]\", \"color: #ff9f0a; font-weight:700\", ...args);\r\n+  const err = (...args) => console.error(\"%c[menu.js]\", \"color: #ff3b30; font-weight:700\", ...args);\r\n \r\n+  log(\"iniciando...\");\r\n+\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const promoBar = document.querySelector(\".promo-bar\");\r\n   const topBar = document.querySelector(\".top-bar\");\r\n   const header = document.querySelector(\".main-header\");\r\n   const body = document.body;\r\n+  const menuCategorias = document.getElementById(\"menu-categorias\");\r\n+  const contenedorProductos = document.getElementById(\"contenedor-productos\"); // donde mostramos productos\r\n \r\n+  if (!menuCategorias) {\r\n+    err(\"No se encontró #menu-categorias en el DOM. Revisa tu HTML.\");\r\n+    return;\r\n+  }\r\n+\r\n+  let productosGlobal = [];\r\n   let lastScrollTop = 0;\r\n-  let productosGlobal = [];\r\n \r\n-  // helpers para mostrar logs y errores claros\r\n-  const log = (...args) => console.log(\"%c[menu.js]\", \"color: #0a84ff; font-weight:700\", ...args);\r\n-  const warn = (...args) => console.warn(\"%c[menu.js]\", \"color: #ff9f0a; font-weight:700\", ...args);\r\n-  const err = (...args) => console.error(\"%c[menu.js]\", \"color: #ff3b30; font-weight:700\", ...args);\r\n+  // =========================\r\n+  // abrir / cerrar menú lateral\r\n+  // =========================\r\n+  function abrirMenu() {\r\n+    if (!nav || !overlayMenu) return;\r\n+    nav.classList.add(\"activo\");\r\n+    overlayMenu.classList.add(\"activo\");\r\n+    menuToggle?.setAttribute(\"aria-expanded\", \"true\");\r\n+  }\r\n \r\n-  // ---------------------------\r\n-  // Cerrar menú lateral\r\n-  // ---------------------------\r\n   function cerrarMenuLateral() {\r\n     if (!nav || !overlayMenu) return;\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n+    menuToggle?.setAttribute(\"aria-expanded\", \"false\");\r\n \r\n-    // quitar clase open y style display de submenus\r\n-    document.querySelectorAll(\"#menu-categorias ul, #menu-categorias .subcategorias\").forEach(ul => {\r\n+    // Colapsar todos los submenús\r\n+    document.querySelectorAll(\"#menu-categorias > li > ul, #menu-categorias .subcategorias\").forEach(ul => {\r\n+      ul.style.display = \"none\";\r\n       ul.classList.remove(\"open\");\r\n-      ul.style.display = \"none\";\r\n+      const parentA = ul.closest(\"li\")?.querySelector(\"a\");\r\n+      if (parentA) parentA.setAttribute(\"aria-expanded\", \"false\");\r\n     });\r\n-\r\n-    log(\"Menú lateral cerrado\");\r\n+    log(\"Menú cerrado y submenús colapsados\");\r\n   }\r\n \r\n-  // ---------------------------\r\n-  // Toggle del menú principal (hamburguesa)\r\n-  // ---------------------------\r\n   menuToggle?.addEventListener(\"click\", () => {\r\n-    if (!nav || !overlayMenu) return;\r\n-    nav.classList.toggle(\"activo\");\r\n-    overlayMenu.classList.toggle(\"activo\");\r\n-    log(\"toggle menú (activo = \" + nav.classList.contains(\"activo\") + \")\");\r\n+    if (nav?.classList.contains(\"activo\")) cerrarMenuLateral();\r\n+    else abrirMenu();\r\n   });\r\n-\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n-\r\n+  document.addEventListener(\"keydown\", (e) => {\r\n+    if (e.key === \"Escape\") cerrarMenuLateral();\r\n+  });\r\n   document.addEventListener(\"click\", (e) => {\r\n-    if (nav && nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle?.contains(e.target)) {\r\n+    // cerrar si clic fuera del nav y el menu está abierto\r\n+    if (nav?.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle?.contains(e.target)) {\r\n       cerrarMenuLateral();\r\n     }\r\n   });\r\n \r\n-  document.addEventListener(\"keydown\", (e) => {\r\n-    if (e.key === \"Escape\" && nav?.classList.contains(\"activo\")) {\r\n-      cerrarMenuLateral();\r\n-    }\r\n-  });\r\n-\r\n-  // ---------------------------\r\n-  // Scroll behaviour (tuya)\r\n-  // ---------------------------\r\n+  // =========================\r\n+  // comportamiento scroll header (tuya)\r\n+  // =========================\r\n   window.addEventListener(\"scroll\", () => {\r\n     let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n-\r\n     if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n       promoBar?.classList.add(\"hidden\");\r\n       topBar?.classList.add(\"hidden\");\r\n       if (header) header.style.top = \"0\";\r\n@@ -77,71 +82,58 @@\n       topBar?.classList.remove(\"hidden\");\r\n       if (header) header.style.top = \"72px\";\r\n       if (body) body.style.paddingTop = \"180px\";\r\n     }\r\n-\r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n \r\n-  // ---------------------------\r\n-  // Funciones globales (expuestas)\r\n-  // ---------------------------\r\n-  // Exponemos toggleSubcategorias para que el onclick inline del HTML funcione\r\n+  // =========================\r\n+  // funciones globales (para onclick inline si las usas)\r\n+  // =========================\r\n   window.toggleSubcategorias = function (event, categoriaLi) {\r\n-    try {\r\n-      event?.preventDefault();\r\n-    } catch (e) { /* nothing */ }\r\n-\r\n+    if (event && typeof event.preventDefault === \"function\") event.preventDefault();\r\n     if (!categoriaLi) {\r\n-      warn(\"toggleSubcategorias: categoriaLi es null/undefined\");\r\n+      // fallback: togglear el bloque principal\r\n+      const top = document.getElementById(\"menu-categorias\");\r\n+      if (!top) return;\r\n+      const isOpen = top.style.display === \"block\" || top.classList.contains(\"open\");\r\n+      top.style.display = isOpen ? \"none\" : \"block\";\r\n+      top.classList.toggle(\"open\", !isOpen);\r\n       return;\r\n     }\r\n-\r\n-    // Si el elemento pasado es el contenedor general (#menu-categorias), togglear ese UL\r\n-    const possibleUl = categoriaLi.querySelector(\"ul\");\r\n-    if (!possibleUl) {\r\n-      // si no encontró <ul>, intentar buscar #menu-categorias global\r\n-      const topMenu = document.getElementById(\"menu-categorias\");\r\n-      if (topMenu) {\r\n-        const isOpen = topMenu.style.display === \"block\" || topMenu.classList.contains(\"open\");\r\n-        topMenu.style.display = isOpen ? \"none\" : \"block\";\r\n-        topMenu.classList.toggle(\"open\", !isOpen);\r\n-        log(\"toggleSubcategorias: toggled top #menu-categorias (open=\", !isOpen, \")\");\r\n-      } else {\r\n-        warn(\"toggleSubcategorias: no se encontró submenú ni #menu-categorias\");\r\n-      }\r\n+    const subMenu = categoriaLi.querySelector(\"ul\");\r\n+    if (!subMenu) {\r\n+      // no hay submenú, podríamos cargar productos por categoría si quieres\r\n       return;\r\n     }\r\n-\r\n-    // cerrar otros submenus\r\n+    // cerrar los otros submenus\r\n     document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-      if (ul !== possibleUl) {\r\n+      if (ul !== subMenu) {\r\n         ul.style.display = \"none\";\r\n         ul.classList.remove(\"open\");\r\n+        const pA = ul.closest(\"li\")?.querySelector(\"a\");\r\n+        if (pA) pA.setAttribute(\"aria-expanded\", \"false\");\r\n       }\r\n     });\r\n-\r\n-    const isOpen = possibleUl.style.display === \"block\" || possibleUl.classList.contains(\"open\");\r\n-    possibleUl.style.display = isOpen ? \"none\" : \"block\";\r\n-    possibleUl.classList.toggle(\"open\", !isOpen);\r\n-    log(\"toggleSubcategorias: toggled submenu para\", categoriaLi.querySelector(\"a\")?.textContent, \"open=\", !isOpen);\r\n+    const open = subMenu.style.display === \"block\" || subMenu.classList.contains(\"open\");\r\n+    subMenu.style.display = open ? \"none\" : \"block\";\r\n+    subMenu.classList.toggle(\"open\", !open);\r\n+    const parentA = categoriaLi.querySelector(\"a\");\r\n+    if (parentA) parentA.setAttribute(\"aria-expanded\", (!open).toString());\r\n   };\r\n \r\n-  // Mostrar productos por subcategoria: si render-catalogo define window.mostrarProductosPorSubcategoria, lo usamos.\r\n-  function fallbackMostrarProductosPorSubcategoria(idSubcategoria) {\r\n-    const cont = document.getElementById(\"contenedor-productos\");\r\n-    if (!cont) {\r\n-      warn(\"contenedor-productos no existe en DOM\");\r\n+  // Wrapper que usa el render-catalogo si existe o fallback\r\n+  function fallbackMostrarProductosPorSubcategoria(id) {\r\n+    if (!contenedorProductos) {\r\n+      warn(\"contenedor-productos no encontrado en DOM; no puedo mostrar productos\");\r\n       return;\r\n     }\r\n-    cont.innerHTML = \"\";\r\n-    const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n-\r\n+    contenedorProductos.innerHTML = \"\";\r\n+    const filtrados = productosGlobal.filter(p => p.subcategoria === id);\r\n     if (!filtrados.length) {\r\n-      cont.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+      contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n       return;\r\n     }\r\n-\r\n     filtrados.forEach(prod => {\r\n       const card = document.createElement(\"div\");\r\n       card.className = \"producto-card\";\r\n       card.innerHTML = `\r\n@@ -150,117 +142,117 @@\n         <p>${prod.descripcion || \"\"}</p>\r\n         <span class=\"precio\">S/ ${Number(prod.precio || 0).toFixed(2)}</span>\r\n         <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n       `;\r\n-      cont.appendChild(card);\r\n+      contenedorProductos.appendChild(card);\r\n     });\r\n   }\r\n-\r\n-  // Exponemos una wrapper global que delega a window.mostrarProductosPorSubcategoria si existe\r\n-  window.mostrarProductosPorSubcategoria = function (idSubcategoria) {\r\n+  // Exponer la función que usan otras partes\r\n+  window.mostrarProductosPorSubcategoria = function (id) {\r\n+    // Si tienes otra función preferida (render-catalogo), la puedes exponer en window.__mostrarProductosPorSubcategoria\r\n     if (typeof window.__mostrarProductosPorSubcategoria === \"function\") {\r\n-      // si tienes otro script que define la lógica, preferimos usarlo\r\n-      window.__mostrarProductosPorSubcategoria(idSubcategoria);\r\n+      window.__mostrarProductosPorSubcategoria(id);\r\n     } else {\r\n-      fallbackMostrarProductosPorSubcategoria(idSubcategoria);\r\n+      fallbackMostrarProductosPorSubcategoria(id);\r\n     }\r\n   };\r\n \r\n-  // Si render-catalogo.js define su propia función, permitimos registrarla como preferida:\r\n-  // Ejemplo: en render-catalogo.js puedes hacer window.__mostrarProductosPorSubcategoria = function(id){ ... }\r\n-  // Si no lo haces, usamos el fallback.\r\n+  // =========================\r\n+  // cargar categorias desde JSON\r\n+  // =========================\r\n+  (function cargarCategorias() {\r\n+    log(\"intentando fetch productos.json...\");\r\n+    fetch(\"productos.json\")\r\n+      .then(resp => {\r\n+        if (!resp.ok) throw new Error(`HTTP ${resp.status} ${resp.statusText}`);\r\n+        return resp.json();\r\n+      })\r\n+      .then(data => {\r\n+        if (!data || !Array.isArray(data.categorias)) throw new Error(\"data.categorias no es un array\");\r\n+        productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n+        buildMenuFromData(data.categorias);\r\n+        log(\"Menú construido con\", data.categorias.length, \"categorías\");\r\n+      })\r\n+      .catch(e => {\r\n+        warn(\"fetch('productos.json') falló:\", e.message);\r\n+        // intento fallback con ruta relativa alternativa\r\n+        fetch(\"./productos.json\")\r\n+          .then(r => {\r\n+            if (!r.ok) throw new Error(`HTTP ${r.status}`);\r\n+            return r.json();\r\n+          })\r\n+          .then(d2 => {\r\n+            productosGlobal = [...(d2.productos || []), ...(d2.ofertas || [])];\r\n+            buildMenuFromData(d2.categorias || []);\r\n+            log(\"Menú construido desde ./productos.json fallback\");\r\n+          })\r\n+          .catch(e2 => {\r\n+            err(\"No se pudo cargar productos.json. Revisa ruta y servidor. Error:\", e2.message);\r\n+            menuCategorias.innerHTML = \"<li style='color:#c00'>Error cargando categorías</li>\";\r\n+          });\r\n+      });\r\n+  })();\r\n \r\n-  // ---------------------------\r\n-  // Cargar categorías (fetch)\r\n-  // ---------------------------\r\n-  const menuCategorias = document.getElementById(\"menu-categorias\");\r\n-  if (!menuCategorias) {\r\n-    err(\"No existe el elemento #menu-categorias en el DOM. Revisa tu HTML.\");\r\n-    return;\r\n-  }\r\n+  // =========================\r\n+  // construir DOM del menú\r\n+  // =========================\r\n+  function buildMenuFromData(categorias) {\r\n+    menuCategorias.innerHTML = \"\";\r\n+    categorias.forEach(categoria => {\r\n+      const li = document.createElement(\"li\");\r\n+      li.className = \"categoria-item\";\r\n+      li.dataset.catId = categoria.id;\r\n \r\n-  log(\"Buscando productos.json… (ruta: productos.json)\");\r\n-  fetch(\"productos.json\")\r\n-    .then(resp => {\r\n-      if (!resp.ok) throw new Error(`HTTP ${resp.status} ${resp.statusText}`);\r\n-      return resp.json();\r\n-    })\r\n-    .then(data => {\r\n-      if (!data || !Array.isArray(data.categorias)) {\r\n-        throw new Error(\"El JSON no contiene data.categorias (array). Revisa productos.json\");\r\n-      }\r\n+      const a = document.createElement(\"a\");\r\n+      a.href = \"#\";\r\n+      a.textContent = categoria.nombre;\r\n+      a.setAttribute(\"role\", \"button\");\r\n+      a.setAttribute(\"aria-expanded\", \"false\");\r\n+      // al hacer click en la categoría: si tiene subcategorías -> toggle; si no -> podrías mostrar productos por categoría\r\n+      a.addEventListener(\"click\", (e) => {\r\n+        e.preventDefault();\r\n+        const sub = li.querySelector(\"ul\");\r\n+        if (sub) {\r\n+          // usa la global para compatibilidad\r\n+          window.toggleSubcategorias(e, li);\r\n+        } else {\r\n+          // si no hay sub, (opcional) mostrar por categoría y cerrar el menú\r\n+          // implementar si lo deseas: mostrarProductosPorCategoria(categoria.id)\r\n+          cerrarMenuLateral();\r\n+        }\r\n+      });\r\n \r\n-      const categorias = data.categorias;\r\n-      productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n+      li.appendChild(a);\r\n \r\n-      log(\"JSON cargado correctamente. Categorías encontradas:\", categorias.length);\r\n-      menuCategorias.innerHTML = \"\"; // limpiar\r\n+      if (Array.isArray(categoria.subcategorias) && categoria.subcategorias.length) {\r\n+        const ulSub = document.createElement(\"ul\");\r\n+        ulSub.className = \"subcategorias\";\r\n+        ulSub.style.display = \"none\";\r\n \r\n-      categorias.forEach((categoria) => {\r\n-        const liCat = document.createElement(\"li\");\r\n-        liCat.className = \"categoria-item\";\r\n-        liCat.dataset.catId = categoria.id;\r\n+        categoria.subcategorias.forEach(sub => {\r\n+          const liSub = document.createElement(\"li\");\r\n+          liSub.dataset.subId = sub.id;\r\n \r\n-        // enlace categoria principal\r\n-        const aCat = document.createElement(\"a\");\r\n-        aCat.href = \"#\";\r\n-        aCat.textContent = categoria.nombre;\r\n-        aCat.addEventListener(\"click\", (e) => {\r\n-          e.preventDefault();\r\n-          // usamos la función global para compatibilidad con onclick inline\r\n-          window.toggleSubcategorias(e, liCat);\r\n-        });\r\n-\r\n-        liCat.appendChild(aCat);\r\n-\r\n-        // subcategorias\r\n-        if (Array.isArray(categoria.subcategorias) && categoria.subcategorias.length) {\r\n-          const ulSub = document.createElement(\"ul\");\r\n-          ulSub.className = \"subcategorias\";\r\n-          ulSub.style.display = \"none\";\r\n-\r\n-          categoria.subcategorias.forEach(sub => {\r\n-            const liSub = document.createElement(\"li\");\r\n-            liSub.dataset.subId = sub.id;\r\n-\r\n-            const aSub = document.createElement(\"a\");\r\n-            aSub.href = \"#\";\r\n-            aSub.textContent = sub.nombre;\r\n-\r\n-            aSub.addEventListener(\"click\", (ev) => {\r\n-              ev.preventDefault();\r\n-              // preferimos la función que pueda venir de render-catalogo.js\r\n-              if (typeof window.mostrarProductosPorSubcategoria === \"function\") {\r\n-                window.mostrarProductosPorSubcategoria(sub.id);\r\n-              } else {\r\n-                fallbackMostrarProductosPorSubcategoria(sub.id);\r\n-              }\r\n-              cerrarMenuLateral();\r\n-              document.getElementById(\"contenedor-productos\")?.scrollIntoView({ behavior: \"smooth\" });\r\n-            });\r\n-\r\n-            liSub.appendChild(aSub);\r\n-            ulSub.appendChild(liSub);\r\n+          const aSub = document.createElement(\"a\");\r\n+          aSub.href = \"#\";\r\n+          aSub.textContent = sub.nombre;\r\n+          aSub.addEventListener(\"click\", (ev) => {\r\n+            ev.preventDefault();\r\n+            // preferimos wrapper global (es la función expuesta arriba)\r\n+            window.mostrarProductosPorSubcategoria(sub.id);\r\n+            cerrarMenuLateral();\r\n+            contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n \r\n-          liCat.appendChild(ulSub);\r\n-        } else {\r\n-          // si no hay subcategorias, puedes decidir que el clic muestre productos por categoría\r\n-          aCat.addEventListener(\"click\", (ev) => {\r\n-            ev.preventDefault();\r\n-            // opcional: filtrar por categoria (si quieres)\r\n-            // fallbackMostrarProductosPorCategoria(categoria.id);\r\n-          }, { once: true });\r\n-        }\r\n+          liSub.appendChild(aSub);\r\n+          ulSub.appendChild(liSub);\r\n+        });\r\n \r\n-        menuCategorias.appendChild(liCat);\r\n-      });\r\n+        li.appendChild(ulSub);\r\n+      }\r\n \r\n-      log(\"Menú construido: comprueba ahora si ves las categorías en el DOM.\");\r\n-    })\r\n-    .catch(error => {\r\n-      err(\"Error cargando productos.json:\", error);\r\n-      warn(\"Comprueba la ruta / permisos. Abre la pestaña Network y busca productos.json.\");\r\n+      menuCategorias.appendChild(li);\r\n     });\r\n+  }\r\n \r\n-  // FIN DOMContentLoaded\r\n+  // fin DOMContentLoaded\r\n });\r\n"
                },
                {
                    "date": 1759130278969,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,22 +1,20 @@\n // js/menu.js\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n-  const log = (...args) => console.log(\"%c[menu.js]\", \"color: #0a84ff; font-weight:700\", ...args);\r\n-  const warn = (...args) => console.warn(\"%c[menu.js]\", \"color: #ff9f0a; font-weight:700\", ...args);\r\n-  const err = (...args) => console.error(\"%c[menu.js]\", \"color: #ff3b30; font-weight:700\", ...args);\r\n+  const log = (...args) => console.log(\"%c[menu.js]\", \"color:#0a84ff;font-weight:700\", ...args);\r\n+  const warn = (...args) => console.warn(\"%c[menu.js]\", \"color:#ff9f0a;font-weight:700\", ...args);\r\n+  const err = (...args) => console.error(\"%c[menu.js]\", \"color:#ff3b30;font-weight:700\", ...args);\r\n \r\n-  log(\"iniciando...\");\r\n+  log(\"iniciando menu.js...\");\r\n \r\n+  // Elementos del DOM\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n-  const promoBar = document.querySelector(\".promo-bar\");\r\n-  const topBar = document.querySelector(\".top-bar\");\r\n-  const header = document.querySelector(\".main-header\");\r\n-  const body = document.body;\r\n-  const menuCategorias = document.getElementById(\"menu-categorias\");\r\n-  const contenedorProductos = document.getElementById(\"contenedor-productos\"); // donde mostramos productos\r\n+  const toggleCategorias = document.getElementById(\"toggle-categorias\"); // el \"Categorías\"\r\n+  const menuCategorias = document.getElementById(\"menu-categorias\"); // UL donde se inyecta\r\n+  const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n   if (!menuCategorias) {\r\n     err(\"No se encontró #menu-categorias en el DOM. Revisa tu HTML.\");\r\n     return;\r\n@@ -24,116 +22,90 @@\n \r\n   let productosGlobal = [];\r\n   let lastScrollTop = 0;\r\n \r\n-  // =========================\r\n+  // helpers visibilidad\r\n+  const isVisible = (el) => window.getComputedStyle(el).display !== \"none\";\r\n+  const show = (el) => { el.style.display = \"block\"; el.classList.add(\"open\"); };\r\n+  const hide = (el) => { el.style.display = \"none\"; el.classList.remove(\"open\"); };\r\n+\r\n   // abrir / cerrar menú lateral\r\n-  // =========================\r\n   function abrirMenu() {\r\n     if (!nav || !overlayMenu) return;\r\n     nav.classList.add(\"activo\");\r\n     overlayMenu.classList.add(\"activo\");\r\n     menuToggle?.setAttribute(\"aria-expanded\", \"true\");\r\n   }\r\n-\r\n   function cerrarMenuLateral() {\r\n     if (!nav || !overlayMenu) return;\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n     menuToggle?.setAttribute(\"aria-expanded\", \"false\");\r\n \r\n-    // Colapsar todos los submenús\r\n+    // colapsar submenus\r\n     document.querySelectorAll(\"#menu-categorias > li > ul, #menu-categorias .subcategorias\").forEach(ul => {\r\n-      ul.style.display = \"none\";\r\n-      ul.classList.remove(\"open\");\r\n+      hide(ul);\r\n       const parentA = ul.closest(\"li\")?.querySelector(\"a\");\r\n       if (parentA) parentA.setAttribute(\"aria-expanded\", \"false\");\r\n     });\r\n     log(\"Menú cerrado y submenús colapsados\");\r\n   }\r\n \r\n+  // eventos globales de apertura/cierre\r\n   menuToggle?.addEventListener(\"click\", () => {\r\n     if (nav?.classList.contains(\"activo\")) cerrarMenuLateral();\r\n     else abrirMenu();\r\n   });\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n-  document.addEventListener(\"keydown\", (e) => {\r\n-    if (e.key === \"Escape\") cerrarMenuLateral();\r\n-  });\r\n+  document.addEventListener(\"keydown\", (e) => { if (e.key === \"Escape\") cerrarMenuLateral(); });\r\n   document.addEventListener(\"click\", (e) => {\r\n-    // cerrar si clic fuera del nav y el menu está abierto\r\n     if (nav?.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle?.contains(e.target)) {\r\n       cerrarMenuLateral();\r\n     }\r\n   });\r\n \r\n-  // =========================\r\n-  // comportamiento scroll header (tuya)\r\n-  // =========================\r\n-  window.addEventListener(\"scroll\", () => {\r\n-    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n-    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-      promoBar?.classList.add(\"hidden\");\r\n-      topBar?.classList.add(\"hidden\");\r\n-      if (header) header.style.top = \"0\";\r\n-      if (body) body.style.paddingTop = \"0\";\r\n-    } else {\r\n-      promoBar?.classList.remove(\"hidden\");\r\n-      topBar?.classList.remove(\"hidden\");\r\n-      if (header) header.style.top = \"72px\";\r\n-      if (body) body.style.paddingTop = \"180px\";\r\n-    }\r\n-    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n-  });\r\n+  // Toggle del bloque principal \"Categorías\"\r\n+  if (toggleCategorias) {\r\n+    toggleCategorias.addEventListener(\"click\", (e) => {\r\n+      e.preventDefault();\r\n+      // si el lateral está cerrado, ábrelo primero\r\n+      if (!nav.classList.contains(\"activo\")) abrirMenu();\r\n+      // toggle de la lista principal\r\n+      if (isVisible(menuCategorias)) hide(menuCategorias);\r\n+      else show(menuCategorias);\r\n+      toggleCategorias.setAttribute(\"aria-expanded\", isVisible(menuCategorias).toString());\r\n+      log(\"toggle-categorias:\", isVisible(menuCategorias));\r\n+    });\r\n+  } else {\r\n+    warn(\"No encontrado #toggle-categorias. El enlace 'Categorías' puede no funcionar.\");\r\n+  }\r\n \r\n-  // =========================\r\n-  // funciones globales (para onclick inline si las usas)\r\n-  // =========================\r\n+  // Exponer toggleSubcategorias para compatibilidad con onclick inline\r\n   window.toggleSubcategorias = function (event, categoriaLi) {\r\n-    if (event && typeof event.preventDefault === \"function\") event.preventDefault();\r\n+    try { event?.preventDefault(); } catch(e) {}\r\n     if (!categoriaLi) {\r\n-      // fallback: togglear el bloque principal\r\n-      const top = document.getElementById(\"menu-categorias\");\r\n-      if (!top) return;\r\n-      const isOpen = top.style.display === \"block\" || top.classList.contains(\"open\");\r\n-      top.style.display = isOpen ? \"none\" : \"block\";\r\n-      top.classList.toggle(\"open\", !isOpen);\r\n+      // fallback toggle del contenedor principal\r\n+      if (isVisible(menuCategorias)) hide(menuCategorias); else show(menuCategorias);\r\n       return;\r\n     }\r\n-    const subMenu = categoriaLi.querySelector(\"ul\");\r\n-    if (!subMenu) {\r\n-      // no hay submenú, podríamos cargar productos por categoría si quieres\r\n-      return;\r\n-    }\r\n-    // cerrar los otros submenus\r\n+    const sub = categoriaLi.querySelector(\"ul\");\r\n+    if (!sub) return;\r\n+    // cerrar otras\r\n     document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-      if (ul !== subMenu) {\r\n-        ul.style.display = \"none\";\r\n-        ul.classList.remove(\"open\");\r\n-        const pA = ul.closest(\"li\")?.querySelector(\"a\");\r\n-        if (pA) pA.setAttribute(\"aria-expanded\", \"false\");\r\n-      }\r\n+      if (ul !== sub) hide(ul);\r\n     });\r\n-    const open = subMenu.style.display === \"block\" || subMenu.classList.contains(\"open\");\r\n-    subMenu.style.display = open ? \"none\" : \"block\";\r\n-    subMenu.classList.toggle(\"open\", !open);\r\n+    if (isVisible(sub)) hide(sub); else show(sub);\r\n     const parentA = categoriaLi.querySelector(\"a\");\r\n-    if (parentA) parentA.setAttribute(\"aria-expanded\", (!open).toString());\r\n+    if (parentA) parentA.setAttribute(\"aria-expanded\", isVisible(sub).toString());\r\n   };\r\n \r\n-  // Wrapper que usa el render-catalogo si existe o fallback\r\n-  function fallbackMostrarProductosPorSubcategoria(id) {\r\n-    if (!contenedorProductos) {\r\n-      warn(\"contenedor-productos no encontrado en DOM; no puedo mostrar productos\");\r\n-      return;\r\n-    }\r\n+  // Mostrar productos (wrapper): usa render-catalogo si define window.__mostrarProductosPorSubcategoria\r\n+  function fallbackMostrarProductosPorSubcategoria(idSubcategoria) {\r\n+    if (!contenedorProductos) { warn(\"contenedor-productos no existe\"); return; }\r\n     contenedorProductos.innerHTML = \"\";\r\n-    const filtrados = productosGlobal.filter(p => p.subcategoria === id);\r\n-    if (!filtrados.length) {\r\n-      contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-      return;\r\n-    }\r\n+    const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n+    if (!filtrados.length) { contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\"; return; }\r\n     filtrados.forEach(prod => {\r\n       const card = document.createElement(\"div\");\r\n       card.className = \"producto-card\";\r\n       card.innerHTML = `\r\n@@ -145,105 +117,98 @@\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n   }\r\n-  // Exponer la función que usan otras partes\r\n-  window.mostrarProductosPorSubcategoria = function (id) {\r\n-    // Si tienes otra función preferida (render-catalogo), la puedes exponer en window.__mostrarProductosPorSubcategoria\r\n+  window.mostrarProductosPorSubcategoria = function (idSub) {\r\n     if (typeof window.__mostrarProductosPorSubcategoria === \"function\") {\r\n-      window.__mostrarProductosPorSubcategoria(id);\r\n+      window.__mostrarProductosPorSubcategoria(idSub);\r\n     } else {\r\n-      fallbackMostrarProductosPorSubcategoria(id);\r\n+      fallbackMostrarProductosPorSubcategoria(idSub);\r\n     }\r\n   };\r\n \r\n-  // =========================\r\n-  // cargar categorias desde JSON\r\n-  // =========================\r\n-  (function cargarCategorias() {\r\n-    log(\"intentando fetch productos.json...\");\r\n+  // fetch y construcción del menú\r\n+  (function cargarYCargarMenu() {\r\n+    log(\"fetch productos.json...\");\r\n     fetch(\"productos.json\")\r\n-      .then(resp => {\r\n-        if (!resp.ok) throw new Error(`HTTP ${resp.status} ${resp.statusText}`);\r\n-        return resp.json();\r\n+      .then(r => {\r\n+        if (!r.ok) throw new Error(`HTTP ${r.status}`);\r\n+        return r.json();\r\n       })\r\n       .then(data => {\r\n         if (!data || !Array.isArray(data.categorias)) throw new Error(\"data.categorias no es un array\");\r\n-        productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n-        buildMenuFromData(data.categorias);\r\n-        log(\"Menú construido con\", data.categorias.length, \"categorías\");\r\n+        productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n+        construirMenu(data.categorias);\r\n+        log(\"Menú creado con\", data.categorias.length, \"categorías\");\r\n       })\r\n       .catch(e => {\r\n-        warn(\"fetch('productos.json') falló:\", e.message);\r\n-        // intento fallback con ruta relativa alternativa\r\n+        warn(\"fetch productos.json falló:\", e.message, \"Intentando ./productos.json\");\r\n+        // intento fallback\r\n         fetch(\"./productos.json\")\r\n-          .then(r => {\r\n-            if (!r.ok) throw new Error(`HTTP ${r.status}`);\r\n-            return r.json();\r\n-          })\r\n+          .then(r2 => { if (!r2.ok) throw new Error(`HTTP ${r2.status}`); return r2.json(); })\r\n           .then(d2 => {\r\n-            productosGlobal = [...(d2.productos || []), ...(d2.ofertas || [])];\r\n-            buildMenuFromData(d2.categorias || []);\r\n-            log(\"Menú construido desde ./productos.json fallback\");\r\n+            productosGlobal = [...(d2.productos||[]), ...(d2.ofertas||[])];\r\n+            construirMenu(d2.categorias || []);\r\n+            log(\"Menú creado desde ./productos.json (fallback)\");\r\n           })\r\n           .catch(e2 => {\r\n-            err(\"No se pudo cargar productos.json. Revisa ruta y servidor. Error:\", e2.message);\r\n+            err(\"No se pudo cargar productos.json:\", e2.message);\r\n             menuCategorias.innerHTML = \"<li style='color:#c00'>Error cargando categorías</li>\";\r\n           });\r\n       });\r\n   })();\r\n \r\n-  // =========================\r\n-  // construir DOM del menú\r\n-  // =========================\r\n-  function buildMenuFromData(categorias) {\r\n+  function construirMenu(categorias) {\r\n     menuCategorias.innerHTML = \"\";\r\n-    categorias.forEach(categoria => {\r\n+    categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       li.className = \"categoria-item\";\r\n-      li.dataset.catId = categoria.id;\r\n+      li.dataset.catId = cat.id;\r\n \r\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\";\r\n-      a.textContent = categoria.nombre;\r\n+      a.textContent = cat.nombre;\r\n       a.setAttribute(\"role\", \"button\");\r\n       a.setAttribute(\"aria-expanded\", \"false\");\r\n-      // al hacer click en la categoría: si tiene subcategorías -> toggle; si no -> podrías mostrar productos por categoría\r\n       a.addEventListener(\"click\", (e) => {\r\n         e.preventDefault();\r\n+        // si nav no está activo, abrirlo\r\n+        if (!nav.classList.contains(\"activo\")) abrirMenu();\r\n+        // si la lista principal está oculta, mostrarla (caso cuando se abre desde icono fuera)\r\n+        if (!isVisible(menuCategorias)) show(menuCategorias);\r\n+        // si tiene submenus togglearlo\r\n         const sub = li.querySelector(\"ul\");\r\n         if (sub) {\r\n-          // usa la global para compatibilidad\r\n-          window.toggleSubcategorias(e, li);\r\n+          // cerrar otras subcategorias\r\n+          document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => { if (ul !== sub) hide(ul); });\r\n+          if (isVisible(sub)) hide(sub); else show(sub);\r\n+          a.setAttribute(\"aria-expanded\", isVisible(sub).toString());\r\n         } else {\r\n-          // si no hay sub, (opcional) mostrar por categoría y cerrar el menú\r\n-          // implementar si lo deseas: mostrarProductosPorCategoria(categoria.id)\r\n+          // sin subcategorías: podrías mostrar productos por categoría\r\n           cerrarMenuLateral();\r\n         }\r\n       });\r\n \r\n       li.appendChild(a);\r\n \r\n-      if (Array.isArray(categoria.subcategorias) && categoria.subcategorias.length) {\r\n+      // Subcategorías\r\n+      if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n         const ulSub = document.createElement(\"ul\");\r\n         ulSub.className = \"subcategorias\";\r\n         ulSub.style.display = \"none\";\r\n \r\n-        categoria.subcategorias.forEach(sub => {\r\n+        cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           liSub.dataset.subId = sub.id;\r\n-\r\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\";\r\n           aSub.textContent = sub.nombre;\r\n           aSub.addEventListener(\"click\", (ev) => {\r\n             ev.preventDefault();\r\n-            // preferimos wrapper global (es la función expuesta arriba)\r\n             window.mostrarProductosPorSubcategoria(sub.id);\r\n             cerrarMenuLateral();\r\n             contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n-\r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n@@ -253,6 +218,23 @@\n       menuCategorias.appendChild(li);\r\n     });\r\n   }\r\n \r\n-  // fin DOMContentLoaded\r\n+  // comportamiento scroll header (si lo quieres mantener)\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+      document.querySelector(\".promo-bar\")?.classList.add(\"hidden\");\r\n+      document.querySelector(\".top-bar\")?.classList.add(\"hidden\");\r\n+      if (header) header.style.top = \"0\";\r\n+      if (body) body.style.paddingTop = \"0\";\r\n+    } else {\r\n+      document.querySelector(\".promo-bar\")?.classList.remove(\"hidden\");\r\n+      document.querySelector(\".top-bar\")?.classList.remove(\"hidden\");\r\n+      if (header) header.style.top = \"72px\";\r\n+      if (body) body.style.paddingTop = \"180px\";\r\n+    }\r\n+    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+  });\r\n+\r\n+  log(\"menu.js listo.\");\r\n });\r\n"
                },
                {
                    "date": 1759130744201,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,20 +1,22 @@\n // js/menu.js\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n-  const log = (...args) => console.log(\"%c[menu.js]\", \"color:#0a84ff;font-weight:700\", ...args);\r\n-  const warn = (...args) => console.warn(\"%c[menu.js]\", \"color:#ff9f0a;font-weight:700\", ...args);\r\n-  const err = (...args) => console.error(\"%c[menu.js]\", \"color:#ff3b30;font-weight:700\", ...args);\r\n+  const log = (...args) => console.log(\"%c[menu.js]\", \"color: #0a84ff; font-weight:700\", ...args);\r\n+  const warn = (...args) => console.warn(\"%c[menu.js]\", \"color: #ff9f0a; font-weight:700\", ...args);\r\n+  const err = (...args) => console.error(\"%c[menu.js]\", \"color: #ff3b30; font-weight:700\", ...args);\r\n \r\n-  log(\"iniciando menu.js...\");\r\n+  log(\"iniciando...\");\r\n \r\n-  // Elementos del DOM\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n-  const toggleCategorias = document.getElementById(\"toggle-categorias\"); // el \"Categorías\"\r\n-  const menuCategorias = document.getElementById(\"menu-categorias\"); // UL donde se inyecta\r\n-  const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n+  const promoBar = document.querySelector(\".promo-bar\");\r\n+  const topBar = document.querySelector(\".top-bar\");\r\n+  const header = document.querySelector(\".main-header\");\r\n+  const body = document.body;\r\n+  const menuCategorias = document.getElementById(\"menu-categorias\");\r\n+  const contenedorProductos = document.getElementById(\"contenedor-productos\"); // donde mostramos productos\r\n \r\n   if (!menuCategorias) {\r\n     err(\"No se encontró #menu-categorias en el DOM. Revisa tu HTML.\");\r\n     return;\r\n@@ -22,90 +24,116 @@\n \r\n   let productosGlobal = [];\r\n   let lastScrollTop = 0;\r\n \r\n-  // helpers visibilidad\r\n-  const isVisible = (el) => window.getComputedStyle(el).display !== \"none\";\r\n-  const show = (el) => { el.style.display = \"block\"; el.classList.add(\"open\"); };\r\n-  const hide = (el) => { el.style.display = \"none\"; el.classList.remove(\"open\"); };\r\n-\r\n+  // =========================\r\n   // abrir / cerrar menú lateral\r\n+  // =========================\r\n   function abrirMenu() {\r\n     if (!nav || !overlayMenu) return;\r\n     nav.classList.add(\"activo\");\r\n     overlayMenu.classList.add(\"activo\");\r\n     menuToggle?.setAttribute(\"aria-expanded\", \"true\");\r\n   }\r\n+\r\n   function cerrarMenuLateral() {\r\n     if (!nav || !overlayMenu) return;\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n     menuToggle?.setAttribute(\"aria-expanded\", \"false\");\r\n \r\n-    // colapsar submenus\r\n+    // Colapsar todos los submenús\r\n     document.querySelectorAll(\"#menu-categorias > li > ul, #menu-categorias .subcategorias\").forEach(ul => {\r\n-      hide(ul);\r\n+      ul.style.display = \"none\";\r\n+      ul.classList.remove(\"open\");\r\n       const parentA = ul.closest(\"li\")?.querySelector(\"a\");\r\n       if (parentA) parentA.setAttribute(\"aria-expanded\", \"false\");\r\n     });\r\n     log(\"Menú cerrado y submenús colapsados\");\r\n   }\r\n \r\n-  // eventos globales de apertura/cierre\r\n   menuToggle?.addEventListener(\"click\", () => {\r\n     if (nav?.classList.contains(\"activo\")) cerrarMenuLateral();\r\n     else abrirMenu();\r\n   });\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n-  document.addEventListener(\"keydown\", (e) => { if (e.key === \"Escape\") cerrarMenuLateral(); });\r\n+  document.addEventListener(\"keydown\", (e) => {\r\n+    if (e.key === \"Escape\") cerrarMenuLateral();\r\n+  });\r\n   document.addEventListener(\"click\", (e) => {\r\n+    // cerrar si clic fuera del nav y el menu está abierto\r\n     if (nav?.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle?.contains(e.target)) {\r\n       cerrarMenuLateral();\r\n     }\r\n   });\r\n \r\n-  // Toggle del bloque principal \"Categorías\"\r\n-  if (toggleCategorias) {\r\n-    toggleCategorias.addEventListener(\"click\", (e) => {\r\n-      e.preventDefault();\r\n-      // si el lateral está cerrado, ábrelo primero\r\n-      if (!nav.classList.contains(\"activo\")) abrirMenu();\r\n-      // toggle de la lista principal\r\n-      if (isVisible(menuCategorias)) hide(menuCategorias);\r\n-      else show(menuCategorias);\r\n-      toggleCategorias.setAttribute(\"aria-expanded\", isVisible(menuCategorias).toString());\r\n-      log(\"toggle-categorias:\", isVisible(menuCategorias));\r\n-    });\r\n-  } else {\r\n-    warn(\"No encontrado #toggle-categorias. El enlace 'Categorías' puede no funcionar.\");\r\n-  }\r\n+  // =========================\r\n+  // comportamiento scroll header (tuya)\r\n+  // =========================\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+      promoBar?.classList.add(\"hidden\");\r\n+      topBar?.classList.add(\"hidden\");\r\n+      if (header) header.style.top = \"0\";\r\n+      if (body) body.style.paddingTop = \"0\";\r\n+    } else {\r\n+      promoBar?.classList.remove(\"hidden\");\r\n+      topBar?.classList.remove(\"hidden\");\r\n+      if (header) header.style.top = \"72px\";\r\n+      if (body) body.style.paddingTop = \"180px\";\r\n+    }\r\n+    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+  });\r\n \r\n-  // Exponer toggleSubcategorias para compatibilidad con onclick inline\r\n+  // =========================\r\n+  // funciones globales (para onclick inline si las usas)\r\n+  // =========================\r\n   window.toggleSubcategorias = function (event, categoriaLi) {\r\n-    try { event?.preventDefault(); } catch(e) {}\r\n+    if (event && typeof event.preventDefault === \"function\") event.preventDefault();\r\n     if (!categoriaLi) {\r\n-      // fallback toggle del contenedor principal\r\n-      if (isVisible(menuCategorias)) hide(menuCategorias); else show(menuCategorias);\r\n+      // fallback: togglear el bloque principal\r\n+      const top = document.getElementById(\"menu-categorias\");\r\n+      if (!top) return;\r\n+      const isOpen = top.style.display === \"block\" || top.classList.contains(\"open\");\r\n+      top.style.display = isOpen ? \"none\" : \"block\";\r\n+      top.classList.toggle(\"open\", !isOpen);\r\n       return;\r\n     }\r\n-    const sub = categoriaLi.querySelector(\"ul\");\r\n-    if (!sub) return;\r\n-    // cerrar otras\r\n+    const subMenu = categoriaLi.querySelector(\"ul\");\r\n+    if (!subMenu) {\r\n+      // no hay submenú, podríamos cargar productos por categoría si quieres\r\n+      return;\r\n+    }\r\n+    // cerrar los otros submenus\r\n     document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-      if (ul !== sub) hide(ul);\r\n+      if (ul !== subMenu) {\r\n+        ul.style.display = \"none\";\r\n+        ul.classList.remove(\"open\");\r\n+        const pA = ul.closest(\"li\")?.querySelector(\"a\");\r\n+        if (pA) pA.setAttribute(\"aria-expanded\", \"false\");\r\n+      }\r\n     });\r\n-    if (isVisible(sub)) hide(sub); else show(sub);\r\n+    const open = subMenu.style.display === \"block\" || subMenu.classList.contains(\"open\");\r\n+    subMenu.style.display = open ? \"none\" : \"block\";\r\n+    subMenu.classList.toggle(\"open\", !open);\r\n     const parentA = categoriaLi.querySelector(\"a\");\r\n-    if (parentA) parentA.setAttribute(\"aria-expanded\", isVisible(sub).toString());\r\n+    if (parentA) parentA.setAttribute(\"aria-expanded\", (!open).toString());\r\n   };\r\n \r\n-  // Mostrar productos (wrapper): usa render-catalogo si define window.__mostrarProductosPorSubcategoria\r\n-  function fallbackMostrarProductosPorSubcategoria(idSubcategoria) {\r\n-    if (!contenedorProductos) { warn(\"contenedor-productos no existe\"); return; }\r\n+  // Wrapper que usa el render-catalogo si existe o fallback\r\n+  function fallbackMostrarProductosPorSubcategoria(id) {\r\n+    if (!contenedorProductos) {\r\n+      warn(\"contenedor-productos no encontrado en DOM; no puedo mostrar productos\");\r\n+      return;\r\n+    }\r\n     contenedorProductos.innerHTML = \"\";\r\n-    const filtrados = productosGlobal.filter(p => p.subcategoria === idSubcategoria);\r\n-    if (!filtrados.length) { contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\"; return; }\r\n+    const filtrados = productosGlobal.filter(p => p.subcategoria === id);\r\n+    if (!filtrados.length) {\r\n+      contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+      return;\r\n+    }\r\n     filtrados.forEach(prod => {\r\n       const card = document.createElement(\"div\");\r\n       card.className = \"producto-card\";\r\n       card.innerHTML = `\r\n@@ -117,98 +145,105 @@\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n   }\r\n-  window.mostrarProductosPorSubcategoria = function (idSub) {\r\n+  // Exponer la función que usan otras partes\r\n+  window.mostrarProductosPorSubcategoria = function (id) {\r\n+    // Si tienes otra función preferida (render-catalogo), la puedes exponer en window.__mostrarProductosPorSubcategoria\r\n     if (typeof window.__mostrarProductosPorSubcategoria === \"function\") {\r\n-      window.__mostrarProductosPorSubcategoria(idSub);\r\n+      window.__mostrarProductosPorSubcategoria(id);\r\n     } else {\r\n-      fallbackMostrarProductosPorSubcategoria(idSub);\r\n+      fallbackMostrarProductosPorSubcategoria(id);\r\n     }\r\n   };\r\n \r\n-  // fetch y construcción del menú\r\n-  (function cargarYCargarMenu() {\r\n-    log(\"fetch productos.json...\");\r\n+  // =========================\r\n+  // cargar categorias desde JSON\r\n+  // =========================\r\n+  (function cargarCategorias() {\r\n+    log(\"intentando fetch productos.json...\");\r\n     fetch(\"productos.json\")\r\n-      .then(r => {\r\n-        if (!r.ok) throw new Error(`HTTP ${r.status}`);\r\n-        return r.json();\r\n+      .then(resp => {\r\n+        if (!resp.ok) throw new Error(`HTTP ${resp.status} ${resp.statusText}`);\r\n+        return resp.json();\r\n       })\r\n       .then(data => {\r\n         if (!data || !Array.isArray(data.categorias)) throw new Error(\"data.categorias no es un array\");\r\n-        productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n-        construirMenu(data.categorias);\r\n-        log(\"Menú creado con\", data.categorias.length, \"categorías\");\r\n+        productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n+        buildMenuFromData(data.categorias);\r\n+        log(\"Menú construido con\", data.categorias.length, \"categorías\");\r\n       })\r\n       .catch(e => {\r\n-        warn(\"fetch productos.json falló:\", e.message, \"Intentando ./productos.json\");\r\n-        // intento fallback\r\n+        warn(\"fetch('productos.json') falló:\", e.message);\r\n+        // intento fallback con ruta relativa alternativa\r\n         fetch(\"./productos.json\")\r\n-          .then(r2 => { if (!r2.ok) throw new Error(`HTTP ${r2.status}`); return r2.json(); })\r\n+          .then(r => {\r\n+            if (!r.ok) throw new Error(`HTTP ${r.status}`);\r\n+            return r.json();\r\n+          })\r\n           .then(d2 => {\r\n-            productosGlobal = [...(d2.productos||[]), ...(d2.ofertas||[])];\r\n-            construirMenu(d2.categorias || []);\r\n-            log(\"Menú creado desde ./productos.json (fallback)\");\r\n+            productosGlobal = [...(d2.productos || []), ...(d2.ofertas || [])];\r\n+            buildMenuFromData(d2.categorias || []);\r\n+            log(\"Menú construido desde ./productos.json fallback\");\r\n           })\r\n           .catch(e2 => {\r\n-            err(\"No se pudo cargar productos.json:\", e2.message);\r\n+            err(\"No se pudo cargar productos.json. Revisa ruta y servidor. Error:\", e2.message);\r\n             menuCategorias.innerHTML = \"<li style='color:#c00'>Error cargando categorías</li>\";\r\n           });\r\n       });\r\n   })();\r\n \r\n-  function construirMenu(categorias) {\r\n+  // =========================\r\n+  // construir DOM del menú\r\n+  // =========================\r\n+  function buildMenuFromData(categorias) {\r\n     menuCategorias.innerHTML = \"\";\r\n-    categorias.forEach(cat => {\r\n+    categorias.forEach(categoria => {\r\n       const li = document.createElement(\"li\");\r\n       li.className = \"categoria-item\";\r\n-      li.dataset.catId = cat.id;\r\n+      li.dataset.catId = categoria.id;\r\n \r\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\";\r\n-      a.textContent = cat.nombre;\r\n+      a.textContent = categoria.nombre;\r\n       a.setAttribute(\"role\", \"button\");\r\n       a.setAttribute(\"aria-expanded\", \"false\");\r\n+      // al hacer click en la categoría: si tiene subcategorías -> toggle; si no -> podrías mostrar productos por categoría\r\n       a.addEventListener(\"click\", (e) => {\r\n         e.preventDefault();\r\n-        // si nav no está activo, abrirlo\r\n-        if (!nav.classList.contains(\"activo\")) abrirMenu();\r\n-        // si la lista principal está oculta, mostrarla (caso cuando se abre desde icono fuera)\r\n-        if (!isVisible(menuCategorias)) show(menuCategorias);\r\n-        // si tiene submenus togglearlo\r\n         const sub = li.querySelector(\"ul\");\r\n         if (sub) {\r\n-          // cerrar otras subcategorias\r\n-          document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => { if (ul !== sub) hide(ul); });\r\n-          if (isVisible(sub)) hide(sub); else show(sub);\r\n-          a.setAttribute(\"aria-expanded\", isVisible(sub).toString());\r\n+          // usa la global para compatibilidad\r\n+          window.toggleSubcategorias(e, li);\r\n         } else {\r\n-          // sin subcategorías: podrías mostrar productos por categoría\r\n+          // si no hay sub, (opcional) mostrar por categoría y cerrar el menú\r\n+          // implementar si lo deseas: mostrarProductosPorCategoria(categoria.id)\r\n           cerrarMenuLateral();\r\n         }\r\n       });\r\n \r\n       li.appendChild(a);\r\n \r\n-      // Subcategorías\r\n-      if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n+      if (Array.isArray(categoria.subcategorias) && categoria.subcategorias.length) {\r\n         const ulSub = document.createElement(\"ul\");\r\n         ulSub.className = \"subcategorias\";\r\n         ulSub.style.display = \"none\";\r\n \r\n-        cat.subcategorias.forEach(sub => {\r\n+        categoria.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           liSub.dataset.subId = sub.id;\r\n+\r\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\";\r\n           aSub.textContent = sub.nombre;\r\n           aSub.addEventListener(\"click\", (ev) => {\r\n             ev.preventDefault();\r\n+            // preferimos wrapper global (es la función expuesta arriba)\r\n             window.mostrarProductosPorSubcategoria(sub.id);\r\n             cerrarMenuLateral();\r\n             contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n+\r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n@@ -218,23 +253,6 @@\n       menuCategorias.appendChild(li);\r\n     });\r\n   }\r\n \r\n-  // comportamiento scroll header (si lo quieres mantener)\r\n-  window.addEventListener(\"scroll\", () => {\r\n-    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n-    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-      document.querySelector(\".promo-bar\")?.classList.add(\"hidden\");\r\n-      document.querySelector(\".top-bar\")?.classList.add(\"hidden\");\r\n-      if (header) header.style.top = \"0\";\r\n-      if (body) body.style.paddingTop = \"0\";\r\n-    } else {\r\n-      document.querySelector(\".promo-bar\")?.classList.remove(\"hidden\");\r\n-      document.querySelector(\".top-bar\")?.classList.remove(\"hidden\");\r\n-      if (header) header.style.top = \"72px\";\r\n-      if (body) body.style.paddingTop = \"180px\";\r\n-    }\r\n-    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n-  });\r\n-\r\n-  log(\"menu.js listo.\");\r\n+  // fin DOMContentLoaded\r\n });\r\n"
                },
                {
                    "date": 1759157374081,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,18 +28,16 @@\n   // =========================\r\n   // abrir / cerrar menú lateral\r\n   // =========================\r\n   function abrirMenu() {\r\n-    if (!nav || !overlayMenu) return;\r\n-    nav.classList.add(\"activo\");\r\n-    overlayMenu.classList.add(\"activo\");\r\n+    nav?.classList.add(\"activo\");\r\n+    overlayMenu?.classList.add(\"activo\");\r\n     menuToggle?.setAttribute(\"aria-expanded\", \"true\");\r\n   }\r\n \r\n   function cerrarMenuLateral() {\r\n-    if (!nav || !overlayMenu) return;\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n+    nav?.classList.remove(\"activo\");\r\n+    overlayMenu?.classList.remove(\"activo\");\r\n     menuToggle?.setAttribute(\"aria-expanded\", \"false\");\r\n \r\n     // Colapsar todos los submenús\r\n     document.querySelectorAll(\"#menu-categorias > li > ul, #menu-categorias .subcategorias\").forEach(ul => {\r\n@@ -51,25 +49,21 @@\n     log(\"Menú cerrado y submenús colapsados\");\r\n   }\r\n \r\n   menuToggle?.addEventListener(\"click\", () => {\r\n-    if (nav?.classList.contains(\"activo\")) cerrarMenuLateral();\r\n-    else abrirMenu();\r\n+    nav?.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu();\r\n   });\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n-  document.addEventListener(\"keydown\", (e) => {\r\n-    if (e.key === \"Escape\") cerrarMenuLateral();\r\n-  });\r\n+  document.addEventListener(\"keydown\", (e) => { if (e.key === \"Escape\") cerrarMenuLateral(); });\r\n   document.addEventListener(\"click\", (e) => {\r\n-    // cerrar si clic fuera del nav y el menu está abierto\r\n     if (nav?.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle?.contains(e.target)) {\r\n       cerrarMenuLateral();\r\n     }\r\n   });\r\n \r\n   // =========================\r\n-  // comportamiento scroll header (tuya)\r\n+  // comportamiento scroll header\r\n   // =========================\r\n   window.addEventListener(\"scroll\", () => {\r\n     let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n     if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n@@ -86,27 +80,22 @@\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n \r\n   // =========================\r\n-  // funciones globales (para onclick inline si las usas)\r\n+  // funciones globales\r\n   // =========================\r\n   window.toggleSubcategorias = function (event, categoriaLi) {\r\n-    if (event && typeof event.preventDefault === \"function\") event.preventDefault();\r\n+    if (event?.preventDefault) event.preventDefault();\r\n     if (!categoriaLi) {\r\n-      // fallback: togglear el bloque principal\r\n       const top = document.getElementById(\"menu-categorias\");\r\n       if (!top) return;\r\n       const isOpen = top.style.display === \"block\" || top.classList.contains(\"open\");\r\n       top.style.display = isOpen ? \"none\" : \"block\";\r\n       top.classList.toggle(\"open\", !isOpen);\r\n       return;\r\n     }\r\n     const subMenu = categoriaLi.querySelector(\"ul\");\r\n-    if (!subMenu) {\r\n-      // no hay submenú, podríamos cargar productos por categoría si quieres\r\n-      return;\r\n-    }\r\n-    // cerrar los otros submenus\r\n+    if (!subMenu) return;\r\n     document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n       if (ul !== subMenu) {\r\n         ul.style.display = \"none\";\r\n         ul.classList.remove(\"open\");\r\n@@ -120,12 +109,14 @@\n     const parentA = categoriaLi.querySelector(\"a\");\r\n     if (parentA) parentA.setAttribute(\"aria-expanded\", (!open).toString());\r\n   };\r\n \r\n-  // Wrapper que usa el render-catalogo si existe o fallback\r\n+  // =========================\r\n+  // mostrar productos con mensaje si no hay\r\n+  // =========================\r\n   function fallbackMostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) {\r\n-      warn(\"contenedor-productos no encontrado en DOM; no puedo mostrar productos\");\r\n+      warn(\"contenedor-productos no encontrado en DOM\");\r\n       return;\r\n     }\r\n     contenedorProductos.innerHTML = \"\";\r\n     const filtrados = productosGlobal.filter(p => p.subcategoria === id);\r\n@@ -145,11 +136,9 @@\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n   }\r\n-  // Exponer la función que usan otras partes\r\n-  window.mostrarProductosPorSubcategoria = function (id) {\r\n-    // Si tienes otra función preferida (render-catalogo), la puedes exponer en window.__mostrarProductosPorSubcategoria\r\n+  window.mostrarProductosPorSubcategoria = function(id) {\r\n     if (typeof window.__mostrarProductosPorSubcategoria === \"function\") {\r\n       window.__mostrarProductosPorSubcategoria(id);\r\n     } else {\r\n       fallbackMostrarProductosPorSubcategoria(id);\r\n@@ -159,100 +148,71 @@\n   // =========================\r\n   // cargar categorias desde JSON\r\n   // =========================\r\n   (function cargarCategorias() {\r\n-    log(\"intentando fetch productos.json...\");\r\n     fetch(\"productos.json\")\r\n-      .then(resp => {\r\n-        if (!resp.ok) throw new Error(`HTTP ${resp.status} ${resp.statusText}`);\r\n-        return resp.json();\r\n-      })\r\n+      .then(resp => resp.json())\r\n       .then(data => {\r\n-        if (!data || !Array.isArray(data.categorias)) throw new Error(\"data.categorias no es un array\");\r\n         productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n-        buildMenuFromData(data.categorias);\r\n+        buildMenuFromData(data.categorias || []);\r\n         log(\"Menú construido con\", data.categorias.length, \"categorías\");\r\n       })\r\n       .catch(e => {\r\n-        warn(\"fetch('productos.json') falló:\", e.message);\r\n-        // intento fallback con ruta relativa alternativa\r\n-        fetch(\"./productos.json\")\r\n-          .then(r => {\r\n-            if (!r.ok) throw new Error(`HTTP ${r.status}`);\r\n-            return r.json();\r\n-          })\r\n-          .then(d2 => {\r\n-            productosGlobal = [...(d2.productos || []), ...(d2.ofertas || [])];\r\n-            buildMenuFromData(d2.categorias || []);\r\n-            log(\"Menú construido desde ./productos.json fallback\");\r\n-          })\r\n-          .catch(e2 => {\r\n-            err(\"No se pudo cargar productos.json. Revisa ruta y servidor. Error:\", e2.message);\r\n-            menuCategorias.innerHTML = \"<li style='color:#c00'>Error cargando categorías</li>\";\r\n-          });\r\n+        err(\"No se pudo cargar productos.json\", e.message);\r\n+        menuCategorias.innerHTML = \"<li style='color:#c00'>Error cargando categorías</li>\";\r\n       });\r\n   })();\r\n \r\n   // =========================\r\n-  // construir DOM del menú\r\n+  // construir DOM del menú con subcategorías\r\n   // =========================\r\n   function buildMenuFromData(categorias) {\r\n     menuCategorias.innerHTML = \"\";\r\n-    categorias.forEach(categoria => {\r\n+\r\n+    categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       li.className = \"categoria-item\";\r\n-      li.dataset.catId = categoria.id;\r\n \r\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\";\r\n-      a.textContent = categoria.nombre;\r\n+      a.textContent = cat.nombre;\r\n       a.setAttribute(\"role\", \"button\");\r\n       a.setAttribute(\"aria-expanded\", \"false\");\r\n-      // al hacer click en la categoría: si tiene subcategorías -> toggle; si no -> podrías mostrar productos por categoría\r\n-      a.addEventListener(\"click\", (e) => {\r\n-        e.preventDefault();\r\n-        const sub = li.querySelector(\"ul\");\r\n-        if (sub) {\r\n-          // usa la global para compatibilidad\r\n-          window.toggleSubcategorias(e, li);\r\n-        } else {\r\n-          // si no hay sub, (opcional) mostrar por categoría y cerrar el menú\r\n-          // implementar si lo deseas: mostrarProductosPorCategoria(categoria.id)\r\n-          cerrarMenuLateral();\r\n-        }\r\n-      });\r\n \r\n-      li.appendChild(a);\r\n-\r\n-      if (Array.isArray(categoria.subcategorias) && categoria.subcategorias.length) {\r\n+      if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n         const ulSub = document.createElement(\"ul\");\r\n         ulSub.className = \"subcategorias\";\r\n         ulSub.style.display = \"none\";\r\n \r\n-        categoria.subcategorias.forEach(sub => {\r\n+        cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n-          liSub.dataset.subId = sub.id;\r\n-\r\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\";\r\n           aSub.textContent = sub.nombre;\r\n-          aSub.addEventListener(\"click\", (ev) => {\r\n-            ev.preventDefault();\r\n-            // preferimos wrapper global (es la función expuesta arriba)\r\n+          aSub.addEventListener(\"click\", e => {\r\n+            e.preventDefault();\r\n             window.mostrarProductosPorSubcategoria(sub.id);\r\n             cerrarMenuLateral();\r\n             contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n-\r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n+        a.addEventListener(\"click\", e => {\r\n+          e.preventDefault();\r\n+          const abierto = ulSub.style.display === \"block\";\r\n+          document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(u => u.style.display = \"none\");\r\n+          ulSub.style.display = abierto ? \"none\" : \"block\";\r\n+        });\r\n+\r\n+        li.appendChild(a);\r\n         li.appendChild(ulSub);\r\n+      } else {\r\n+        a.addEventListener(\"click\", e => e.preventDefault());\r\n+        li.appendChild(a);\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n     });\r\n   }\r\n-\r\n-  // fin DOMContentLoaded\r\n });\r\n"
                },
                {
                    "date": 1759157809674,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,9 +14,9 @@\n   const topBar = document.querySelector(\".top-bar\");\r\n   const header = document.querySelector(\".main-header\");\r\n   const body = document.body;\r\n   const menuCategorias = document.getElementById(\"menu-categorias\");\r\n-  const contenedorProductos = document.getElementById(\"contenedor-productos\"); // donde mostramos productos\r\n+  const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n   if (!menuCategorias) {\r\n     err(\"No se encontró #menu-categorias en el DOM. Revisa tu HTML.\");\r\n     return;\r\n@@ -28,20 +28,22 @@\n   // =========================\r\n   // abrir / cerrar menú lateral\r\n   // =========================\r\n   function abrirMenu() {\r\n-    nav?.classList.add(\"activo\");\r\n-    overlayMenu?.classList.add(\"activo\");\r\n+    if (!nav || !overlayMenu) return;\r\n+    nav.classList.add(\"activo\");\r\n+    overlayMenu.classList.add(\"activo\");\r\n     menuToggle?.setAttribute(\"aria-expanded\", \"true\");\r\n   }\r\n \r\n   function cerrarMenuLateral() {\r\n-    nav?.classList.remove(\"activo\");\r\n-    overlayMenu?.classList.remove(\"activo\");\r\n+    if (!nav || !overlayMenu) return;\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n     menuToggle?.setAttribute(\"aria-expanded\", \"false\");\r\n \r\n     // Colapsar todos los submenús\r\n-    document.querySelectorAll(\"#menu-categorias > li > ul, #menu-categorias .subcategorias\").forEach(ul => {\r\n+    document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(ul => {\r\n       ul.style.display = \"none\";\r\n       ul.classList.remove(\"open\");\r\n       const parentA = ul.closest(\"li\")?.querySelector(\"a\");\r\n       if (parentA) parentA.setAttribute(\"aria-expanded\", \"false\");\r\n@@ -49,13 +51,16 @@\n     log(\"Menú cerrado y submenús colapsados\");\r\n   }\r\n \r\n   menuToggle?.addEventListener(\"click\", () => {\r\n-    nav?.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu();\r\n+    if (nav?.classList.contains(\"activo\")) cerrarMenuLateral();\r\n+    else abrirMenu();\r\n   });\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n-  document.addEventListener(\"keydown\", (e) => { if (e.key === \"Escape\") cerrarMenuLateral(); });\r\n+  document.addEventListener(\"keydown\", (e) => {\r\n+    if (e.key === \"Escape\") cerrarMenuLateral();\r\n+  });\r\n   document.addEventListener(\"click\", (e) => {\r\n     if (nav?.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle?.contains(e.target)) {\r\n       cerrarMenuLateral();\r\n     }\r\n@@ -80,45 +85,12 @@\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n \r\n   // =========================\r\n-  // funciones globales\r\n+  // mostrar productos por subcategoría\r\n   // =========================\r\n-  window.toggleSubcategorias = function (event, categoriaLi) {\r\n-    if (event?.preventDefault) event.preventDefault();\r\n-    if (!categoriaLi) {\r\n-      const top = document.getElementById(\"menu-categorias\");\r\n-      if (!top) return;\r\n-      const isOpen = top.style.display === \"block\" || top.classList.contains(\"open\");\r\n-      top.style.display = isOpen ? \"none\" : \"block\";\r\n-      top.classList.toggle(\"open\", !isOpen);\r\n-      return;\r\n-    }\r\n-    const subMenu = categoriaLi.querySelector(\"ul\");\r\n-    if (!subMenu) return;\r\n-    document.querySelectorAll(\"#menu-categorias > li > ul\").forEach(ul => {\r\n-      if (ul !== subMenu) {\r\n-        ul.style.display = \"none\";\r\n-        ul.classList.remove(\"open\");\r\n-        const pA = ul.closest(\"li\")?.querySelector(\"a\");\r\n-        if (pA) pA.setAttribute(\"aria-expanded\", \"false\");\r\n-      }\r\n-    });\r\n-    const open = subMenu.style.display === \"block\" || subMenu.classList.contains(\"open\");\r\n-    subMenu.style.display = open ? \"none\" : \"block\";\r\n-    subMenu.classList.toggle(\"open\", !open);\r\n-    const parentA = categoriaLi.querySelector(\"a\");\r\n-    if (parentA) parentA.setAttribute(\"aria-expanded\", (!open).toString());\r\n-  };\r\n-\r\n-  // =========================\r\n-  // mostrar productos con mensaje si no hay\r\n-  // =========================\r\n   function fallbackMostrarProductosPorSubcategoria(id) {\r\n-    if (!contenedorProductos) {\r\n-      warn(\"contenedor-productos no encontrado en DOM\");\r\n-      return;\r\n-    }\r\n+    if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n     const filtrados = productosGlobal.filter(p => p.subcategoria === id);\r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n@@ -136,8 +108,9 @@\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n   }\r\n+\r\n   window.mostrarProductosPorSubcategoria = function(id) {\r\n     if (typeof window.__mostrarProductosPorSubcategoria === \"function\") {\r\n       window.__mostrarProductosPorSubcategoria(id);\r\n     } else {\r\n@@ -145,30 +118,24 @@\n     }\r\n   };\r\n \r\n   // =========================\r\n-  // cargar categorias desde JSON\r\n+  // toggle subcategorías\r\n   // =========================\r\n-  (function cargarCategorias() {\r\n-    fetch(\"productos.json\")\r\n-      .then(resp => resp.json())\r\n-      .then(data => {\r\n-        productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n-        buildMenuFromData(data.categorias || []);\r\n-        log(\"Menú construido con\", data.categorias.length, \"categorías\");\r\n-      })\r\n-      .catch(e => {\r\n-        err(\"No se pudo cargar productos.json\", e.message);\r\n-        menuCategorias.innerHTML = \"<li style='color:#c00'>Error cargando categorías</li>\";\r\n-      });\r\n-  })();\r\n+  window.toggleSubcategorias = function(event, liCategoria) {\r\n+    if (event) event.preventDefault();\r\n+    const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n+    if (!subMenu) return;\r\n+    const abierto = subMenu.style.display === \"block\";\r\n+    document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(u => u.style.display = \"none\");\r\n+    subMenu.style.display = abierto ? \"none\" : \"block\";\r\n+  };\r\n \r\n   // =========================\r\n-  // construir DOM del menú con subcategorías\r\n+  // construir menú desde JSON\r\n   // =========================\r\n   function buildMenuFromData(categorias) {\r\n     menuCategorias.innerHTML = \"\";\r\n-\r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       li.className = \"categoria-item\";\r\n \r\n@@ -190,21 +157,16 @@\n           aSub.textContent = sub.nombre;\r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             window.mostrarProductosPorSubcategoria(sub.id);\r\n-            cerrarMenuLateral();\r\n+            ulSub.style.display = \"none\";\r\n             contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n-        a.addEventListener(\"click\", e => {\r\n-          e.preventDefault();\r\n-          const abierto = ulSub.style.display === \"block\";\r\n-          document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(u => u.style.display = \"none\");\r\n-          ulSub.style.display = abierto ? \"none\" : \"block\";\r\n-        });\r\n+        a.addEventListener(\"click\", e => window.toggleSubcategorias(e, li));\r\n \r\n         li.appendChild(a);\r\n         li.appendChild(ulSub);\r\n       } else {\r\n@@ -214,5 +176,17 @@\n \r\n       menuCategorias.appendChild(li);\r\n     });\r\n   }\r\n+\r\n+  // =========================\r\n+  // cargar JSON\r\n+  // =========================\r\n+  fetch(\"productos.json\")\r\n+    .then(resp => resp.json())\r\n+    .then(data => {\r\n+      productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n+      buildMenuFromData(data.categorias || []);\r\n+      log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n+    })\r\n+    .catch(e => err(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759157979326,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,4 @@\n-// js/menu.js\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n   const log = (...args) => console.log(\"%c[menu.js]\", \"color: #0a84ff; font-weight:700\", ...args);\r\n   const warn = (...args) => console.warn(\"%c[menu.js]\", \"color: #ff9f0a; font-weight:700\", ...args);\r\n   const err = (...args) => console.error(\"%c[menu.js]\", \"color: #ff3b30; font-weight:700\", ...args);\r\n@@ -28,26 +27,19 @@\n   // =========================\r\n   // abrir / cerrar menú lateral\r\n   // =========================\r\n   function abrirMenu() {\r\n-    if (!nav || !overlayMenu) return;\r\n-    nav.classList.add(\"activo\");\r\n-    overlayMenu.classList.add(\"activo\");\r\n+    nav?.classList.add(\"activo\");\r\n+    overlayMenu?.classList.add(\"activo\");\r\n     menuToggle?.setAttribute(\"aria-expanded\", \"true\");\r\n   }\r\n \r\n   function cerrarMenuLateral() {\r\n-    if (!nav || !overlayMenu) return;\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n+    nav?.classList.remove(\"activo\");\r\n+    overlayMenu?.classList.remove(\"activo\");\r\n     menuToggle?.setAttribute(\"aria-expanded\", \"false\");\r\n-\r\n-    // Colapsar todos los submenús\r\n     document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(ul => {\r\n       ul.style.display = \"none\";\r\n-      ul.classList.remove(\"open\");\r\n-      const parentA = ul.closest(\"li\")?.querySelector(\"a\");\r\n-      if (parentA) parentA.setAttribute(\"aria-expanded\", \"false\");\r\n     });\r\n     log(\"Menú cerrado y submenús colapsados\");\r\n   }\r\n \r\n@@ -87,9 +79,9 @@\n \r\n   // =========================\r\n   // mostrar productos por subcategoría\r\n   // =========================\r\n-  function fallbackMostrarProductosPorSubcategoria(id) {\r\n+  function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n     const filtrados = productosGlobal.filter(p => p.subcategoria === id);\r\n     if (!filtrados.length) {\r\n@@ -108,28 +100,20 @@\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n   }\r\n+  window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  window.mostrarProductosPorSubcategoria = function(id) {\r\n-    if (typeof window.__mostrarProductosPorSubcategoria === \"function\") {\r\n-      window.__mostrarProductosPorSubcategoria(id);\r\n-    } else {\r\n-      fallbackMostrarProductosPorSubcategoria(id);\r\n-    }\r\n-  };\r\n-\r\n   // =========================\r\n   // toggle subcategorías\r\n   // =========================\r\n-  window.toggleSubcategorias = function(event, liCategoria) {\r\n-    if (event) event.preventDefault();\r\n+  function toggleSubcategorias(liCategoria) {\r\n     const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n     if (!subMenu) return;\r\n     const abierto = subMenu.style.display === \"block\";\r\n     document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(u => u.style.display = \"none\");\r\n     subMenu.style.display = abierto ? \"none\" : \"block\";\r\n-  };\r\n+  }\r\n \r\n   // =========================\r\n   // construir menú desde JSON\r\n   // =========================\r\n@@ -142,10 +126,11 @@\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\";\r\n       a.textContent = cat.nombre;\r\n       a.setAttribute(\"role\", \"button\");\r\n-      a.setAttribute(\"aria-expanded\", \"false\");\r\n \r\n+      li.appendChild(a);\r\n+\r\n       if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n         const ulSub = document.createElement(\"ul\");\r\n         ulSub.className = \"subcategorias\";\r\n         ulSub.style.display = \"none\";\r\n@@ -156,23 +141,24 @@\n           aSub.href = \"#\";\r\n           aSub.textContent = sub.nombre;\r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n-            window.mostrarProductosPorSubcategoria(sub.id);\r\n-            ulSub.style.display = \"none\";\r\n+            mostrarProductosPorSubcategoria(sub.id);\r\n+            cerrarMenuLateral();\r\n             contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n-        a.addEventListener(\"click\", e => window.toggleSubcategorias(e, li));\r\n+        a.addEventListener(\"click\", e => {\r\n+          e.preventDefault();\r\n+          toggleSubcategorias(li);\r\n+        });\r\n \r\n-        li.appendChild(a);\r\n         li.appendChild(ulSub);\r\n       } else {\r\n         a.addEventListener(\"click\", e => e.preventDefault());\r\n-        li.appendChild(a);\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n     });\r\n"
                },
                {
                    "date": 1759158369937,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,8 +13,9 @@\n   const topBar = document.querySelector(\".top-bar\");\r\n   const header = document.querySelector(\".main-header\");\r\n   const body = document.body;\r\n   const menuCategorias = document.getElementById(\"menu-categorias\");\r\n+  const toggleCategorias = document.getElementById(\"toggle-categorias\"); // botón Categorías\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n   if (!menuCategorias) {\r\n     err(\"No se encontró #menu-categorias en el DOM. Revisa tu HTML.\");\r\n@@ -48,20 +49,27 @@\n     else abrirMenu();\r\n   });\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n-  document.addEventListener(\"keydown\", (e) => {\r\n-    if (e.key === \"Escape\") cerrarMenuLateral();\r\n-  });\r\n-  document.addEventListener(\"click\", (e) => {\r\n+  document.addEventListener(\"keydown\", e => { if (e.key === \"Escape\") cerrarMenuLateral(); });\r\n+  document.addEventListener(\"click\", e => {\r\n     if (nav?.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle?.contains(e.target)) {\r\n       cerrarMenuLateral();\r\n     }\r\n   });\r\n \r\n   // =========================\r\n-  // comportamiento scroll header\r\n+  // desplegar categorías principales\r\n   // =========================\r\n+  toggleCategorias?.addEventListener(\"click\", e => {\r\n+    e.preventDefault();\r\n+    const abierto = menuCategorias.style.display === \"block\";\r\n+    menuCategorias.style.display = abierto ? \"none\" : \"block\";\r\n+  });\r\n+\r\n+  // =========================\r\n+  // scroll header\r\n+  // =========================\r\n   window.addEventListener(\"scroll\", () => {\r\n     let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n     if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n       promoBar?.classList.add(\"hidden\");\r\n@@ -126,11 +134,10 @@\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\";\r\n       a.textContent = cat.nombre;\r\n       a.setAttribute(\"role\", \"button\");\r\n+      a.setAttribute(\"aria-expanded\", \"false\");\r\n \r\n-      li.appendChild(a);\r\n-\r\n       if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n         const ulSub = document.createElement(\"ul\");\r\n         ulSub.className = \"subcategorias\";\r\n         ulSub.style.display = \"none\";\r\n@@ -142,9 +149,9 @@\n           aSub.textContent = sub.nombre;\r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n-            cerrarMenuLateral();\r\n+            ulSub.style.display = \"none\";\r\n             contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n@@ -154,19 +161,21 @@\n           e.preventDefault();\r\n           toggleSubcategorias(li);\r\n         });\r\n \r\n+        li.appendChild(a);\r\n         li.appendChild(ulSub);\r\n       } else {\r\n         a.addEventListener(\"click\", e => e.preventDefault());\r\n+        li.appendChild(a);\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n     });\r\n   }\r\n \r\n   // =========================\r\n-  // cargar JSON\r\n+  // cargar JSON de productos\r\n   // =========================\r\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n"
                },
                {
                    "date": 1759159038466,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -111,77 +111,88 @@\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n   // =========================\r\n-  // toggle subcategorías\r\n-  // =========================\r\n-  function toggleSubcategorias(liCategoria) {\r\n-    const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n-    if (!subMenu) return;\r\n-    const abierto = subMenu.style.display === \"block\";\r\n-    document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(u => u.style.display = \"none\");\r\n-    subMenu.style.display = abierto ? \"none\" : \"block\";\r\n-  }\r\n+// toggle subcategorías\r\n+// =========================\r\n+function toggleSubcategorias(liCategoria) {\r\n+  const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n+  if (!subMenu) return;\r\n \r\n-  // =========================\r\n-  // construir menú desde JSON\r\n-  // =========================\r\n-  function buildMenuFromData(categorias) {\r\n-    menuCategorias.innerHTML = \"\";\r\n-    categorias.forEach(cat => {\r\n-      const li = document.createElement(\"li\");\r\n-      li.className = \"categoria-item\";\r\n+  // Cerramos todos los demás submenús\r\n+  document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(u => {\r\n+    if (u !== subMenu) u.style.display = \"none\";\r\n+  });\r\n \r\n-      const a = document.createElement(\"a\");\r\n-      a.href = \"#\";\r\n-      a.textContent = cat.nombre;\r\n-      a.setAttribute(\"role\", \"button\");\r\n-      a.setAttribute(\"aria-expanded\", \"false\");\r\n+  // Abrimos o cerramos el submenú actual\r\n+  const abierto = subMenu.style.display === \"block\";\r\n+  subMenu.style.display = abierto ? \"none\" : \"block\";\r\n \r\n-      if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n-        const ulSub = document.createElement(\"ul\");\r\n-        ulSub.className = \"subcategorias\";\r\n-        ulSub.style.display = \"none\";\r\n+  // Ajustamos aria-expanded\r\n+  const aPadre = liCategoria.querySelector(\"a\");\r\n+  if (aPadre) aPadre.setAttribute(\"aria-expanded\", (!abierto).toString());\r\n+}\r\n \r\n-        cat.subcategorias.forEach(sub => {\r\n-          const liSub = document.createElement(\"li\");\r\n-          const aSub = document.createElement(\"a\");\r\n-          aSub.href = \"#\";\r\n-          aSub.textContent = sub.nombre;\r\n-          aSub.addEventListener(\"click\", e => {\r\n-            e.preventDefault();\r\n-            mostrarProductosPorSubcategoria(sub.id);\r\n-            ulSub.style.display = \"none\";\r\n-            contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n-          });\r\n-          liSub.appendChild(aSub);\r\n-          ulSub.appendChild(liSub);\r\n-        });\r\n+// =========================\r\n+// construir menú desde JSON\r\n+// =========================\r\n+function buildMenuFromData(categorias) {\r\n+  menuCategorias.innerHTML = \"\";\r\n+  categorias.forEach(cat => {\r\n+    const li = document.createElement(\"li\");\r\n+    li.className = \"categoria-item\";\r\n \r\n-        a.addEventListener(\"click\", e => {\r\n+    const a = document.createElement(\"a\");\r\n+    a.href = \"#\";\r\n+    a.textContent = cat.nombre;\r\n+    a.setAttribute(\"role\", \"button\");\r\n+    a.setAttribute(\"aria-expanded\", \"false\");\r\n+\r\n+    if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n+      const ulSub = document.createElement(\"ul\");\r\n+      ulSub.className = \"subcategorias\";\r\n+      ulSub.style.display = \"none\";\r\n+\r\n+      cat.subcategorias.forEach(sub => {\r\n+        const liSub = document.createElement(\"li\");\r\n+        const aSub = document.createElement(\"a\");\r\n+        aSub.href = \"#\";\r\n+        aSub.textContent = sub.nombre;\r\n+        aSub.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          toggleSubcategorias(li);\r\n+          mostrarProductosPorSubcategoria(sub.id);\r\n+          ulSub.style.display = \"none\";\r\n+          contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n         });\r\n+        liSub.appendChild(aSub);\r\n+        ulSub.appendChild(liSub);\r\n+      });\r\n \r\n-        li.appendChild(a);\r\n-        li.appendChild(ulSub);\r\n-      } else {\r\n-        a.addEventListener(\"click\", e => e.preventDefault());\r\n-        li.appendChild(a);\r\n-      }\r\n+      // Al hacer clic en la categoría padre, togglear subcategorías\r\n+      a.addEventListener(\"click\", e => {\r\n+        e.preventDefault();\r\n+        toggleSubcategorias(li);\r\n+      });\r\n \r\n-      menuCategorias.appendChild(li);\r\n-    });\r\n-  }\r\n+      li.appendChild(a);\r\n+      li.appendChild(ulSub);\r\n+    } else {\r\n+      a.addEventListener(\"click\", e => e.preventDefault());\r\n+      li.appendChild(a);\r\n+    }\r\n \r\n-  // =========================\r\n-  // cargar JSON de productos\r\n-  // =========================\r\n-  fetch(\"productos.json\")\r\n-    .then(resp => resp.json())\r\n-    .then(data => {\r\n-      productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n-      buildMenuFromData(data.categorias || []);\r\n-      log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n-    })\r\n-    .catch(e => err(\"Error cargando productos.json:\", e));\r\n+    menuCategorias.appendChild(li);\r\n+  });\r\n+}\r\n+\r\n+// =========================\r\n+// cargar JSON de productos\r\n+// =========================\r\n+fetch(\"productos.json\")\r\n+  .then(resp => resp.json())\r\n+  .then(data => {\r\n+    productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n+    buildMenuFromData(data.categorias || []);\r\n+    log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n+  })\r\n+  .catch(e => err(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759159398817,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -114,30 +114,29 @@\n   // =========================\r\n // toggle subcategorías\r\n // =========================\r\n function toggleSubcategorias(liCategoria) {\r\n-  const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n-  if (!subMenu) return;\r\n+  if (!liCategoria) return;\r\n \r\n-  // Cerramos todos los demás submenús\r\n-  document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(u => {\r\n-    if (u !== subMenu) u.style.display = \"none\";\r\n+  const isActive = liCategoria.classList.contains(\"active\");\r\n+\r\n+  // Cerrar todos los submenús\r\n+  document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n+    li.classList.remove(\"active\");\r\n   });\r\n \r\n-  // Abrimos o cerramos el submenú actual\r\n-  const abierto = subMenu.style.display === \"block\";\r\n-  subMenu.style.display = abierto ? \"none\" : \"block\";\r\n-\r\n-  // Ajustamos aria-expanded\r\n-  const aPadre = liCategoria.querySelector(\"a\");\r\n-  if (aPadre) aPadre.setAttribute(\"aria-expanded\", (!abierto).toString());\r\n+  // Abrir el que se clickeó si no estaba activo\r\n+  if (!isActive) {\r\n+    liCategoria.classList.add(\"active\");\r\n+  }\r\n }\r\n \r\n // =========================\r\n // construir menú desde JSON\r\n // =========================\r\n function buildMenuFromData(categorias) {\r\n   menuCategorias.innerHTML = \"\";\r\n+\r\n   categorias.forEach(cat => {\r\n     const li = document.createElement(\"li\");\r\n     li.className = \"categoria-item\";\r\n \r\n@@ -149,9 +148,8 @@\n \r\n     if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n       const ulSub = document.createElement(\"ul\");\r\n       ulSub.className = \"subcategorias\";\r\n-      ulSub.style.display = \"none\";\r\n \r\n       cat.subcategorias.forEach(sub => {\r\n         const liSub = document.createElement(\"li\");\r\n         const aSub = document.createElement(\"a\");\r\n@@ -159,25 +157,30 @@\n         aSub.textContent = sub.nombre;\r\n         aSub.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           mostrarProductosPorSubcategoria(sub.id);\r\n-          ulSub.style.display = \"none\";\r\n+          // opcional: cerrar menú lateral si quieres\r\n+          // cerrarMenuLateral();\r\n           contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n         });\r\n         liSub.appendChild(aSub);\r\n         ulSub.appendChild(liSub);\r\n       });\r\n \r\n-      // Al hacer clic en la categoría padre, togglear subcategorías\r\n+      // Al hacer clic en la categoría principal, togglear subcategorías\r\n       a.addEventListener(\"click\", e => {\r\n         e.preventDefault();\r\n         toggleSubcategorias(li);\r\n       });\r\n \r\n       li.appendChild(a);\r\n       li.appendChild(ulSub);\r\n     } else {\r\n-      a.addEventListener(\"click\", e => e.preventDefault());\r\n+      // categoría sin subcategorías\r\n+      a.addEventListener(\"click\", e => {\r\n+        e.preventDefault();\r\n+        mostrarProductosPorSubcategoria(cat.id);\r\n+      });\r\n       li.appendChild(a);\r\n     }\r\n \r\n     menuCategorias.appendChild(li);\r\n@@ -194,5 +197,4 @@\n     buildMenuFromData(data.categorias || []);\r\n     log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n   })\r\n   .catch(e => err(\"Error cargando productos.json:\", e));\r\n-});\r\n"
                },
                {
                    "date": 1759159684274,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -111,90 +111,77 @@\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n   // =========================\r\n-// toggle subcategorías\r\n-// =========================\r\n-function toggleSubcategorias(liCategoria) {\r\n-  if (!liCategoria) return;\r\n-\r\n-  const isActive = liCategoria.classList.contains(\"active\");\r\n-\r\n-  // Cerrar todos los submenús\r\n-  document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n-    li.classList.remove(\"active\");\r\n-  });\r\n-\r\n-  // Abrir el que se clickeó si no estaba activo\r\n-  if (!isActive) {\r\n-    liCategoria.classList.add(\"active\");\r\n+  // toggle subcategorías\r\n+  // =========================\r\n+  function toggleSubcategorias(liCategoria) {\r\n+    const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n+    if (!subMenu) return;\r\n+    const abierto = subMenu.style.display === \"block\";\r\n+    document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(u => u.style.display = \"none\");\r\n+    subMenu.style.display = abierto ? \"none\" : \"block\";\r\n   }\r\n-}\r\n \r\n-// =========================\r\n-// construir menú desde JSON\r\n-// =========================\r\n-function buildMenuFromData(categorias) {\r\n-  menuCategorias.innerHTML = \"\";\r\n+  // =========================\r\n+  // construir menú desde JSON\r\n+  // =========================\r\n+  function buildMenuFromData(categorias) {\r\n+    menuCategorias.innerHTML = \"\";\r\n+    categorias.forEach(cat => {\r\n+      const li = document.createElement(\"li\");\r\n+      li.className = \"categoria-item\";\r\n \r\n-  categorias.forEach(cat => {\r\n-    const li = document.createElement(\"li\");\r\n-    li.className = \"categoria-item\";\r\n+      const a = document.createElement(\"a\");\r\n+      a.href = \"#\";\r\n+      a.textContent = cat.nombre;\r\n+      a.setAttribute(\"role\", \"button\");\r\n+      a.setAttribute(\"aria-expanded\", \"false\");\r\n \r\n-    const a = document.createElement(\"a\");\r\n-    a.href = \"#\";\r\n-    a.textContent = cat.nombre;\r\n-    a.setAttribute(\"role\", \"button\");\r\n-    a.setAttribute(\"aria-expanded\", \"false\");\r\n+      if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n+        const ulSub = document.createElement(\"ul\");\r\n+        ulSub.className = \"subcategorias\";\r\n+        ulSub.style.display = \"none\";\r\n \r\n-    if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n-      const ulSub = document.createElement(\"ul\");\r\n-      ulSub.className = \"subcategorias\";\r\n+        cat.subcategorias.forEach(sub => {\r\n+          const liSub = document.createElement(\"li\");\r\n+          const aSub = document.createElement(\"a\");\r\n+          aSub.href = \"#\";\r\n+          aSub.textContent = sub.nombre;\r\n+          aSub.addEventListener(\"click\", e => {\r\n+            e.preventDefault();\r\n+            mostrarProductosPorSubcategoria(sub.id);\r\n+            ulSub.style.display = \"none\";\r\n+            contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n+          });\r\n+          liSub.appendChild(aSub);\r\n+          ulSub.appendChild(liSub);\r\n+        });\r\n \r\n-      cat.subcategorias.forEach(sub => {\r\n-        const liSub = document.createElement(\"li\");\r\n-        const aSub = document.createElement(\"a\");\r\n-        aSub.href = \"#\";\r\n-        aSub.textContent = sub.nombre;\r\n-        aSub.addEventListener(\"click\", e => {\r\n+        a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          mostrarProductosPorSubcategoria(sub.id);\r\n-          // opcional: cerrar menú lateral si quieres\r\n-          // cerrarMenuLateral();\r\n-          contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n+          toggleSubcategorias(li);\r\n         });\r\n-        liSub.appendChild(aSub);\r\n-        ulSub.appendChild(liSub);\r\n-      });\r\n \r\n-      // Al hacer clic en la categoría principal, togglear subcategorías\r\n-      a.addEventListener(\"click\", e => {\r\n-        e.preventDefault();\r\n-        toggleSubcategorias(li);\r\n-      });\r\n+        li.appendChild(a);\r\n+        li.appendChild(ulSub);\r\n+      } else {\r\n+        a.addEventListener(\"click\", e => e.preventDefault());\r\n+        li.appendChild(a);\r\n+      }\r\n \r\n-      li.appendChild(a);\r\n-      li.appendChild(ulSub);\r\n-    } else {\r\n-      // categoría sin subcategorías\r\n-      a.addEventListener(\"click\", e => {\r\n-        e.preventDefault();\r\n-        mostrarProductosPorSubcategoria(cat.id);\r\n-      });\r\n-      li.appendChild(a);\r\n-    }\r\n+      menuCategorias.appendChild(li);\r\n+    });\r\n+  }\r\n \r\n-    menuCategorias.appendChild(li);\r\n-  });\r\n-}\r\n-\r\n-// =========================\r\n-// cargar JSON de productos\r\n-// =========================\r\n-fetch(\"productos.json\")\r\n-  .then(resp => resp.json())\r\n-  .then(data => {\r\n-    productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n-    buildMenuFromData(data.categorias || []);\r\n-    log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n-  })\r\n-  .catch(e => err(\"Error cargando productos.json:\", e));\r\n+  // =========================\r\n+  // cargar JSON de productos\r\n+  // =========================\r\n+  fetch(\"productos.json\")\r\n+    .then(resp => resp.json())\r\n+    .then(data => {\r\n+      productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n+      buildMenuFromData(data.categorias || []);\r\n+      log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n+    })\r\n+    .catch(e => err(\"Error cargando productos.json:\", e));\r\n+});\r\n"
                },
                {
                    "date": 1759161178308,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,9 +12,9 @@\n   const promoBar = document.querySelector(\".promo-bar\");\r\n   const topBar = document.querySelector(\".top-bar\");\r\n   const header = document.querySelector(\".main-header\");\r\n   const body = document.body;\r\n-  const menuCategorias = document.getElementById(\"menu-categorias\");\r\n+  const menuCategorias = document.getElementById('menu-categorias');\r\n   const toggleCategorias = document.getElementById(\"toggle-categorias\"); // botón Categorías\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n   if (!menuCategorias) {\r\n"
                },
                {
                    "date": 1759161263951,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -110,19 +110,21 @@\n     });\r\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // =========================\r\n-  // toggle subcategorías\r\n-  // =========================\r\n-  function toggleSubcategorias(liCategoria) {\r\n-    const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n-    if (!subMenu) return;\r\n-    const abierto = subMenu.style.display === \"block\";\r\n-    document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(u => u.style.display = \"none\");\r\n-    subMenu.style.display = abierto ? \"none\" : \"block\";\r\n-  }\r\n+function toggleSubcategorias(liCategoria) {\r\n+  const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n+  if (!subMenu) return;  // Si no existe, no hacer nada\r\n+  \r\n+  const abierto = subMenu.style.display === \"block\";  // Verificar si está abierto\r\n+  // Cerrar todas las subcategorías abiertas\r\n+  document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(u => u.style.display = \"none\");\r\n+  \r\n+  // Si no estaba abierto, abrirlo\r\n+  subMenu.style.display = abierto ? \"none\" : \"block\";\r\n+}\r\n \r\n+\r\n   // =========================\r\n   // construir menú desde JSON\r\n   // =========================\r\n   function buildMenuFromData(categorias) {\r\n"
                },
                {
                    "date": 1759161397855,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -110,8 +110,11 @@\n     });\r\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n+// =========================\r\n+// toggle subcategorías\r\n+// =========================\r\n function toggleSubcategorias(liCategoria) {\r\n   const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n   if (!subMenu) return;  // Si no existe, no hacer nada\r\n   \r\n@@ -122,68 +125,69 @@\n   // Si no estaba abierto, abrirlo\r\n   subMenu.style.display = abierto ? \"none\" : \"block\";\r\n }\r\n \r\n+// =========================\r\n+// construir menú desde JSON\r\n+// =========================\r\n+function buildMenuFromData(categorias) {\r\n+  const menuCategorias = document.getElementById('menu-categorias');\r\n+  menuCategorias.innerHTML = \"\";  // Limpiar el contenido previo\r\n \r\n-  // =========================\r\n-  // construir menú desde JSON\r\n-  // =========================\r\n-  function buildMenuFromData(categorias) {\r\n-    menuCategorias.innerHTML = \"\";\r\n-    categorias.forEach(cat => {\r\n-      const li = document.createElement(\"li\");\r\n-      li.className = \"categoria-item\";\r\n+  categorias.forEach(cat => {\r\n+    const li = document.createElement(\"li\");\r\n+    li.className = \"categoria-item\";\r\n \r\n-      const a = document.createElement(\"a\");\r\n-      a.href = \"#\";\r\n-      a.textContent = cat.nombre;\r\n-      a.setAttribute(\"role\", \"button\");\r\n-      a.setAttribute(\"aria-expanded\", \"false\");\r\n+    const a = document.createElement(\"a\");\r\n+    a.href = \"#\";\r\n+    a.textContent = cat.nombre;\r\n+    a.setAttribute(\"role\", \"button\");\r\n+    a.setAttribute(\"aria-expanded\", \"false\");\r\n \r\n-      if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n-        const ulSub = document.createElement(\"ul\");\r\n-        ulSub.className = \"subcategorias\";\r\n-        ulSub.style.display = \"none\";\r\n+    if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n+      const ulSub = document.createElement(\"ul\");\r\n+      ulSub.className = \"subcategorias\";\r\n+      ulSub.style.display = \"none\";  // Inicialmente oculta las subcategorías\r\n \r\n-        cat.subcategorias.forEach(sub => {\r\n-          const liSub = document.createElement(\"li\");\r\n-          const aSub = document.createElement(\"a\");\r\n-          aSub.href = \"#\";\r\n-          aSub.textContent = sub.nombre;\r\n-          aSub.addEventListener(\"click\", e => {\r\n-            e.preventDefault();\r\n-            mostrarProductosPorSubcategoria(sub.id);\r\n-            ulSub.style.display = \"none\";\r\n-            contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n-          });\r\n-          liSub.appendChild(aSub);\r\n-          ulSub.appendChild(liSub);\r\n-        });\r\n-\r\n-        a.addEventListener(\"click\", e => {\r\n+      cat.subcategorias.forEach(sub => {\r\n+        const liSub = document.createElement(\"li\");\r\n+        const aSub = document.createElement(\"a\");\r\n+        aSub.href = \"#\";\r\n+        aSub.textContent = sub.nombre;\r\n+        aSub.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          toggleSubcategorias(li);\r\n+          mostrarProductosPorSubcategoria(sub.id);\r\n+          ulSub.style.display = \"none\";\r\n+          contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n         });\r\n+        liSub.appendChild(aSub);\r\n+        ulSub.appendChild(liSub);\r\n+      });\r\n \r\n-        li.appendChild(a);\r\n-        li.appendChild(ulSub);\r\n-      } else {\r\n-        a.addEventListener(\"click\", e => e.preventDefault());\r\n-        li.appendChild(a);\r\n-      }\r\n+      // Evento para mostrar/ocultar subcategorías\r\n+      a.addEventListener(\"click\", e => {\r\n+        e.preventDefault();\r\n+        toggleSubcategorias(li);\r\n+      });\r\n \r\n-      menuCategorias.appendChild(li);\r\n-    });\r\n-  }\r\n+      li.appendChild(a);\r\n+      li.appendChild(ulSub);\r\n+    } else {\r\n+      a.addEventListener(\"click\", e => e.preventDefault());  // Enlace sin subcategorías\r\n+      li.appendChild(a);\r\n+    }\r\n \r\n-  // =========================\r\n-  // cargar JSON de productos\r\n-  // =========================\r\n-  fetch(\"productos.json\")\r\n-    .then(resp => resp.json())\r\n-    .then(data => {\r\n-      productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n-      buildMenuFromData(data.categorias || []);\r\n-      log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n-    })\r\n-    .catch(e => err(\"Error cargando productos.json:\", e));\r\n-});\r\n+    menuCategorias.appendChild(li);\r\n+  });\r\n+}\r\n+\r\n+// =========================\r\n+// cargar JSON de productos\r\n+// =========================\r\n+fetch(\"productos.json\")\r\n+  .then(resp => resp.json())\r\n+  .then(data => {\r\n+    productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n+    buildMenuFromData(data.categorias || []);  // Construir el menú dinámicamente\r\n+    console.log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n+  })\r\n+  .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n"
                },
                {
                    "date": 1759161606930,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,52 +8,47 @@\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n-  const promoBar = document.querySelector(\".promo-bar\");\r\n-  const topBar = document.querySelector(\".top-bar\");\r\n-  const header = document.querySelector(\".main-header\");\r\n-  const body = document.body;\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n-  const toggleCategorias = document.getElementById(\"toggle-categorias\"); // botón Categorías\r\n+  const toggleCategorias = document.getElementById(\"toggle-categorias\");\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n   if (!menuCategorias) {\r\n     err(\"No se encontró #menu-categorias en el DOM. Revisa tu HTML.\");\r\n     return;\r\n   }\r\n \r\n   let productosGlobal = [];\r\n-  let lastScrollTop = 0;\r\n \r\n   // =========================\r\n   // abrir / cerrar menú lateral\r\n   // =========================\r\n   function abrirMenu() {\r\n-    nav?.classList.add(\"activo\");\r\n-    overlayMenu?.classList.add(\"activo\");\r\n-    menuToggle?.setAttribute(\"aria-expanded\", \"true\");\r\n+    nav.classList.add(\"activo\");\r\n+    overlayMenu.classList.add(\"activo\");\r\n+    menuToggle.setAttribute(\"aria-expanded\", \"true\");\r\n   }\r\n \r\n   function cerrarMenuLateral() {\r\n-    nav?.classList.remove(\"activo\");\r\n-    overlayMenu?.classList.remove(\"activo\");\r\n-    menuToggle?.setAttribute(\"aria-expanded\", \"false\");\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n+    menuToggle.setAttribute(\"aria-expanded\", \"false\");\r\n     document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(ul => {\r\n-      ul.style.display = \"none\";\r\n+      ul.style.display = \"none\";  // Esto debería estar manejado por clases CSS\r\n     });\r\n     log(\"Menú cerrado y submenús colapsados\");\r\n   }\r\n \r\n   menuToggle?.addEventListener(\"click\", () => {\r\n-    if (nav?.classList.contains(\"activo\")) cerrarMenuLateral();\r\n+    if (nav.classList.contains(\"activo\")) cerrarMenuLateral();\r\n     else abrirMenu();\r\n   });\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   document.addEventListener(\"keydown\", e => { if (e.key === \"Escape\") cerrarMenuLateral(); });\r\n   document.addEventListener(\"click\", e => {\r\n-    if (nav?.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle?.contains(e.target)) {\r\n+    if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n       cerrarMenuLateral();\r\n     }\r\n   });\r\n \r\n@@ -66,27 +61,8 @@\n     menuCategorias.style.display = abierto ? \"none\" : \"block\";\r\n   });\r\n \r\n   // =========================\r\n-  // scroll header\r\n-  // =========================\r\n-  window.addEventListener(\"scroll\", () => {\r\n-    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n-    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-      promoBar?.classList.add(\"hidden\");\r\n-      topBar?.classList.add(\"hidden\");\r\n-      if (header) header.style.top = \"0\";\r\n-      if (body) body.style.paddingTop = \"0\";\r\n-    } else {\r\n-      promoBar?.classList.remove(\"hidden\");\r\n-      topBar?.classList.remove(\"hidden\");\r\n-      if (header) header.style.top = \"72px\";\r\n-      if (body) body.style.paddingTop = \"180px\";\r\n-    }\r\n-    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n-  });\r\n-\r\n-  // =========================\r\n   // mostrar productos por subcategoría\r\n   // =========================\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n@@ -110,84 +86,91 @@\n     });\r\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-// =========================\r\n-// toggle subcategorías\r\n-// =========================\r\n-function toggleSubcategorias(liCategoria) {\r\n-  const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n-  if (!subMenu) return;  // Si no existe, no hacer nada\r\n-  \r\n-  const abierto = subMenu.style.display === \"block\";  // Verificar si está abierto\r\n-  // Cerrar todas las subcategorías abiertas\r\n-  document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(u => u.style.display = \"none\");\r\n-  \r\n-  // Si no estaba abierto, abrirlo\r\n-  subMenu.style.display = abierto ? \"none\" : \"block\";\r\n-}\r\n+  // =========================\r\n+  // toggle subcategorías\r\n+  // =========================\r\n+  function toggleSubcategorias(liCategoria) {\r\n+    // Seleccionar el submenú correspondiente\r\n+    const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n+    if (!subMenu) return;  // Si no existe el submenú, no hacer nada\r\n \r\n-// =========================\r\n-// construir menú desde JSON\r\n-// =========================\r\n-function buildMenuFromData(categorias) {\r\n-  const menuCategorias = document.getElementById('menu-categorias');\r\n-  menuCategorias.innerHTML = \"\";  // Limpiar el contenido previo\r\n+    // Verificar si está activo\r\n+    const abierto = liCategoria.classList.contains(\"active\");\r\n \r\n-  categorias.forEach(cat => {\r\n-    const li = document.createElement(\"li\");\r\n-    li.className = \"categoria-item\";\r\n+    // Cerrar todos los submenús\r\n+    document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n+      li.classList.remove(\"active\");\r\n+    });\r\n \r\n-    const a = document.createElement(\"a\");\r\n-    a.href = \"#\";\r\n-    a.textContent = cat.nombre;\r\n-    a.setAttribute(\"role\", \"button\");\r\n-    a.setAttribute(\"aria-expanded\", \"false\");\r\n+    // Si no estaba activo, abrirlo\r\n+    if (!abierto) {\r\n+      liCategoria.classList.add(\"active\");\r\n+    }\r\n+  }\r\n \r\n-    if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n-      const ulSub = document.createElement(\"ul\");\r\n-      ulSub.className = \"subcategorias\";\r\n-      ulSub.style.display = \"none\";  // Inicialmente oculta las subcategorías\r\n+  // =========================\r\n+  // construir menú desde JSON\r\n+  // =========================\r\n+  function buildMenuFromData(categorias) {\r\n+    menuCategorias.innerHTML = \"\";  // Limpiar el contenido previo\r\n \r\n-      cat.subcategorias.forEach(sub => {\r\n-        const liSub = document.createElement(\"li\");\r\n-        const aSub = document.createElement(\"a\");\r\n-        aSub.href = \"#\";\r\n-        aSub.textContent = sub.nombre;\r\n-        aSub.addEventListener(\"click\", e => {\r\n+    categorias.forEach(cat => {\r\n+      const li = document.createElement(\"li\");\r\n+      li.className = \"categoria-item\";\r\n+\r\n+      const a = document.createElement(\"a\");\r\n+      a.href = \"#\";\r\n+      a.textContent = cat.nombre;\r\n+      a.setAttribute(\"role\", \"button\");\r\n+      a.setAttribute(\"aria-expanded\", \"false\");\r\n+\r\n+      if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n+        const ulSub = document.createElement(\"ul\");\r\n+        ulSub.className = \"subcategorias\";\r\n+        ulSub.style.display = \"none\";  // Inicialmente oculta las subcategorías\r\n+\r\n+        cat.subcategorias.forEach(sub => {\r\n+          const liSub = document.createElement(\"li\");\r\n+          const aSub = document.createElement(\"a\");\r\n+          aSub.href = \"#\";\r\n+          aSub.textContent = sub.nombre;\r\n+          aSub.addEventListener(\"click\", e => {\r\n+            e.preventDefault();\r\n+            mostrarProductosPorSubcategoria(sub.id);\r\n+            ulSub.style.display = \"none\";\r\n+            contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n+          });\r\n+          liSub.appendChild(aSub);\r\n+          ulSub.appendChild(liSub);\r\n+        });\r\n+\r\n+        // Evento para mostrar/ocultar subcategorías\r\n+        a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          mostrarProductosPorSubcategoria(sub.id);\r\n-          ulSub.style.display = \"none\";\r\n-          contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n+          toggleSubcategorias(li);\r\n         });\r\n-        liSub.appendChild(aSub);\r\n-        ulSub.appendChild(liSub);\r\n-      });\r\n \r\n-      // Evento para mostrar/ocultar subcategorías\r\n-      a.addEventListener(\"click\", e => {\r\n-        e.preventDefault();\r\n-        toggleSubcategorias(li);\r\n-      });\r\n+        li.appendChild(a);\r\n+        li.appendChild(ulSub);\r\n+      } else {\r\n+        a.addEventListener(\"click\", e => e.preventDefault());  // Enlace sin subcategorías\r\n+        li.appendChild(a);\r\n+      }\r\n \r\n-      li.appendChild(a);\r\n-      li.appendChild(ulSub);\r\n-    } else {\r\n-      a.addEventListener(\"click\", e => e.preventDefault());  // Enlace sin subcategorías\r\n-      li.appendChild(a);\r\n-    }\r\n+      menuCategorias.appendChild(li);\r\n+    });\r\n+  }\r\n \r\n-    menuCategorias.appendChild(li);\r\n-  });\r\n-}\r\n-\r\n-// =========================\r\n-// cargar JSON de productos\r\n-// =========================\r\n-fetch(\"productos.json\")\r\n-  .then(resp => resp.json())\r\n-  .then(data => {\r\n-    productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n-    buildMenuFromData(data.categorias || []);  // Construir el menú dinámicamente\r\n-    console.log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n-  })\r\n-  .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n+  // =========================\r\n+  // cargar JSON de productos\r\n+  // =========================\r\n+  fetch(\"productos.json\")\r\n+    .then(resp => resp.json())\r\n+    .then(data => {\r\n+      productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n+      buildMenuFromData(data.categorias || []);  // Construir el menú dinámicamente\r\n+      log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n+    })\r\n+    .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n+});\r\n"
                },
                {
                    "date": 1759161847903,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,6 @@\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n   const log = (...args) => console.log(\"%c[menu.js]\", \"color: #0a84ff; font-weight:700\", ...args);\r\n-  const warn = (...args) => console.warn(\"%c[menu.js]\", \"color: #ff9f0a; font-weight:700\", ...args);\r\n   const err = (...args) => console.error(\"%c[menu.js]\", \"color: #ff3b30; font-weight:700\", ...args);\r\n \r\n   log(\"iniciando...\");\r\n \r\n@@ -32,10 +31,10 @@\n   function cerrarMenuLateral() {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n     menuToggle.setAttribute(\"aria-expanded\", \"false\");\r\n-    document.querySelectorAll(\"#menu-categorias ul.subcategorias\").forEach(ul => {\r\n-      ul.style.display = \"none\";  // Esto debería estar manejado por clases CSS\r\n+    document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n+      li.classList.remove(\"active\"); // Cerrar todos los submenús\r\n     });\r\n     log(\"Menú cerrado y submenús colapsados\");\r\n   }\r\n \r\n@@ -127,9 +126,8 @@\n \r\n       if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n         const ulSub = document.createElement(\"ul\");\r\n         ulSub.className = \"subcategorias\";\r\n-        ulSub.style.display = \"none\";  // Inicialmente oculta las subcategorías\r\n \r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n@@ -137,9 +135,9 @@\n           aSub.textContent = sub.nombre;\r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n-            ulSub.style.display = \"none\";\r\n+            liSub.querySelector(\"ul.subcategorias\").style.display = \"none\"; // Ocultar subcategorías\r\n             contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n"
                },
                {
                    "date": 1759162139766,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,14 +64,17 @@\n   // mostrar productos por subcategoría\r\n   // =========================\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n-    contenedorProductos.innerHTML = \"\";\r\n-    const filtrados = productosGlobal.filter(p => p.subcategoria === id);\r\n+    contenedorProductos.innerHTML = \"\"; // Limpiar los productos mostrados\r\n+\r\n+    const filtrados = productosGlobal.filter(p => p.subcategoria === id); // Filtrar productos por subcategoría\r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n       return;\r\n     }\r\n+\r\n+    // Mostrar los productos filtrados\r\n     filtrados.forEach(prod => {\r\n       const card = document.createElement(\"div\");\r\n       card.className = \"producto-card\";\r\n       card.innerHTML = `\r\n@@ -134,9 +137,9 @@\n           aSub.href = \"#\";\r\n           aSub.textContent = sub.nombre;\r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n-            mostrarProductosPorSubcategoria(sub.id);\r\n+            mostrarProductosPorSubcategoria(sub.id); // Filtrar productos por subcategoría\r\n             liSub.querySelector(\"ul.subcategorias\").style.display = \"none\"; // Ocultar subcategorías\r\n             contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n           liSub.appendChild(aSub);\r\n"
                },
                {
                    "date": 1759162338591,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,9 +8,8 @@\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n-  const toggleCategorias = document.getElementById(\"toggle-categorias\");\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n   if (!menuCategorias) {\r\n     err(\"No se encontró #menu-categorias en el DOM. Revisa tu HTML.\");\r\n@@ -51,17 +50,8 @@\n     }\r\n   });\r\n \r\n   // =========================\r\n-  // desplegar categorías principales\r\n-  // =========================\r\n-  toggleCategorias?.addEventListener(\"click\", e => {\r\n-    e.preventDefault();\r\n-    const abierto = menuCategorias.style.display === \"block\";\r\n-    menuCategorias.style.display = abierto ? \"none\" : \"block\";\r\n-  });\r\n-\r\n-  // =========================\r\n   // mostrar productos por subcategoría\r\n   // =========================\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n"
                },
                {
                    "date": 1759163378677,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,8 +8,9 @@\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n+  const toggleCategorias = document.getElementById(\"toggle-categorias\");\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n   if (!menuCategorias) {\r\n     err(\"No se encontró #menu-categorias en el DOM. Revisa tu HTML.\");\r\n@@ -50,8 +51,17 @@\n     }\r\n   });\r\n \r\n   // =========================\r\n+  // desplegar categorías principales\r\n+  // =========================\r\n+  toggleCategorias?.addEventListener(\"click\", e => {\r\n+    e.preventDefault();\r\n+    const abierto = menuCategorias.style.display === \"block\";\r\n+    menuCategorias.style.display = abierto ? \"none\" : \"block\";\r\n+  });\r\n+\r\n+  // =========================\r\n   // mostrar productos por subcategoría\r\n   // =========================\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n"
                },
                {
                    "date": 1759164206687,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,14 +22,16 @@\n   // =========================\r\n   // abrir / cerrar menú lateral\r\n   // =========================\r\n   function abrirMenu() {\r\n+    if (!nav || !overlayMenu || !menuToggle) return;\r\n     nav.classList.add(\"activo\");\r\n     overlayMenu.classList.add(\"activo\");\r\n     menuToggle.setAttribute(\"aria-expanded\", \"true\");\r\n   }\r\n \r\n   function cerrarMenuLateral() {\r\n+    if (!nav || !overlayMenu || !menuToggle) return;\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n     menuToggle.setAttribute(\"aria-expanded\", \"false\");\r\n     document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n@@ -72,9 +74,8 @@\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n       return;\r\n     }\r\n \r\n-    // Mostrar los productos filtrados\r\n     filtrados.forEach(prod => {\r\n       const card = document.createElement(\"div\");\r\n       card.className = \"producto-card\";\r\n       card.innerHTML = `\r\n@@ -92,21 +93,17 @@\n   // =========================\r\n   // toggle subcategorías\r\n   // =========================\r\n   function toggleSubcategorias(liCategoria) {\r\n-    // Seleccionar el submenú correspondiente\r\n     const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n-    if (!subMenu) return;  // Si no existe el submenú, no hacer nada\r\n+    if (!subMenu) return;\r\n \r\n-    // Verificar si está activo\r\n     const abierto = liCategoria.classList.contains(\"active\");\r\n \r\n-    // Cerrar todos los submenús\r\n     document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n       li.classList.remove(\"active\");\r\n     });\r\n \r\n-    // Si no estaba activo, abrirlo\r\n     if (!abierto) {\r\n       liCategoria.classList.add(\"active\");\r\n     }\r\n   }\r\n@@ -114,9 +111,9 @@\n   // =========================\r\n   // construir menú desde JSON\r\n   // =========================\r\n   function buildMenuFromData(categorias) {\r\n-    menuCategorias.innerHTML = \"\";  // Limpiar el contenido previo\r\n+    menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       li.className = \"categoria-item\";\r\n@@ -135,28 +132,33 @@\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\";\r\n           aSub.textContent = sub.nombre;\r\n+\r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n-            mostrarProductosPorSubcategoria(sub.id); // Filtrar productos por subcategoría\r\n-            liSub.querySelector(\"ul.subcategorias\").style.display = \"none\"; // Ocultar subcategorías\r\n+            mostrarProductosPorSubcategoria(sub.id);\r\n+\r\n+            document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n+              li.classList.remove(\"active\");\r\n+            });\r\n+\r\n             contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n+\r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n-        // Evento para mostrar/ocultar subcategorías\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           toggleSubcategorias(li);\r\n         });\r\n \r\n         li.appendChild(a);\r\n         li.appendChild(ulSub);\r\n       } else {\r\n-        a.addEventListener(\"click\", e => e.preventDefault());  // Enlace sin subcategorías\r\n+        a.addEventListener(\"click\", e => e.preventDefault());\r\n         li.appendChild(a);\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n@@ -169,9 +171,9 @@\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n       productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n-      buildMenuFromData(data.categorias || []);  // Construir el menú dinámicamente\r\n+      buildMenuFromData(data.categorias || []);\r\n       log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759164351463,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -68,9 +68,9 @@\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\"; // Limpiar los productos mostrados\r\n \r\n-    const filtrados = productosGlobal.filter(p => p.subcategoria === id); // Filtrar productos por subcategoría\r\n+    const filtrados = productosGlobal.filter(p => p.subcategoria === id);\r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n       return;\r\n     }\r\n@@ -98,14 +98,19 @@\n     if (!subMenu) return;\r\n \r\n     const abierto = liCategoria.classList.contains(\"active\");\r\n \r\n-    document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n-      li.classList.remove(\"active\");\r\n+    // Cerrar todos los submenús activos al mismo nivel\r\n+    const hermanos = liCategoria.parentElement.querySelectorAll(\":scope > li.active\");\r\n+    hermanos.forEach(li => {\r\n+      if (li !== liCategoria) li.classList.remove(\"active\");\r\n     });\r\n \r\n+    // Activar/desactivar el submenú\r\n     if (!abierto) {\r\n       liCategoria.classList.add(\"active\");\r\n+    } else {\r\n+      liCategoria.classList.remove(\"active\");\r\n     }\r\n   }\r\n \r\n   // =========================\r\n@@ -137,12 +142,17 @@\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n-              li.classList.remove(\"active\");\r\n-            });\r\n+            // Cerrar submenús hermanos activos\r\n+            const liPadre = liSub.parentElement.closest(\"li\");\r\n+            if (liPadre) {\r\n+              liPadre.querySelectorAll(\":scope > ul.subcategorias > li.active\").forEach(li => {\r\n+                if (li !== liSub) li.classList.remove(\"active\");\r\n+              });\r\n+            }\r\n \r\n+            liSub.classList.add(\"active\");\r\n             contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n"
                },
                {
                    "date": 1759165494521,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,11 +33,9 @@\n     if (!nav || !overlayMenu || !menuToggle) return;\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n     menuToggle.setAttribute(\"aria-expanded\", \"false\");\r\n-    document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n-      li.classList.remove(\"active\"); // Cerrar todos los submenús\r\n-    });\r\n+    document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => li.classList.remove(\"active\"));\r\n     log(\"Menú cerrado y submenús colapsados\");\r\n   }\r\n \r\n   menuToggle?.addEventListener(\"click\", () => {\r\n@@ -47,11 +45,9 @@\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   document.addEventListener(\"keydown\", e => { if (e.key === \"Escape\") cerrarMenuLateral(); });\r\n   document.addEventListener(\"click\", e => {\r\n-    if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n-      cerrarMenuLateral();\r\n-    }\r\n+    if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) cerrarMenuLateral();\r\n   });\r\n \r\n   // =========================\r\n   // desplegar categorías principales\r\n@@ -66,11 +62,13 @@\n   // mostrar productos por subcategoría\r\n   // =========================\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n-    contenedorProductos.innerHTML = \"\"; // Limpiar los productos mostrados\r\n+    contenedorProductos.innerHTML = \"\";\r\n \r\n-    const filtrados = productosGlobal.filter(p => p.subcategoria === id);\r\n+    // Convertir ambos a Number para asegurar comparación correcta\r\n+    const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n+\r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n       return;\r\n     }\r\n@@ -98,20 +96,13 @@\n     if (!subMenu) return;\r\n \r\n     const abierto = liCategoria.classList.contains(\"active\");\r\n \r\n-    // Cerrar todos los submenús activos al mismo nivel\r\n     const hermanos = liCategoria.parentElement.querySelectorAll(\":scope > li.active\");\r\n-    hermanos.forEach(li => {\r\n-      if (li !== liCategoria) li.classList.remove(\"active\");\r\n-    });\r\n+    hermanos.forEach(li => { if (li !== liCategoria) li.classList.remove(\"active\"); });\r\n \r\n-    // Activar/desactivar el submenú\r\n-    if (!abierto) {\r\n-      liCategoria.classList.add(\"active\");\r\n-    } else {\r\n-      liCategoria.classList.remove(\"active\");\r\n-    }\r\n+    if (!abierto) liCategoria.classList.add(\"active\");\r\n+    else liCategoria.classList.remove(\"active\");\r\n   }\r\n \r\n   // =========================\r\n   // construir menú desde JSON\r\n@@ -142,9 +133,9 @@\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            // Cerrar submenús hermanos activos\r\n+            // cerrar otros submenús activos\r\n             const liPadre = liSub.parentElement.closest(\"li\");\r\n             if (liPadre) {\r\n               liPadre.querySelectorAll(\":scope > ul.subcategorias > li.active\").forEach(li => {\r\n                 if (li !== liSub) li.classList.remove(\"active\");\r\n@@ -158,12 +149,9 @@\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n-        a.addEventListener(\"click\", e => {\r\n-          e.preventDefault();\r\n-          toggleSubcategorias(li);\r\n-        });\r\n+        a.addEventListener(\"click\", e => { e.preventDefault(); toggleSubcategorias(li); });\r\n \r\n         li.appendChild(a);\r\n         li.appendChild(ulSub);\r\n       } else {\r\n@@ -184,6 +172,6 @@\n       productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n       buildMenuFromData(data.categorias || []);\r\n       log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n     })\r\n-    .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n+    .catch(e => err(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759165776937,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,9 +64,9 @@\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n \r\n-    // Convertir ambos a Number para asegurar comparación correcta\r\n+    // Filtrar productos y ofertas usando Number para evitar problemas de tipo\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n \r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n@@ -133,9 +133,9 @@\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            // cerrar otros submenús activos\r\n+            // Cerrar otros submenús activos\r\n             const liPadre = liSub.parentElement.closest(\"li\");\r\n             if (liPadre) {\r\n               liPadre.querySelectorAll(\":scope > ul.subcategorias > li.active\").forEach(li => {\r\n                 if (li !== liSub) li.classList.remove(\"active\");\r\n"
                },
                {
                    "date": 1759166025070,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -58,9 +58,9 @@\n     menuCategorias.style.display = abierto ? \"none\" : \"block\";\r\n   });\r\n \r\n   // =========================\r\n-  // mostrar productos por subcategoría\r\n+  // mostrar productos por subcategoría (actualizado)\r\n   // =========================\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n@@ -73,15 +73,16 @@\n       return;\r\n     }\r\n \r\n     filtrados.forEach(prod => {\r\n+      const precioMostrado = prod.precio_con_descuento ?? prod.precio;\r\n       const card = document.createElement(\"div\");\r\n       card.className = \"producto-card\";\r\n       card.innerHTML = `\r\n         <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n         <h3>${prod.nombre}</h3>\r\n         <p>${prod.descripcion || \"\"}</p>\r\n-        <span class=\"precio\">S/ ${Number(prod.precio || 0).toFixed(2)}</span>\r\n+        <span class=\"precio\">S/ ${Number(precioMostrado || 0).toFixed(2)}</span>\r\n         <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n"
                },
                {
                    "date": 1759166562761,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -58,38 +58,39 @@\n     menuCategorias.style.display = abierto ? \"none\" : \"block\";\r\n   });\r\n \r\n   // =========================\r\n-  // mostrar productos por subcategoría (actualizado)\r\n-  // =========================\r\n-  function mostrarProductosPorSubcategoria(id) {\r\n-    if (!contenedorProductos) return;\r\n-    contenedorProductos.innerHTML = \"\";\r\n+// mostrar productos por subcategoría (actualizado)\r\n+// =========================\r\n+function mostrarProductosPorSubcategoria(id) {\r\n+  if (!contenedorProductos) return;\r\n+  contenedorProductos.innerHTML = \"\";\r\n \r\n-    // Filtrar productos y ofertas usando Number para evitar problemas de tipo\r\n-    const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n+  // Filtrar productos y ofertas usando Number para evitar problemas de tipo\r\n+  const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n \r\n-    if (!filtrados.length) {\r\n-      contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-      return;\r\n-    }\r\n-\r\n-    filtrados.forEach(prod => {\r\n-      const precioMostrado = prod.precio_con_descuento ?? prod.precio;\r\n-      const card = document.createElement(\"div\");\r\n-      card.className = \"producto-card\";\r\n-      card.innerHTML = `\r\n-        <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n-        <h3>${prod.nombre}</h3>\r\n-        <p>${prod.descripcion || \"\"}</p>\r\n-        <span class=\"precio\">S/ ${Number(precioMostrado || 0).toFixed(2)}</span>\r\n-        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n-      `;\r\n-      contenedorProductos.appendChild(card);\r\n-    });\r\n+  if (!filtrados.length) {\r\n+    contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+    return;\r\n   }\r\n-  window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n+  filtrados.forEach(prod => {\r\n+    const precioMostrado = prod.precio_con_descuento ?? prod.precio;\r\n+    const card = document.createElement(\"div\");\r\n+    card.className = \"producto-card\";\r\n+    card.innerHTML = `\r\n+      <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+      <h3>${prod.nombre}</h3>\r\n+      <p>${prod.descripcion || \"\"}</p>\r\n+      <span class=\"precio\">S/ ${Number(precioMostrado || 0).toFixed(2)}</span>\r\n+      <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+    `;\r\n+    contenedorProductos.appendChild(card);\r\n+  });\r\n+}\r\n+window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n+\r\n+\r\n   // =========================\r\n   // toggle subcategorías\r\n   // =========================\r\n   function toggleSubcategorias(liCategoria) {\r\n"
                },
                {
                    "date": 1759167144645,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n-  const menuCategorias = document.getElementById('menu-categorias');\r\n+  const menuCategorias = document.getElementById(\"menu-categorias\");\r\n   const toggleCategorias = document.getElementById(\"toggle-categorias\");\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n   if (!menuCategorias) {\r\n@@ -22,19 +22,17 @@\n   // =========================\r\n   // abrir / cerrar menú lateral\r\n   // =========================\r\n   function abrirMenu() {\r\n-    if (!nav || !overlayMenu || !menuToggle) return;\r\n-    nav.classList.add(\"activo\");\r\n-    overlayMenu.classList.add(\"activo\");\r\n-    menuToggle.setAttribute(\"aria-expanded\", \"true\");\r\n+    nav?.classList.add(\"activo\");\r\n+    overlayMenu?.classList.add(\"activo\");\r\n+    menuToggle?.setAttribute(\"aria-expanded\", \"true\");\r\n   }\r\n \r\n   function cerrarMenuLateral() {\r\n-    if (!nav || !overlayMenu || !menuToggle) return;\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n-    menuToggle.setAttribute(\"aria-expanded\", \"false\");\r\n+    nav?.classList.remove(\"activo\");\r\n+    overlayMenu?.classList.remove(\"activo\");\r\n+    menuToggle?.setAttribute(\"aria-expanded\", \"false\");\r\n     document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => li.classList.remove(\"active\"));\r\n     log(\"Menú cerrado y submenús colapsados\");\r\n   }\r\n \r\n@@ -58,38 +56,40 @@\n     menuCategorias.style.display = abierto ? \"none\" : \"block\";\r\n   });\r\n \r\n   // =========================\r\n-// mostrar productos por subcategoría (actualizado)\r\n-// =========================\r\n-function mostrarProductosPorSubcategoria(id) {\r\n-  if (!contenedorProductos) return;\r\n-  contenedorProductos.innerHTML = \"\";\r\n+  // mostrar productos por subcategoría\r\n+  // =========================\r\n+  function mostrarProductosPorSubcategoria(id) {\r\n+    if (!contenedorProductos) return;\r\n+    contenedorProductos.innerHTML = \"\";\r\n \r\n-  // Filtrar productos y ofertas usando Number para evitar problemas de tipo\r\n-  const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n+    // Filtrar productos y ofertas usando Number para evitar problemas de tipo\r\n+    const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n \r\n-  if (!filtrados.length) {\r\n-    contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-    return;\r\n-  }\r\n+    if (!filtrados.length) {\r\n+      contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+      return;\r\n+    }\r\n \r\n-  filtrados.forEach(prod => {\r\n-    const precioMostrado = prod.precio_con_descuento ?? prod.precio;\r\n-    const card = document.createElement(\"div\");\r\n-    card.className = \"producto-card\";\r\n-    card.innerHTML = `\r\n-      <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n-      <h3>${prod.nombre}</h3>\r\n-      <p>${prod.descripcion || \"\"}</p>\r\n-      <span class=\"precio\">S/ ${Number(precioMostrado || 0).toFixed(2)}</span>\r\n-      <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n-    `;\r\n-    contenedorProductos.appendChild(card);\r\n-  });\r\n-}\r\n-window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n+    filtrados.forEach(prod => {\r\n+      const precioMostrado = prod.precio_con_descuento ?? prod.precio;\r\n+      const card = document.createElement(\"div\");\r\n+      card.className = \"producto-card\";\r\n+      card.innerHTML = `\r\n+        <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+        <h3>${prod.nombre}</h3>\r\n+        <p>${prod.descripcion || \"\"}</p>\r\n+        <span class=\"precio\">S/ ${Number(precioMostrado || 0).toFixed(2)}</span>\r\n+        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+      `;\r\n+      contenedorProductos.appendChild(card);\r\n+    });\r\n \r\n+    // Hacer scroll al contenedor de productos\r\n+    contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n+  }\r\n+  window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n   // =========================\r\n   // toggle subcategorías\r\n   // =========================\r\n@@ -98,8 +98,9 @@\n     if (!subMenu) return;\r\n \r\n     const abierto = liCategoria.classList.contains(\"active\");\r\n \r\n+    // Cerrar otros submenús activos al mismo nivel\r\n     const hermanos = liCategoria.parentElement.querySelectorAll(\":scope > li.active\");\r\n     hermanos.forEach(li => { if (li !== liCategoria) li.classList.remove(\"active\"); });\r\n \r\n     if (!abierto) liCategoria.classList.add(\"active\");\r\n@@ -133,9 +134,10 @@\n           aSub.textContent = sub.nombre;\r\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n-            mostrarProductosPorSubcategoria(sub.id);\r\n+            // Convertir id a número para comparación segura\r\n+            mostrarProductosPorSubcategoria(Number(sub.id));\r\n \r\n             // Cerrar otros submenús activos\r\n             const liPadre = liSub.parentElement.closest(\"li\");\r\n             if (liPadre) {\r\n@@ -144,9 +146,8 @@\n               });\r\n             }\r\n \r\n             liSub.classList.add(\"active\");\r\n-            contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n@@ -170,8 +171,9 @@\n   // =========================\r\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n+      // Combinar productos y ofertas en un solo array\r\n       productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n       buildMenuFromData(data.categorias || []);\r\n       log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n     })\r\n"
                },
                {
                    "date": 1759167391162,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,72 +1,49 @@\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n   const log = (...args) => console.log(\"%c[menu.js]\", \"color: #0a84ff; font-weight:700\", ...args);\r\n   const err = (...args) => console.error(\"%c[menu.js]\", \"color: #ff3b30; font-weight:700\", ...args);\r\n \r\n-  log(\"iniciando...\");\r\n-\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n-  const menuCategorias = document.getElementById(\"menu-categorias\");\r\n+  const menuCategorias = document.getElementById('menu-categorias');\r\n   const toggleCategorias = document.getElementById(\"toggle-categorias\");\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n-  if (!menuCategorias) {\r\n-    err(\"No se encontró #menu-categorias en el DOM. Revisa tu HTML.\");\r\n-    return;\r\n-  }\r\n+  if (!menuCategorias) return err(\"No se encontró #menu-categorias en el DOM\");\r\n \r\n   let productosGlobal = [];\r\n \r\n-  // =========================\r\n-  // abrir / cerrar menú lateral\r\n-  // =========================\r\n-  function abrirMenu() {\r\n-    nav?.classList.add(\"activo\");\r\n-    overlayMenu?.classList.add(\"activo\");\r\n-    menuToggle?.setAttribute(\"aria-expanded\", \"true\");\r\n-  }\r\n-\r\n-  function cerrarMenuLateral() {\r\n-    nav?.classList.remove(\"activo\");\r\n-    overlayMenu?.classList.remove(\"activo\");\r\n+  // Abrir/Cerrar menú lateral\r\n+  const abrirMenu = () => { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); menuToggle?.setAttribute(\"aria-expanded\", \"true\"); }\r\n+  const cerrarMenuLateral = () => { \r\n+    nav.classList.remove(\"activo\"); \r\n+    overlayMenu.classList.remove(\"activo\"); \r\n     menuToggle?.setAttribute(\"aria-expanded\", \"false\");\r\n     document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => li.classList.remove(\"active\"));\r\n-    log(\"Menú cerrado y submenús colapsados\");\r\n   }\r\n-\r\n-  menuToggle?.addEventListener(\"click\", () => {\r\n-    if (nav.classList.contains(\"activo\")) cerrarMenuLateral();\r\n-    else abrirMenu();\r\n-  });\r\n+  menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   document.addEventListener(\"keydown\", e => { if (e.key === \"Escape\") cerrarMenuLateral(); });\r\n+\r\n   document.addEventListener(\"click\", e => {\r\n-    if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) cerrarMenuLateral();\r\n+    if(nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) cerrarMenuLateral();\r\n   });\r\n \r\n-  // =========================\r\n-  // desplegar categorías principales\r\n-  // =========================\r\n+  // Toggle categorías principales\r\n   toggleCategorias?.addEventListener(\"click\", e => {\r\n     e.preventDefault();\r\n-    const abierto = menuCategorias.style.display === \"block\";\r\n-    menuCategorias.style.display = abierto ? \"none\" : \"block\";\r\n+    menuCategorias.style.display = menuCategorias.style.display === \"block\" ? \"none\" : \"block\";\r\n   });\r\n \r\n-  // =========================\r\n-  // mostrar productos por subcategoría\r\n-  // =========================\r\n+  // Mostrar productos por subcategoría\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n \r\n-    // Filtrar productos y ofertas usando Number para evitar problemas de tipo\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n-\r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n       return;\r\n     }\r\n@@ -78,39 +55,17 @@\n       card.innerHTML = `\r\n         <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n         <h3>${prod.nombre}</h3>\r\n         <p>${prod.descripcion || \"\"}</p>\r\n-        <span class=\"precio\">S/ ${Number(precioMostrado || 0).toFixed(2)}</span>\r\n+        <span class=\"precio\">S/ ${Number(precioMostrado).toFixed(2)}</span>\r\n         <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n-\r\n-    // Hacer scroll al contenedor de productos\r\n-    contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // =========================\r\n-  // toggle subcategorías\r\n-  // =========================\r\n-  function toggleSubcategorias(liCategoria) {\r\n-    const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n-    if (!subMenu) return;\r\n-\r\n-    const abierto = liCategoria.classList.contains(\"active\");\r\n-\r\n-    // Cerrar otros submenús activos al mismo nivel\r\n-    const hermanos = liCategoria.parentElement.querySelectorAll(\":scope > li.active\");\r\n-    hermanos.forEach(li => { if (li !== liCategoria) li.classList.remove(\"active\"); });\r\n-\r\n-    if (!abierto) liCategoria.classList.add(\"active\");\r\n-    else liCategoria.classList.remove(\"active\");\r\n-  }\r\n-\r\n-  // =========================\r\n-  // construir menú desde JSON\r\n-  // =========================\r\n+  // Construir menú dinámico desde JSON\r\n   function buildMenuFromData(categorias) {\r\n     menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n@@ -120,13 +75,15 @@\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\";\r\n       a.textContent = cat.nombre;\r\n       a.setAttribute(\"role\", \"button\");\r\n-      a.setAttribute(\"aria-expanded\", \"false\");\r\n \r\n+      li.appendChild(a);\r\n+\r\n       if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n         const ulSub = document.createElement(\"ul\");\r\n         ulSub.className = \"subcategorias\";\r\n+        ulSub.style.display = \"none\";\r\n \r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n@@ -134,48 +91,35 @@\n           aSub.textContent = sub.nombre;\r\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n-            // Convertir id a número para comparación segura\r\n             mostrarProductosPorSubcategoria(Number(sub.id));\r\n-\r\n-            // Cerrar otros submenús activos\r\n-            const liPadre = liSub.parentElement.closest(\"li\");\r\n-            if (liPadre) {\r\n-              liPadre.querySelectorAll(\":scope > ul.subcategorias > li.active\").forEach(li => {\r\n-                if (li !== liSub) li.classList.remove(\"active\");\r\n-              });\r\n-            }\r\n-\r\n+            li.querySelectorAll(\"li.active\").forEach(activeLi => activeLi.classList.remove(\"active\"));\r\n             liSub.classList.add(\"active\");\r\n+            contenedorProductos?.scrollIntoView({behavior: \"smooth\"});\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n-        a.addEventListener(\"click\", e => { e.preventDefault(); toggleSubcategorias(li); });\r\n+        li.appendChild(ulSub);\r\n \r\n-        li.appendChild(a);\r\n-        li.appendChild(ulSub);\r\n-      } else {\r\n-        a.addEventListener(\"click\", e => e.preventDefault());\r\n-        li.appendChild(a);\r\n+        a.addEventListener(\"click\", e => {\r\n+          e.preventDefault();\r\n+          ulSub.style.display = ulSub.style.display === \"block\" ? \"none\" : \"block\";\r\n+        });\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n     });\r\n   }\r\n \r\n-  // =========================\r\n-  // cargar JSON de productos\r\n-  // =========================\r\n+  // Cargar JSON\r\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n-      // Combinar productos y ofertas en un solo array\r\n       productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n       buildMenuFromData(data.categorias || []);\r\n-      log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n     })\r\n     .catch(e => err(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759167693000,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,41 +9,34 @@\n   const menuCategorias = document.getElementById('menu-categorias');\r\n   const toggleCategorias = document.getElementById(\"toggle-categorias\");\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n-  if (!menuCategorias) return err(\"No se encontró #menu-categorias en el DOM\");\r\n+  if (!menuCategorias) return;\r\n \r\n   let productosGlobal = [];\r\n \r\n-  // Abrir/Cerrar menú lateral\r\n-  const abrirMenu = () => { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); menuToggle?.setAttribute(\"aria-expanded\", \"true\"); }\r\n-  const cerrarMenuLateral = () => { \r\n+  // =========================\r\n+  // abrir / cerrar menú lateral\r\n+  // =========================\r\n+  function abrirMenu() { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); }\r\n+  function cerrarMenuLateral() { \r\n     nav.classList.remove(\"activo\"); \r\n     overlayMenu.classList.remove(\"activo\"); \r\n-    menuToggle?.setAttribute(\"aria-expanded\", \"false\");\r\n     document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   }\r\n   menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n-  document.addEventListener(\"keydown\", e => { if (e.key === \"Escape\") cerrarMenuLateral(); });\r\n \r\n-  document.addEventListener(\"click\", e => {\r\n-    if(nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) cerrarMenuLateral();\r\n-  });\r\n-\r\n-  // Toggle categorías principales\r\n-  toggleCategorias?.addEventListener(\"click\", e => {\r\n-    e.preventDefault();\r\n-    menuCategorias.style.display = menuCategorias.style.display === \"block\" ? \"none\" : \"block\";\r\n-  });\r\n-\r\n-  // Mostrar productos por subcategoría\r\n+  // =========================\r\n+  // mostrar productos por subcategoría\r\n+  // =========================\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n \r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n+\r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n       return;\r\n     }\r\n@@ -55,17 +48,21 @@\n       card.innerHTML = `\r\n         <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n         <h3>${prod.nombre}</h3>\r\n         <p>${prod.descripcion || \"\"}</p>\r\n-        <span class=\"precio\">S/ ${Number(precioMostrado).toFixed(2)}</span>\r\n+        <span class=\"precio\">S/ ${Number(precioMostrado || 0).toFixed(2)}</span>\r\n         <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n+    contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   }\r\n+\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // Construir menú dinámico desde JSON\r\n+  // =========================\r\n+  // construir menú desde JSON\r\n+  // =========================\r\n   function buildMenuFromData(categorias) {\r\n     menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n@@ -74,16 +71,14 @@\n \r\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\";\r\n       a.textContent = cat.nombre;\r\n-      a.setAttribute(\"role\", \"button\");\r\n \r\n       li.appendChild(a);\r\n \r\n-      if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n+      if (cat.subcategorias?.length) {\r\n         const ulSub = document.createElement(\"ul\");\r\n         ulSub.className = \"subcategorias\";\r\n-        ulSub.style.display = \"none\";\r\n \r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n@@ -91,35 +86,45 @@\n           aSub.textContent = sub.nombre;\r\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n-            mostrarProductosPorSubcategoria(Number(sub.id));\r\n-            li.querySelectorAll(\"li.active\").forEach(activeLi => activeLi.classList.remove(\"active\"));\r\n+\r\n+            // Filtrar productos\r\n+            mostrarProductosPorSubcategoria(sub.id);\r\n+\r\n+            // Marcar solo esta subcategoría como activa\r\n+            li.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n             liSub.classList.add(\"active\");\r\n-            contenedorProductos?.scrollIntoView({behavior: \"smooth\"});\r\n+\r\n+            // Abrir el submenú si no está abierto\r\n+            li.classList.add(\"active\");\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n         li.appendChild(ulSub);\r\n \r\n+        // Al hacer clic en la categoría principal, alternar submenú\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          ulSub.style.display = ulSub.style.display === \"block\" ? \"none\" : \"block\";\r\n+          li.classList.toggle(\"active\");\r\n         });\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n     });\r\n   }\r\n \r\n-  // Cargar JSON\r\n+  // =========================\r\n+  // cargar JSON\r\n+  // =========================\r\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n       productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n       buildMenuFromData(data.categorias || []);\r\n+      log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n     })\r\n     .catch(e => err(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759167878957,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,8 +33,9 @@\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n \r\n+    // Filtrar productos y ofertas usando Number para evitar problemas de tipo\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n \r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n@@ -53,11 +54,11 @@\n         <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n+\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   }\r\n-\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n   // =========================\r\n   // construir menú desde JSON\r\n@@ -87,16 +88,16 @@\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n \r\n-            // Filtrar productos\r\n+            // Mostrar productos solo de esta subcategoría\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            // Marcar solo esta subcategoría como activa\r\n+            // Limpiar otras subcategorías activas\r\n             li.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n             liSub.classList.add(\"active\");\r\n \r\n-            // Abrir el submenú si no está abierto\r\n+            // Asegurar que la categoría padre se vea abierta\r\n             li.classList.add(\"active\");\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n@@ -104,9 +105,9 @@\n         });\r\n \r\n         li.appendChild(ulSub);\r\n \r\n-        // Al hacer clic en la categoría principal, alternar submenú\r\n+        // Toggle categoría padre al hacer clic\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           li.classList.toggle(\"active\");\r\n         });\r\n"
                },
                {
                    "date": 1759168068158,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,14 +16,19 @@\n \r\n   // =========================\r\n   // abrir / cerrar menú lateral\r\n   // =========================\r\n-  function abrirMenu() { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); }\r\n-  function cerrarMenuLateral() { \r\n-    nav.classList.remove(\"activo\"); \r\n-    overlayMenu.classList.remove(\"activo\"); \r\n+  function abrirMenu() {\r\n+    nav.classList.add(\"activo\");\r\n+    overlayMenu.classList.add(\"activo\");\r\n+  }\r\n+\r\n+  function cerrarMenuLateral() {\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n     document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   }\r\n+\r\n   menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n \r\n@@ -33,9 +38,8 @@\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n \r\n-    // Filtrar productos y ofertas usando Number para evitar problemas de tipo\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n \r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n@@ -108,8 +112,15 @@\n \r\n         // Toggle categoría padre al hacer clic\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n+\r\n+          // Cerrar otras categorías activas\r\n+          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => {\r\n+            if (liAct !== li) liAct.classList.remove(\"active\");\r\n+          });\r\n+\r\n+          // Alternar esta categoría\r\n           li.classList.toggle(\"active\");\r\n         });\r\n       }\r\n \r\n"
                },
                {
                    "date": 1759168226793,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -96,10 +96,10 @@\n             // Mostrar productos solo de esta subcategoría\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n             // Limpiar otras subcategorías activas\r\n-            li.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-            liSub.classList.add(\"active\");\r\n+            li.querySelectorAll(\"ul li a.active\").forEach(aAct => aAct.classList.remove(\"active\"));\r\n+            aSub.classList.add(\"active\");\r\n \r\n             // Asegurar que la categoría padre se vea abierta\r\n             li.classList.add(\"active\");\r\n           });\r\n"
                },
                {
                    "date": 1759168427509,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,10 +5,9 @@\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n-  const menuCategorias = document.getElementById('menu-categorias');\r\n-  const toggleCategorias = document.getElementById(\"toggle-categorias\");\r\n+  const menuCategorias = document.getElementById(\"menu-categorias\");\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n   if (!menuCategorias) return;\r\n \r\n@@ -16,19 +15,15 @@\n \r\n   // =========================\r\n   // abrir / cerrar menú lateral\r\n   // =========================\r\n-  function abrirMenu() {\r\n-    nav.classList.add(\"activo\");\r\n-    overlayMenu.classList.add(\"activo\");\r\n+  function abrirMenu() { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); }\r\n+  function cerrarMenuLateral() { \r\n+    nav.classList.remove(\"activo\"); \r\n+    overlayMenu.classList.remove(\"activo\"); \r\n+    menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   }\r\n \r\n-  function cerrarMenuLateral() {\r\n-    nav.classList.remove(\"activo\");\r\n-    overlayMenu.classList.remove(\"activo\");\r\n-    document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => li.classList.remove(\"active\"));\r\n-  }\r\n-\r\n   menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n \r\n@@ -58,11 +53,11 @@\n         <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n-\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   }\r\n+\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n   // =========================\r\n   // construir menú desde JSON\r\n@@ -76,9 +71,8 @@\n \r\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\";\r\n       a.textContent = cat.nombre;\r\n-\r\n       li.appendChild(a);\r\n \r\n       if (cat.subcategorias?.length) {\r\n         const ulSub = document.createElement(\"ul\");\r\n@@ -92,16 +86,14 @@\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n \r\n-            // Mostrar productos solo de esta subcategoría\r\n+            // Filtrar productos\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            // Limpiar otras subcategorías activas\r\n-            li.querySelectorAll(\"ul li a.active\").forEach(aAct => aAct.classList.remove(\"active\"));\r\n-            aSub.classList.add(\"active\");\r\n-\r\n-            // Asegurar que la categoría padre se vea abierta\r\n+            // Marcar solo esta subcategoría como activa\r\n+            li.querySelectorAll(\"li.active\").forEach(act => act.classList.remove(\"active\"));\r\n+            liSub.classList.add(\"active\");\r\n             li.classList.add(\"active\");\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n@@ -109,19 +101,17 @@\n         });\r\n \r\n         li.appendChild(ulSub);\r\n \r\n-        // Toggle categoría padre al hacer clic\r\n+        // Toggle categoría padre\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n+          const abierto = li.classList.contains(\"active\");\r\n \r\n-          // Cerrar otras categorías activas\r\n-          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => {\r\n-            if (liAct !== li) liAct.classList.remove(\"active\");\r\n-          });\r\n+          // Cerrar otras categorías\r\n+          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n \r\n-          // Alternar esta categoría\r\n-          li.classList.toggle(\"active\");\r\n+          if (!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n"
                },
                {
                    "date": 1759168807128,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,38 +5,32 @@\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n-  const menuCategorias = document.getElementById(\"menu-categorias\");\r\n+  const menuCategorias = document.getElementById('menu-categorias');\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n   if (!menuCategorias) return;\r\n \r\n   let productosGlobal = [];\r\n \r\n-  // =========================\r\n-  // abrir / cerrar menú lateral\r\n-  // =========================\r\n+  // Abrir / cerrar menú lateral\r\n   function abrirMenu() { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); }\r\n-  function cerrarMenuLateral() { \r\n-    nav.classList.remove(\"activo\"); \r\n-    overlayMenu.classList.remove(\"activo\"); \r\n+  function cerrarMenuLateral() {\r\n+    nav.classList.remove(\"activo\");\r\n+    overlayMenu.classList.remove(\"activo\");\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   }\r\n-\r\n   menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n \r\n-  // =========================\r\n-  // mostrar productos por subcategoría\r\n-  // =========================\r\n+  // Mostrar productos por subcategoría\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n \r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n-\r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n       return;\r\n     }\r\n@@ -55,14 +49,11 @@\n       contenedorProductos.appendChild(card);\r\n     });\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   }\r\n-\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // =========================\r\n-  // construir menú desde JSON\r\n-  // =========================\r\n+  // Construir menú desde JSON\r\n   function buildMenuFromData(categorias) {\r\n     menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n@@ -86,42 +77,39 @@\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n \r\n-            // Filtrar productos\r\n+            // Filtrar productos por subcategoría\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n             // Marcar solo esta subcategoría como activa\r\n-            li.querySelectorAll(\"li.active\").forEach(act => act.classList.remove(\"active\"));\r\n-            liSub.classList.add(\"active\");\r\n-            li.classList.add(\"active\");\r\n+            menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+            li.classList.add(\"active\");    // categoría padre\r\n+            liSub.classList.add(\"active\"); // subcategoría\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n         li.appendChild(ulSub);\r\n \r\n-        // Toggle categoría padre\r\n+        // Toggle categoría padre al hacer clic\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           const abierto = li.classList.contains(\"active\");\r\n-\r\n-          // Cerrar otras categorías\r\n+          // Cerrar todas las categorías\r\n           menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-\r\n+          // Abrir esta categoría si estaba cerrada\r\n           if (!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n     });\r\n   }\r\n \r\n-  // =========================\r\n-  // cargar JSON\r\n-  // =========================\r\n+  // Cargar JSON\r\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n       productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n"
                },
                {
                    "date": 1759169312406,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,9 +51,9 @@\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // Construir menú desde JSON\r\n+  // Construir menú desde JSON con mejoras\r\n   function buildMenuFromData(categorias) {\r\n     menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n@@ -80,9 +80,9 @@\n \r\n             // Filtrar productos por subcategoría\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            // Marcar solo esta subcategoría como activa\r\n+            // Limpiar clases activas de subcategorías y categorías\r\n             menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n             li.classList.add(\"active\");    // categoría padre\r\n             liSub.classList.add(\"active\"); // subcategoría\r\n           });\r\n@@ -92,16 +92,12 @@\n         });\r\n \r\n         li.appendChild(ulSub);\r\n \r\n-        // Toggle categoría padre al hacer clic\r\n+        // Toggle acordeón simple para categoría padre\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          const abierto = li.classList.contains(\"active\");\r\n-          // Cerrar todas las categorías\r\n-          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-          // Abrir esta categoría si estaba cerrada\r\n-          if (!abierto) li.classList.add(\"active\");\r\n+          li.classList.toggle(\"active\"); // Abrir/cerrar subcategorías\r\n         });\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n"
                },
                {
                    "date": 1759169773598,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,15 +7,19 @@\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n+  const toggleCategorias = document.getElementById(\"toggle-categorias\");\r\n \r\n   if (!menuCategorias) return;\r\n \r\n   let productosGlobal = [];\r\n \r\n   // Abrir / cerrar menú lateral\r\n-  function abrirMenu() { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); }\r\n+  function abrirMenu() { \r\n+    nav.classList.add(\"activo\"); \r\n+    overlayMenu.classList.add(\"activo\"); \r\n+  }\r\n   function cerrarMenuLateral() {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n@@ -23,8 +27,14 @@\n   menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n \r\n+  // Toggle para mostrar/ocultar el listado de categorías\r\n+  toggleCategorias?.addEventListener(\"click\", e => {\r\n+    e.preventDefault();\r\n+    menuCategorias.classList.toggle(\"activo\");\r\n+  });\r\n+\r\n   // Mostrar productos por subcategoría\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n@@ -51,9 +61,9 @@\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // Construir menú desde JSON con mejoras\r\n+  // Construir menú desde JSON\r\n   function buildMenuFromData(categorias) {\r\n     menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n@@ -76,13 +86,11 @@\n           aSub.textContent = sub.nombre;\r\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n-\r\n-            // Filtrar productos por subcategoría\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            // Limpiar clases activas de subcategorías y categorías\r\n+            // Limpiar clases activas\r\n             menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n             li.classList.add(\"active\");    // categoría padre\r\n             liSub.classList.add(\"active\"); // subcategoría\r\n           });\r\n@@ -95,9 +103,9 @@\n \r\n         // Toggle acordeón simple para categoría padre\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          li.classList.toggle(\"active\"); // Abrir/cerrar subcategorías\r\n+          li.classList.toggle(\"active\");\r\n         });\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n"
                },
                {
                    "date": 1759169972808,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,9 +21,8 @@\n   }\r\n   function cerrarMenuLateral() {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n-    menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   }\r\n   menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n@@ -84,28 +83,31 @@\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\";\r\n           aSub.textContent = sub.nombre;\r\n \r\n+          // Click en subcategoría → mostrar productos y marcar activo\r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n+\r\n+            // Limpiar subcategorías activas\r\n+            menuCategorias.querySelectorAll(\"li.sub-active\").forEach(subAct => subAct.classList.remove(\"sub-active\"));\r\n+\r\n+            li.classList.add(\"active\");      // Mantener categoría padre activa\r\n+            liSub.classList.add(\"sub-active\"); // Subcategoría activa\r\n+\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n-\r\n-            // Limpiar clases activas\r\n-            menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-            li.classList.add(\"active\");    // categoría padre\r\n-            liSub.classList.add(\"active\"); // subcategoría\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n         li.appendChild(ulSub);\r\n \r\n-        // Toggle acordeón simple para categoría padre\r\n+        // Click en categoría padre → solo abrir/cerrar acordeón\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          li.classList.toggle(\"active\");\r\n+          li.classList.toggle(\"active\"); // Toggle acordeón\r\n         });\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n"
                },
                {
                    "date": 1759170072811,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,33 +7,25 @@\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n-  const toggleCategorias = document.getElementById(\"toggle-categorias\");\r\n \r\n   if (!menuCategorias) return;\r\n \r\n   let productosGlobal = [];\r\n \r\n   // Abrir / cerrar menú lateral\r\n-  function abrirMenu() { \r\n-    nav.classList.add(\"activo\"); \r\n-    overlayMenu.classList.add(\"activo\"); \r\n-  }\r\n+  function abrirMenu() { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); }\r\n   function cerrarMenuLateral() {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n+    // Limpiar clases activas si cierras menú\r\n+    menuCategorias.querySelectorAll(\"li.active, li.sub-active\").forEach(li => li.classList.remove(\"active\", \"sub-active\"));\r\n   }\r\n   menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n \r\n-  // Toggle para mostrar/ocultar el listado de categorías\r\n-  toggleCategorias?.addEventListener(\"click\", e => {\r\n-    e.preventDefault();\r\n-    menuCategorias.classList.toggle(\"activo\");\r\n-  });\r\n-\r\n   // Mostrar productos por subcategoría\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n@@ -60,9 +52,9 @@\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // Construir menú desde JSON\r\n+  // Construir menú desde JSON con categorías y subcategorías\r\n   function buildMenuFromData(categorias) {\r\n     menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n@@ -83,31 +75,32 @@\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\";\r\n           aSub.textContent = sub.nombre;\r\n \r\n-          // Click en subcategoría → mostrar productos y marcar activo\r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n \r\n-            // Limpiar subcategorías activas\r\n-            menuCategorias.querySelectorAll(\"li.sub-active\").forEach(subAct => subAct.classList.remove(\"sub-active\"));\r\n+            // Mostrar productos de la subcategoría\r\n+            mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            li.classList.add(\"active\");      // Mantener categoría padre activa\r\n-            liSub.classList.add(\"sub-active\"); // Subcategoría activa\r\n+            // Limpiar clases activas de subcategorías\r\n+            menuCategorias.querySelectorAll(\"li.sub-active\").forEach(liAct => liAct.classList.remove(\"sub-active\"));\r\n+            liSub.classList.add(\"sub-active\"); // subcategoría activa\r\n \r\n-            mostrarProductosPorSubcategoria(sub.id);\r\n+            // Mantener categoría padre abierta\r\n+            li.classList.add(\"active\");\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n         li.appendChild(ulSub);\r\n \r\n-        // Click en categoría padre → solo abrir/cerrar acordeón\r\n+        // Click en categoría padre → abre/cierra subcategorías\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          li.classList.toggle(\"active\"); // Toggle acordeón\r\n+          li.classList.toggle(\"active\"); // abrir/cerrar subcategorías\r\n         });\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n"
                },
                {
                    "date": 1759170154912,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,9 +17,8 @@\n   function abrirMenu() { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); }\r\n   function cerrarMenuLateral() {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n-    // Limpiar clases activas si cierras menú\r\n     menuCategorias.querySelectorAll(\"li.active, li.sub-active\").forEach(li => li.classList.remove(\"active\", \"sub-active\"));\r\n   }\r\n   menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n@@ -81,12 +80,19 @@\n \r\n             // Mostrar productos de la subcategoría\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            // Limpiar clases activas de subcategorías\r\n+            // Limpiar subcategorías activas\r\n             menuCategorias.querySelectorAll(\"li.sub-active\").forEach(liAct => liAct.classList.remove(\"sub-active\"));\r\n-            liSub.classList.add(\"sub-active\"); // subcategoría activa\r\n \r\n+            // Limpiar categorías activas menos la actual\r\n+            menuCategorias.querySelectorAll(\"li.categoria-item\").forEach(catLi => {\r\n+              if (catLi !== li) catLi.classList.remove(\"active\");\r\n+            });\r\n+\r\n+            // Marcar subcategoría activa\r\n+            liSub.classList.add(\"sub-active\");\r\n+\r\n             // Mantener categoría padre abierta\r\n             li.classList.add(\"active\");\r\n           });\r\n \r\n@@ -95,12 +101,19 @@\n         });\r\n \r\n         li.appendChild(ulSub);\r\n \r\n-        // Click en categoría padre → abre/cierra subcategorías\r\n+        // Click en categoría padre → acordeón simple\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          li.classList.toggle(\"active\"); // abrir/cerrar subcategorías\r\n+\r\n+          // Cerrar todas las demás categorías\r\n+          menuCategorias.querySelectorAll(\"li.categoria-item\").forEach(catLi => {\r\n+            if (catLi !== li) catLi.classList.remove(\"active\");\r\n+          });\r\n+\r\n+          // Alternar la categoría actual\r\n+          li.classList.toggle(\"active\");\r\n         });\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n"
                },
                {
                    "date": 1759170346564,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,14 +13,19 @@\n \r\n   let productosGlobal = [];\r\n \r\n   // Abrir / cerrar menú lateral\r\n-  function abrirMenu() { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); }\r\n+  function abrirMenu() { \r\n+    nav.classList.add(\"activo\"); \r\n+    overlayMenu.classList.add(\"activo\"); \r\n+  }\r\n   function cerrarMenuLateral() {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n+    // Quitar todas las clases active/sub-active\r\n     menuCategorias.querySelectorAll(\"li.active, li.sub-active\").forEach(li => li.classList.remove(\"active\", \"sub-active\"));\r\n   }\r\n+\r\n   menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n \r\n@@ -51,9 +56,9 @@\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // Construir menú desde JSON con categorías y subcategorías\r\n+  // Construir menú desde JSON\r\n   function buildMenuFromData(categorias) {\r\n     menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n@@ -82,36 +87,30 @@\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n             // Limpiar subcategorías activas\r\n             menuCategorias.querySelectorAll(\"li.sub-active\").forEach(liAct => liAct.classList.remove(\"sub-active\"));\r\n-\r\n-            // Limpiar categorías activas menos la actual\r\n-            menuCategorias.querySelectorAll(\"li.categoria-item\").forEach(catLi => {\r\n-              if (catLi !== li) catLi.classList.remove(\"active\");\r\n-            });\r\n-\r\n-            // Marcar subcategoría activa\r\n             liSub.classList.add(\"sub-active\");\r\n \r\n             // Mantener categoría padre abierta\r\n             li.classList.add(\"active\");\r\n+\r\n+            // Cerrar menú lateral automáticamente\r\n+            cerrarMenuLateral();\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n         li.appendChild(ulSub);\r\n \r\n-        // Click en categoría padre → acordeón simple\r\n+        // Click en categoría padre → abrir/cerrar acordeón\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-\r\n           // Cerrar todas las demás categorías\r\n           menuCategorias.querySelectorAll(\"li.categoria-item\").forEach(catLi => {\r\n             if (catLi !== li) catLi.classList.remove(\"active\");\r\n           });\r\n-\r\n           // Alternar la categoría actual\r\n           li.classList.toggle(\"active\");\r\n         });\r\n       }\r\n"
                },
                {
                    "date": 1759170426759,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,131 +1,167 @@\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n   const log = (...args) => console.log(\"%c[menu.js]\", \"color: #0a84ff; font-weight:700\", ...args);\r\n   const err = (...args) => console.error(\"%c[menu.js]\", \"color: #ff3b30; font-weight:700\", ...args);\r\n \r\n+  log(\"iniciando...\");\r\n+\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n-  if (!menuCategorias) return;\r\n+  if (!menuCategorias) {\r\n+    err(\"No se encontró #menu-categorias en el DOM. Revisa tu HTML.\");\r\n+    return;\r\n+  }\r\n \r\n   let productosGlobal = [];\r\n \r\n-  // Abrir / cerrar menú lateral\r\n-  function abrirMenu() { \r\n-    nav.classList.add(\"activo\"); \r\n-    overlayMenu.classList.add(\"activo\"); \r\n+  // =========================\r\n+  // abrir / cerrar menú lateral\r\n+  // =========================\r\n+  function abrirMenu() {\r\n+    nav.classList.add(\"activo\");\r\n+    overlayMenu.classList.add(\"activo\");\r\n+    menuToggle.setAttribute(\"aria-expanded\", \"true\");\r\n   }\r\n+\r\n   function cerrarMenuLateral() {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n-    // Quitar todas las clases active/sub-active\r\n-    menuCategorias.querySelectorAll(\"li.active, li.sub-active\").forEach(li => li.classList.remove(\"active\", \"sub-active\"));\r\n+    menuToggle.setAttribute(\"aria-expanded\", \"false\");\r\n+    document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n+      li.classList.remove(\"active\"); // Cerrar todos los submenús\r\n+    });\r\n+    log(\"Menú cerrado y submenús colapsados\");\r\n   }\r\n \r\n-  menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n+  menuToggle?.addEventListener(\"click\", () => {\r\n+    if (nav.classList.contains(\"activo\")) cerrarMenuLateral();\r\n+    else abrirMenu();\r\n+  });\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n+  document.addEventListener(\"keydown\", e => { if (e.key === \"Escape\") cerrarMenuLateral(); });\r\n+  document.addEventListener(\"click\", e => {\r\n+    if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n+      cerrarMenuLateral();\r\n+    }\r\n+  });\r\n \r\n-  // Mostrar productos por subcategoría\r\n+  // =========================\r\n+  // mostrar productos por subcategoría\r\n+  // =========================\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n-    contenedorProductos.innerHTML = \"\";\r\n+    contenedorProductos.innerHTML = \"\"; // Limpiar los productos mostrados\r\n \r\n-    const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n+    const filtrados = productosGlobal.filter(p => p.subcategoria === id); // Filtrar productos por subcategoría\r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n       return;\r\n     }\r\n \r\n+    // Mostrar los productos filtrados\r\n     filtrados.forEach(prod => {\r\n-      const precioMostrado = prod.precio_con_descuento ?? prod.precio;\r\n       const card = document.createElement(\"div\");\r\n       card.className = \"producto-card\";\r\n       card.innerHTML = `\r\n         <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n         <h3>${prod.nombre}</h3>\r\n         <p>${prod.descripcion || \"\"}</p>\r\n-        <span class=\"precio\">S/ ${Number(precioMostrado || 0).toFixed(2)}</span>\r\n+        <span class=\"precio\">S/ ${Number(prod.precio || 0).toFixed(2)}</span>\r\n         <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n-    contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // Construir menú desde JSON\r\n+  // =========================\r\n+  // toggle subcategorías\r\n+  // =========================\r\n+  function toggleSubcategorias(liCategoria) {\r\n+    // Seleccionar el submenú correspondiente\r\n+    const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n+    if (!subMenu) return;  // Si no existe el submenú, no hacer nada\r\n+\r\n+    // Verificar si está activo\r\n+    const abierto = liCategoria.classList.contains(\"active\");\r\n+\r\n+    // Cerrar todos los submenús\r\n+    document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n+      li.classList.remove(\"active\");\r\n+    });\r\n+\r\n+    // Si no estaba activo, abrirlo\r\n+    if (!abierto) {\r\n+      liCategoria.classList.add(\"active\");\r\n+    }\r\n+  }\r\n+\r\n+  // =========================\r\n+  // construir menú desde JSON\r\n+  // =========================\r\n   function buildMenuFromData(categorias) {\r\n-    menuCategorias.innerHTML = \"\";\r\n+    menuCategorias.innerHTML = \"\";  // Limpiar el contenido previo\r\n \r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       li.className = \"categoria-item\";\r\n \r\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\";\r\n       a.textContent = cat.nombre;\r\n-      li.appendChild(a);\r\n+      a.setAttribute(\"role\", \"button\");\r\n+      a.setAttribute(\"aria-expanded\", \"false\");\r\n \r\n-      if (cat.subcategorias?.length) {\r\n+      if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n         const ulSub = document.createElement(\"ul\");\r\n         ulSub.className = \"subcategorias\";\r\n \r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\";\r\n           aSub.textContent = sub.nombre;\r\n-\r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n-\r\n-            // Mostrar productos de la subcategoría\r\n-            mostrarProductosPorSubcategoria(sub.id);\r\n-\r\n-            // Limpiar subcategorías activas\r\n-            menuCategorias.querySelectorAll(\"li.sub-active\").forEach(liAct => liAct.classList.remove(\"sub-active\"));\r\n-            liSub.classList.add(\"sub-active\");\r\n-\r\n-            // Mantener categoría padre abierta\r\n-            li.classList.add(\"active\");\r\n-\r\n-            // Cerrar menú lateral automáticamente\r\n-            cerrarMenuLateral();\r\n+            mostrarProductosPorSubcategoria(sub.id); // Filtrar productos por subcategoría\r\n+            liSub.querySelector(\"ul.subcategorias\").style.display = \"none\"; // Ocultar subcategorías\r\n+            contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n           });\r\n-\r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n-        li.appendChild(ulSub);\r\n-\r\n-        // Click en categoría padre → abrir/cerrar acordeón\r\n+        // Evento para mostrar/ocultar subcategorías\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          // Cerrar todas las demás categorías\r\n-          menuCategorias.querySelectorAll(\"li.categoria-item\").forEach(catLi => {\r\n-            if (catLi !== li) catLi.classList.remove(\"active\");\r\n-          });\r\n-          // Alternar la categoría actual\r\n-          li.classList.toggle(\"active\");\r\n+          toggleSubcategorias(li);\r\n         });\r\n+\r\n+        li.appendChild(a);\r\n+        li.appendChild(ulSub);\r\n+      } else {\r\n+        a.addEventListener(\"click\", e => e.preventDefault());  // Enlace sin subcategorías\r\n+        li.appendChild(a);\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n     });\r\n   }\r\n \r\n-  // Cargar JSON\r\n+  // =========================\r\n+  // cargar JSON de productos\r\n+  // =========================\r\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n       productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n-      buildMenuFromData(data.categorias || []);\r\n+      buildMenuFromData(data.categorias || []);  // Construir el menú dinámicamente\r\n       log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n     })\r\n-    .catch(e => err(\"Error cargando productos.json:\", e));\r\n+    .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759173141284,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,167 +1,136 @@\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n   const log = (...args) => console.log(\"%c[menu.js]\", \"color: #0a84ff; font-weight:700\", ...args);\r\n   const err = (...args) => console.error(\"%c[menu.js]\", \"color: #ff3b30; font-weight:700\", ...args);\r\n \r\n-  log(\"iniciando...\");\r\n-\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n   const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n \r\n-  if (!menuCategorias) {\r\n-    err(\"No se encontró #menu-categorias en el DOM. Revisa tu HTML.\");\r\n-    return;\r\n-  }\r\n+  if (!menuCategorias) return;\r\n \r\n   let productosGlobal = [];\r\n \r\n-  // =========================\r\n-  // abrir / cerrar menú lateral\r\n-  // =========================\r\n+  // Abrir menú lateral\r\n   function abrirMenu() {\r\n     nav.classList.add(\"activo\");\r\n     overlayMenu.classList.add(\"activo\");\r\n-    menuToggle.setAttribute(\"aria-expanded\", \"true\");\r\n   }\r\n \r\n+  // Cerrar menú lateral y subcategorías\r\n   function cerrarMenuLateral() {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n-    menuToggle.setAttribute(\"aria-expanded\", \"false\");\r\n-    document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n-      li.classList.remove(\"active\"); // Cerrar todos los submenús\r\n-    });\r\n-    log(\"Menú cerrado y submenús colapsados\");\r\n+    menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   }\r\n \r\n+  // Toggle menú lateral\r\n   menuToggle?.addEventListener(\"click\", () => {\r\n-    if (nav.classList.contains(\"activo\")) cerrarMenuLateral();\r\n-    else abrirMenu();\r\n+    nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu();\r\n   });\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n-  document.addEventListener(\"keydown\", e => { if (e.key === \"Escape\") cerrarMenuLateral(); });\r\n-  document.addEventListener(\"click\", e => {\r\n-    if (nav.classList.contains(\"activo\") && !nav.contains(e.target) && !menuToggle.contains(e.target)) {\r\n-      cerrarMenuLateral();\r\n-    }\r\n-  });\r\n \r\n-  // =========================\r\n-  // mostrar productos por subcategoría\r\n-  // =========================\r\n+  // Mostrar productos por subcategoría\r\n   function mostrarProductosPorSubcategoria(id) {\r\n     if (!contenedorProductos) return;\r\n-    contenedorProductos.innerHTML = \"\"; // Limpiar los productos mostrados\r\n+    contenedorProductos.innerHTML = \"\";\r\n \r\n-    const filtrados = productosGlobal.filter(p => p.subcategoria === id); // Filtrar productos por subcategoría\r\n+    const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n       return;\r\n     }\r\n \r\n-    // Mostrar los productos filtrados\r\n     filtrados.forEach(prod => {\r\n+      const precioMostrado = prod.precio_con_descuento ?? prod.precio;\r\n       const card = document.createElement(\"div\");\r\n       card.className = \"producto-card\";\r\n       card.innerHTML = `\r\n         <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n         <h3>${prod.nombre}</h3>\r\n         <p>${prod.descripcion || \"\"}</p>\r\n-        <span class=\"precio\">S/ ${Number(prod.precio || 0).toFixed(2)}</span>\r\n+        <span class=\"precio\">S/ ${Number(precioMostrado || 0).toFixed(2)}</span>\r\n         <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n+    contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // =========================\r\n-  // toggle subcategorías\r\n-  // =========================\r\n-  function toggleSubcategorias(liCategoria) {\r\n-    // Seleccionar el submenú correspondiente\r\n-    const subMenu = liCategoria.querySelector(\"ul.subcategorias\");\r\n-    if (!subMenu) return;  // Si no existe el submenú, no hacer nada\r\n-\r\n-    // Verificar si está activo\r\n-    const abierto = liCategoria.classList.contains(\"active\");\r\n-\r\n-    // Cerrar todos los submenús\r\n-    document.querySelectorAll(\"#menu-categorias li.active\").forEach(li => {\r\n-      li.classList.remove(\"active\");\r\n-    });\r\n-\r\n-    // Si no estaba activo, abrirlo\r\n-    if (!abierto) {\r\n-      liCategoria.classList.add(\"active\");\r\n-    }\r\n-  }\r\n-\r\n-  // =========================\r\n-  // construir menú desde JSON\r\n-  // =========================\r\n+  // Construir menú dinámico\r\n   function buildMenuFromData(categorias) {\r\n-    menuCategorias.innerHTML = \"\";  // Limpiar el contenido previo\r\n+    menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       li.className = \"categoria-item\";\r\n \r\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\";\r\n       a.textContent = cat.nombre;\r\n-      a.setAttribute(\"role\", \"button\");\r\n-      a.setAttribute(\"aria-expanded\", \"false\");\r\n+      li.appendChild(a);\r\n \r\n-      if (Array.isArray(cat.subcategorias) && cat.subcategorias.length) {\r\n+      if (cat.subcategorias?.length) {\r\n         const ulSub = document.createElement(\"ul\");\r\n-        ulSub.className = \"subcategorias\";\r\n \r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\";\r\n           aSub.textContent = sub.nombre;\r\n+\r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n-            mostrarProductosPorSubcategoria(sub.id); // Filtrar productos por subcategoría\r\n-            liSub.querySelector(\"ul.subcategorias\").style.display = \"none\"; // Ocultar subcategorías\r\n-            contenedorProductos?.scrollIntoView({ behavior: \"smooth\" });\r\n+\r\n+            // Mostrar productos de la subcategoría\r\n+            mostrarProductosPorSubcategoria(sub.id);\r\n+\r\n+            // Limpiar clases activas\r\n+            menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+\r\n+            // Marcar categoría padre y subcategoría\r\n+            li.classList.add(\"active\");\r\n+            liSub.classList.add(\"active\");\r\n+\r\n+            // Cerrar menú lateral al seleccionar subcategoría\r\n+            cerrarMenuLateral();\r\n           });\r\n+\r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n-        // Evento para mostrar/ocultar subcategorías\r\n+        li.appendChild(ulSub);\r\n+\r\n+        // Toggle categoría padre (solo una abierta a la vez)\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          toggleSubcategorias(li);\r\n+\r\n+          const abierto = li.classList.contains(\"active\");\r\n+\r\n+          // Cerrar todas las categorías\r\n+          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+\r\n+          // Abrir solo si estaba cerrada\r\n+          if (!abierto) li.classList.add(\"active\");\r\n         });\r\n-\r\n-        li.appendChild(a);\r\n-        li.appendChild(ulSub);\r\n-      } else {\r\n-        a.addEventListener(\"click\", e => e.preventDefault());  // Enlace sin subcategorías\r\n-        li.appendChild(a);\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n     });\r\n   }\r\n \r\n-  // =========================\r\n-  // cargar JSON de productos\r\n-  // =========================\r\n+  // Cargar productos desde JSON\r\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n       productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n-      buildMenuFromData(data.categorias || []);  // Construir el menú dinámicamente\r\n+      buildMenuFromData(data.categorias || []);\r\n       log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n     })\r\n-    .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n+    .catch(e => err(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759173415391,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n-  const contenedorProductos = document.getElementById(\"contenedor-productos\");\r\n+  const contenedorProductos = document.getElementById(\"catalogo\"); // Ajusta al contenedor de productos\r\n \r\n   if (!menuCategorias) return;\r\n \r\n   let productosGlobal = [];\r\n@@ -18,19 +18,17 @@\n     nav.classList.add(\"activo\");\r\n     overlayMenu.classList.add(\"activo\");\r\n   }\r\n \r\n-  // Cerrar menú lateral y subcategorías\r\n+  // Cerrar menú lateral\r\n   function cerrarMenuLateral() {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   }\r\n \r\n-  // Toggle menú lateral\r\n-  menuToggle?.addEventListener(\"click\", () => {\r\n-    nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu();\r\n-  });\r\n+  // Botones de abrir/cerrar\r\n+  menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n \r\n   // Mostrar productos por subcategoría\r\n@@ -56,13 +54,14 @@\n         <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n+\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // Construir menú dinámico\r\n+  // Construir menú dinámicamente desde JSON\r\n   function buildMenuFromData(categorias) {\r\n     menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n@@ -85,17 +84,16 @@\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n \r\n-            // Mostrar productos de la subcategoría\r\n+            // Mostrar productos filtrados\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n             // Limpiar clases activas\r\n             menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n \r\n-            // Marcar categoría padre y subcategoría\r\n-            li.classList.add(\"active\");\r\n-            liSub.classList.add(\"active\");\r\n+            li.classList.add(\"active\");    // categoría padre\r\n+            liSub.classList.add(\"active\"); // subcategoría\r\n \r\n             // Cerrar menú lateral al seleccionar subcategoría\r\n             cerrarMenuLateral();\r\n           });\r\n@@ -105,19 +103,18 @@\n         });\r\n \r\n         li.appendChild(ulSub);\r\n \r\n-        // Toggle categoría padre (solo una abierta a la vez)\r\n+        // Toggle de subcategoría al hacer clic en la categoría padre\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n \r\n-          const abierto = li.classList.contains(\"active\");\r\n+          // Cerrar otras categorías abiertas\r\n+          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => {\r\n+            if (liAct !== li) liAct.classList.remove(\"active\");\r\n+          });\r\n \r\n-          // Cerrar todas las categorías\r\n-          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-\r\n-          // Abrir solo si estaba cerrada\r\n-          if (!abierto) li.classList.add(\"active\");\r\n+          li.classList.toggle(\"active\");\r\n         });\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n"
                },
                {
                    "date": 1759173652837,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,133 +1,112 @@\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n-  const log = (...args) => console.log(\"%c[menu.js]\", \"color: #0a84ff; font-weight:700\", ...args);\r\n-  const err = (...args) => console.error(\"%c[menu.js]\", \"color: #ff3b30; font-weight:700\", ...args);\r\n-\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n-  const contenedorProductos = document.getElementById(\"catalogo\"); // Ajusta al contenedor de productos\r\n+  const contenedorProductos = document.getElementById(\"catalogo\"); // Contenedor de productos\r\n+  let productosGlobal = [];\r\n \r\n   if (!menuCategorias) return;\r\n \r\n-  let productosGlobal = [];\r\n-\r\n   // Abrir menú lateral\r\n-  function abrirMenu() {\r\n+  const abrirMenu = () => {\r\n     nav.classList.add(\"activo\");\r\n     overlayMenu.classList.add(\"activo\");\r\n-  }\r\n+  };\r\n \r\n   // Cerrar menú lateral\r\n-  function cerrarMenuLateral() {\r\n+  const cerrarMenuLateral = () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n-  }\r\n+  };\r\n \r\n-  // Botones de abrir/cerrar\r\n-  menuToggle?.addEventListener(\"click\", () => nav.classList.contains(\"activo\") ? cerrarMenuLateral() : abrirMenu());\r\n+  // Eventos de apertura/cierre\r\n+  menuToggle?.addEventListener(\"click\", abrirMenu);\r\n   closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n \r\n   // Mostrar productos por subcategoría\r\n-  function mostrarProductosPorSubcategoria(id) {\r\n+  const mostrarProductosPorSubcategoria = (id) => {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n-\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n     if (!filtrados.length) {\r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n       return;\r\n     }\r\n-\r\n     filtrados.forEach(prod => {\r\n       const precioMostrado = prod.precio_con_descuento ?? prod.precio;\r\n       const card = document.createElement(\"div\");\r\n       card.className = \"producto-card\";\r\n       card.innerHTML = `\r\n         <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n         <h3>${prod.nombre}</h3>\r\n         <p>${prod.descripcion || \"\"}</p>\r\n-        <span class=\"precio\">S/ ${Number(precioMostrado || 0).toFixed(2)}</span>\r\n+        <span class=\"precio\">S/ ${Number(precioMostrado).toFixed(2)}</span>\r\n         <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n+    contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n+  };\r\n \r\n-    contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n-  }\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // Construir menú dinámicamente desde JSON\r\n-  function buildMenuFromData(categorias) {\r\n+  // Construir menú desde JSON\r\n+  const buildMenuFromData = (categorias) => {\r\n     menuCategorias.innerHTML = \"\";\r\n-\r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       li.className = \"categoria-item\";\r\n-\r\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\";\r\n       a.textContent = cat.nombre;\r\n       li.appendChild(a);\r\n \r\n       if (cat.subcategorias?.length) {\r\n         const ulSub = document.createElement(\"ul\");\r\n-\r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\";\r\n           aSub.textContent = sub.nombre;\r\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n-\r\n-            // Mostrar productos filtrados\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n-\r\n-            // Limpiar clases activas\r\n             menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-\r\n-            li.classList.add(\"active\");    // categoría padre\r\n-            liSub.classList.add(\"active\"); // subcategoría\r\n-\r\n-            // Cerrar menú lateral al seleccionar subcategoría\r\n-            cerrarMenuLateral();\r\n+            li.classList.add(\"active\");\r\n+            liSub.classList.add(\"active\");\r\n+            cerrarMenuLateral(); // ✅ Cierra menú al seleccionar subcategoría\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n-\r\n         li.appendChild(ulSub);\r\n \r\n-        // Toggle de subcategoría al hacer clic en la categoría padre\r\n+        // Toggle subcategoría al hacer clic en categoría\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-\r\n-          // Cerrar otras categorías abiertas\r\n-          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => {\r\n-            if (liAct !== li) liAct.classList.remove(\"active\");\r\n-          });\r\n-\r\n-          li.classList.toggle(\"active\");\r\n+          const abierto = li.classList.contains(\"active\");\r\n+          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+          if (!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n     });\r\n-  }\r\n+  };\r\n \r\n-  // Cargar productos desde JSON\r\n+  // Cargar productos JSON\r\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n       productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n       buildMenuFromData(data.categorias || []);\r\n-      log(\"Menú cargado con \" + (data.categorias?.length || 0) + \" categorías\");\r\n+      console.log(\"Menú cargado correctamente\");\r\n     })\r\n-    .catch(e => err(\"Error cargando productos.json:\", e));\r\n+    .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759174536645,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,110 +3,83 @@\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n-  const contenedorProductos = document.getElementById(\"catalogo\"); // Contenedor de productos\r\n+  const contenedorProductos = document.getElementById(\"catalogo\");\r\n   let productosGlobal = [];\r\n \r\n-  if (!menuCategorias) return;\r\n-\r\n-  // Abrir menú lateral\r\n-  const abrirMenu = () => {\r\n-    nav.classList.add(\"activo\");\r\n-    overlayMenu.classList.add(\"activo\");\r\n-  };\r\n-\r\n-  // Cerrar menú lateral\r\n-  const cerrarMenuLateral = () => {\r\n+  const abrirMenu = () => { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); };\r\n+  const cerrarMenu = () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   };\r\n \r\n-  // Eventos de apertura/cierre\r\n   menuToggle?.addEventListener(\"click\", abrirMenu);\r\n-  closeMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n-  overlayMenu?.addEventListener(\"click\", cerrarMenuLateral);\r\n+  closeMenu?.addEventListener(\"click\", cerrarMenu);\r\n+  overlayMenu?.addEventListener(\"click\", cerrarMenu);\r\n \r\n-  // Mostrar productos por subcategoría\r\n   const mostrarProductosPorSubcategoria = (id) => {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n-    if (!filtrados.length) {\r\n-      contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-      return;\r\n-    }\r\n+    if (!filtrados.length) { contenedorProductos.innerHTML=\"<p>No hay productos en esta subcategoría.</p>\"; return; }\r\n     filtrados.forEach(prod => {\r\n-      const precioMostrado = prod.precio_con_descuento ?? prod.precio;\r\n+      const precio = prod.precio_con_descuento ?? prod.precio;\r\n       const card = document.createElement(\"div\");\r\n-      card.className = \"producto-card\";\r\n-      card.innerHTML = `\r\n-        <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+      card.className=\"producto-card\";\r\n+      card.innerHTML=`<img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n         <h3>${prod.nombre}</h3>\r\n         <p>${prod.descripcion || \"\"}</p>\r\n-        <span class=\"precio\">S/ ${Number(precioMostrado).toFixed(2)}</span>\r\n-        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n-      `;\r\n+        <span class=\"precio\">S/ ${Number(precio).toFixed(2)}</span>\r\n+        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>`;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n-    contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n+    contenedorProductos.scrollIntoView({behavior:\"smooth\"});\r\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // Construir menú desde JSON\r\n   const buildMenuFromData = (categorias) => {\r\n     menuCategorias.innerHTML = \"\";\r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n-      li.className = \"categoria-item\";\r\n       const a = document.createElement(\"a\");\r\n-      a.href = \"#\";\r\n-      a.textContent = cat.nombre;\r\n-      li.appendChild(a);\r\n+      a.href=\"#\"; a.textContent=cat.nombre; li.appendChild(a);\r\n \r\n-      if (cat.subcategorias?.length) {\r\n+      if(cat.subcategorias?.length){\r\n         const ulSub = document.createElement(\"ul\");\r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n-          aSub.href = \"#\";\r\n-          aSub.textContent = sub.nombre;\r\n-\r\n-          aSub.addEventListener(\"click\", e => {\r\n+          aSub.href=\"#\"; aSub.textContent=sub.nombre;\r\n+          aSub.addEventListener(\"click\", e=>{\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n-            menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-            li.classList.add(\"active\");\r\n-            liSub.classList.add(\"active\");\r\n-            cerrarMenuLateral(); // ✅ Cierra menú al seleccionar subcategoría\r\n+            menuCategorias.querySelectorAll(\"li.active\").forEach(liAct=>liAct.classList.remove(\"active\"));\r\n+            li.classList.add(\"active\"); liSub.classList.add(\"active\");\r\n+            cerrarMenu();\r\n           });\r\n-\r\n-          liSub.appendChild(aSub);\r\n-          ulSub.appendChild(liSub);\r\n+          liSub.appendChild(aSub); ulSub.appendChild(liSub);\r\n         });\r\n         li.appendChild(ulSub);\r\n \r\n-        // Toggle subcategoría al hacer clic en categoría\r\n-        a.addEventListener(\"click\", e => {\r\n+        a.addEventListener(\"click\", e=>{\r\n           e.preventDefault();\r\n           const abierto = li.classList.contains(\"active\");\r\n-          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-          if (!abierto) li.classList.add(\"active\");\r\n+          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct=>liAct.classList.remove(\"active\"));\r\n+          if(!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n-\r\n       menuCategorias.appendChild(li);\r\n     });\r\n   };\r\n \r\n-  // Cargar productos JSON\r\n   fetch(\"productos.json\")\r\n-    .then(resp => resp.json())\r\n-    .then(data => {\r\n-      productosGlobal = [...(data.productos || []), ...(data.ofertas || [])];\r\n-      buildMenuFromData(data.categorias || []);\r\n+    .then(resp=>resp.json())\r\n+    .then(data=>{\r\n+      productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n+      buildMenuFromData(data.categorias||[]);\r\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n-    .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n+    .catch(e=>console.error(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759175063904,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,13 @@\n   const menuCategorias = document.getElementById('menu-categorias');\r\n   const contenedorProductos = document.getElementById(\"catalogo\");\r\n   let productosGlobal = [];\r\n \r\n-  const abrirMenu = () => { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); };\r\n+  const abrirMenu = () => { \r\n+    nav.classList.add(\"activo\"); \r\n+    overlayMenu.classList.add(\"activo\"); \r\n+  };\r\n+  \r\n   const cerrarMenu = () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n@@ -20,22 +24,34 @@\n \r\n   const mostrarProductosPorSubcategoria = (id) => {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n+\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n-    if (!filtrados.length) { contenedorProductos.innerHTML=\"<p>No hay productos en esta subcategoría.</p>\"; return; }\r\n+    if (!filtrados.length) {\r\n+      contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n+      return;\r\n+    }\r\n+\r\n     filtrados.forEach(prod => {\r\n       const precio = prod.precio_con_descuento ?? prod.precio;\r\n       const card = document.createElement(\"div\");\r\n-      card.className=\"producto-card\";\r\n-      card.innerHTML=`<img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+      card.className = \"producto-card\";\r\n+      card.innerHTML = `\r\n+        <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n         <h3>${prod.nombre}</h3>\r\n         <p>${prod.descripcion || \"\"}</p>\r\n         <span class=\"precio\">S/ ${Number(precio).toFixed(2)}</span>\r\n-        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>`;\r\n+        <button class=\"btn-agregar\" onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+      `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n-    contenedorProductos.scrollIntoView({behavior:\"smooth\"});\r\n+\r\n+    // Scroll automático hacia la sección de productos\r\n+    contenedorProductos.scrollIntoView({behavior: \"smooth\", block: \"start\"});\r\n+\r\n+    // Cerrar menú lateral\r\n+    cerrarMenu();\r\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n@@ -43,43 +59,55 @@\n     menuCategorias.innerHTML = \"\";\r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       const a = document.createElement(\"a\");\r\n-      a.href=\"#\"; a.textContent=cat.nombre; li.appendChild(a);\r\n+      a.href = \"#\"; \r\n+      a.textContent = cat.nombre; \r\n+      li.appendChild(a);\r\n \r\n       if(cat.subcategorias?.length){\r\n         const ulSub = document.createElement(\"ul\");\r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n-          aSub.href=\"#\"; aSub.textContent=sub.nombre;\r\n-          aSub.addEventListener(\"click\", e=>{\r\n+          aSub.href = \"#\"; \r\n+          aSub.textContent = sub.nombre;\r\n+\r\n+          aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n-            menuCategorias.querySelectorAll(\"li.active\").forEach(liAct=>liAct.classList.remove(\"active\"));\r\n-            li.classList.add(\"active\"); liSub.classList.add(\"active\");\r\n-            cerrarMenu();\r\n+\r\n+            // Activar la categoría padre y la subcategoría seleccionada\r\n+            menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+            li.classList.add(\"active\");\r\n+            liSub.classList.add(\"active\");\r\n           });\r\n-          liSub.appendChild(aSub); ulSub.appendChild(liSub);\r\n+\r\n+          liSub.appendChild(aSub);\r\n+          ulSub.appendChild(liSub);\r\n         });\r\n+\r\n         li.appendChild(ulSub);\r\n \r\n-        a.addEventListener(\"click\", e=>{\r\n+        // Toggle para abrir/cerrar categoría\r\n+        a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           const abierto = li.classList.contains(\"active\");\r\n-          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct=>liAct.classList.remove(\"active\"));\r\n+          // Cerrar otras categorías\r\n+          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n           if(!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n+\r\n       menuCategorias.appendChild(li);\r\n     });\r\n   };\r\n \r\n   fetch(\"productos.json\")\r\n-    .then(resp=>resp.json())\r\n-    .then(data=>{\r\n+    .then(resp => resp.json())\r\n+    .then(data => {\r\n       productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n       buildMenuFromData(data.categorias||[]);\r\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n-    .catch(e=>console.error(\"Error cargando productos.json:\", e));\r\n+    .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759175576392,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,9 +10,8 @@\n   const abrirMenu = () => { \r\n     nav.classList.add(\"activo\"); \r\n     overlayMenu.classList.add(\"activo\"); \r\n   };\r\n-  \r\n   const cerrarMenu = () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n@@ -24,34 +23,25 @@\n \r\n   const mostrarProductosPorSubcategoria = (id) => {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n-\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n-    if (!filtrados.length) {\r\n-      contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\";\r\n-      return;\r\n+    if (!filtrados.length) { \r\n+      contenedorProductos.innerHTML=\"<p>No hay productos en esta subcategoría.</p>\"; \r\n+      return; \r\n     }\r\n-\r\n     filtrados.forEach(prod => {\r\n       const precio = prod.precio_con_descuento ?? prod.precio;\r\n       const card = document.createElement(\"div\");\r\n-      card.className = \"producto-card\";\r\n-      card.innerHTML = `\r\n-        <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+      card.className=\"producto-card\";\r\n+      card.innerHTML=`<img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n         <h3>${prod.nombre}</h3>\r\n         <p>${prod.descripcion || \"\"}</p>\r\n         <span class=\"precio\">S/ ${Number(precio).toFixed(2)}</span>\r\n-        <button class=\"btn-agregar\" onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n-      `;\r\n+        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>`;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n-\r\n-    // Scroll automático hacia la sección de productos\r\n-    contenedorProductos.scrollIntoView({behavior: \"smooth\", block: \"start\"});\r\n-\r\n-    // Cerrar menú lateral\r\n-    cerrarMenu();\r\n+    contenedorProductos.scrollIntoView({behavior:\"smooth\"});\r\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n@@ -59,55 +49,48 @@\n     menuCategorias.innerHTML = \"\";\r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       const a = document.createElement(\"a\");\r\n-      a.href = \"#\"; \r\n-      a.textContent = cat.nombre; \r\n-      li.appendChild(a);\r\n+      a.href=\"#\"; a.textContent=cat.nombre; li.appendChild(a);\r\n \r\n       if(cat.subcategorias?.length){\r\n         const ulSub = document.createElement(\"ul\");\r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n-          aSub.href = \"#\"; \r\n-          aSub.textContent = sub.nombre;\r\n+          aSub.href=\"#\"; aSub.textContent=sub.nombre;\r\n \r\n-          aSub.addEventListener(\"click\", e => {\r\n+          // Click en subcategoría\r\n+          aSub.addEventListener(\"click\", e=>{\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n-\r\n-            // Activar la categoría padre y la subcategoría seleccionada\r\n-            menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-            li.classList.add(\"active\");\r\n+            menuCategorias.querySelectorAll(\"li.active\").forEach(liAct=>liAct.classList.remove(\"active\"));\r\n+            li.classList.add(\"active\"); \r\n             liSub.classList.add(\"active\");\r\n+            cerrarMenu();\r\n           });\r\n \r\n-          liSub.appendChild(aSub);\r\n-          ulSub.appendChild(liSub);\r\n+          liSub.appendChild(aSub); ulSub.appendChild(liSub);\r\n         });\r\n-\r\n         li.appendChild(ulSub);\r\n \r\n-        // Toggle para abrir/cerrar categoría\r\n-        a.addEventListener(\"click\", e => {\r\n+        // Click en categoría\r\n+        a.addEventListener(\"click\", e=>{\r\n           e.preventDefault();\r\n           const abierto = li.classList.contains(\"active\");\r\n-          // Cerrar otras categorías\r\n-          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct=>liAct.classList.remove(\"active\"));\r\n           if(!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n-\r\n       menuCategorias.appendChild(li);\r\n     });\r\n   };\r\n \r\n   fetch(\"productos.json\")\r\n-    .then(resp => resp.json())\r\n-    .then(data => {\r\n+    .then(resp=>resp.json())\r\n+    .then(data=>{\r\n       productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n       buildMenuFromData(data.categorias||[]);\r\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n-    .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n+    .catch(e=>console.error(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759175801106,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,12 +6,10 @@\n   const menuCategorias = document.getElementById('menu-categorias');\r\n   const contenedorProductos = document.getElementById(\"catalogo\");\r\n   let productosGlobal = [];\r\n \r\n-  const abrirMenu = () => { \r\n-    nav.classList.add(\"activo\"); \r\n-    overlayMenu.classList.add(\"activo\"); \r\n-  };\r\n+  // Abrir / cerrar menú lateral\r\n+  const abrirMenu = () => { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); };\r\n   const cerrarMenu = () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n@@ -20,77 +18,97 @@\n   menuToggle?.addEventListener(\"click\", abrirMenu);\r\n   closeMenu?.addEventListener(\"click\", cerrarMenu);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenu);\r\n \r\n+  // Mostrar productos filtrados por subcategoría\r\n   const mostrarProductosPorSubcategoria = (id) => {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n     if (!filtrados.length) { \r\n-      contenedorProductos.innerHTML=\"<p>No hay productos en esta subcategoría.</p>\"; \r\n+      contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\"; \r\n       return; \r\n     }\r\n+\r\n     filtrados.forEach(prod => {\r\n       const precio = prod.precio_con_descuento ?? prod.precio;\r\n       const card = document.createElement(\"div\");\r\n-      card.className=\"producto-card\";\r\n-      card.innerHTML=`<img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n+      card.className = \"producto-card\";\r\n+      card.innerHTML = `\r\n+        <img src=\"${prod.img}\" alt=\"${prod.nombre}\">\r\n         <h3>${prod.nombre}</h3>\r\n         <p>${prod.descripcion || \"\"}</p>\r\n         <span class=\"precio\">S/ ${Number(precio).toFixed(2)}</span>\r\n-        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>`;\r\n+        <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n+      `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n-    contenedorProductos.scrollIntoView({behavior:\"smooth\"});\r\n+\r\n+    // Auto-scroll al contenedor\r\n+    contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n+  // Construir menú dinámico\r\n   const buildMenuFromData = (categorias) => {\r\n     menuCategorias.innerHTML = \"\";\r\n+\r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       const a = document.createElement(\"a\");\r\n-      a.href=\"#\"; a.textContent=cat.nombre; li.appendChild(a);\r\n+      a.href = \"#\"; \r\n+      a.textContent = cat.nombre;\r\n+      li.appendChild(a);\r\n \r\n       if(cat.subcategorias?.length){\r\n         const ulSub = document.createElement(\"ul\");\r\n+\r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n-          aSub.href=\"#\"; aSub.textContent=sub.nombre;\r\n+          aSub.href = \"#\"; \r\n+          aSub.textContent = sub.nombre;\r\n \r\n-          // Click en subcategoría\r\n-          aSub.addEventListener(\"click\", e=>{\r\n+          // Clic en subcategoría → mostrar productos y cerrar menú\r\n+          aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n-            menuCategorias.querySelectorAll(\"li.active\").forEach(liAct=>liAct.classList.remove(\"active\"));\r\n-            li.classList.add(\"active\"); \r\n+\r\n+            // Limpiar clases activas\r\n+            menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+            li.classList.add(\"active\"); // Mantener categoría abierta si quieres\r\n             liSub.classList.add(\"active\");\r\n-            cerrarMenu();\r\n+\r\n+            cerrarMenu(); // Cierra menú lateral\r\n           });\r\n \r\n-          liSub.appendChild(aSub); ulSub.appendChild(liSub);\r\n+          liSub.appendChild(aSub);\r\n+          ulSub.appendChild(liSub);\r\n         });\r\n+\r\n         li.appendChild(ulSub);\r\n \r\n-        // Click en categoría\r\n-        a.addEventListener(\"click\", e=>{\r\n+        // Toggle categoría al hacer clic\r\n+        a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           const abierto = li.classList.contains(\"active\");\r\n-          menuCategorias.querySelectorAll(\":scope > li.active\").forEach(liAct=>liAct.classList.remove(\"active\"));\r\n+          // Cerrar todas las demás categorías\r\n+          menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n           if(!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n+\r\n       menuCategorias.appendChild(li);\r\n     });\r\n   };\r\n \r\n+  // Cargar JSON\r\n   fetch(\"productos.json\")\r\n-    .then(resp=>resp.json())\r\n-    .then(data=>{\r\n+    .then(resp => resp.json())\r\n+    .then(data => {\r\n       productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n       buildMenuFromData(data.categorias||[]);\r\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n-    .catch(e=>console.error(\"Error cargando productos.json:\", e));\r\n+    .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n });\r\n"
                },
                {
                    "date": 1759176019265,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,12 +7,16 @@\n   const contenedorProductos = document.getElementById(\"catalogo\");\r\n   let productosGlobal = [];\r\n \r\n   // Abrir / cerrar menú lateral\r\n-  const abrirMenu = () => { nav.classList.add(\"activo\"); overlayMenu.classList.add(\"activo\"); };\r\n+  const abrirMenu = () => { \r\n+    nav.classList.add(\"activo\"); \r\n+    overlayMenu.classList.add(\"activo\"); \r\n+  };\r\n   const cerrarMenu = () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n+    // Limpiar clases activas al cerrar menú\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   };\r\n \r\n   menuToggle?.addEventListener(\"click\", abrirMenu);\r\n@@ -42,9 +46,9 @@\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n \r\n-    // Auto-scroll al contenedor\r\n+    // Auto-scroll al contenedor de productos\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n@@ -73,11 +77,13 @@\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            // Limpiar clases activas\r\n+            // Limpiar todas las clases activas\r\n             menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-            li.classList.add(\"active\"); // Mantener categoría abierta si quieres\r\n+            \r\n+            // Marcar la categoría y subcategoría como activas\r\n+            li.classList.add(\"active\"); \r\n             liSub.classList.add(\"active\");\r\n \r\n             cerrarMenu(); // Cierra menú lateral\r\n           });\r\n"
                },
                {
                    "date": 1759298090737,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,11 @@\n   const menuCategorias = document.getElementById('menu-categorias');\r\n   const contenedorProductos = document.getElementById(\"catalogo\");\r\n   let productosGlobal = [];\r\n \r\n+  // =====================================================\r\n   // Abrir / cerrar menú lateral\r\n+  // =====================================================\r\n   const abrirMenu = () => { \r\n     nav.classList.add(\"activo\"); \r\n     overlayMenu.classList.add(\"activo\"); \r\n   };\r\n@@ -22,9 +24,11 @@\n   menuToggle?.addEventListener(\"click\", abrirMenu);\r\n   closeMenu?.addEventListener(\"click\", cerrarMenu);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenu);\r\n \r\n+  // =====================================================\r\n   // Mostrar productos filtrados por subcategoría\r\n+  // =====================================================\r\n   const mostrarProductosPorSubcategoria = (id) => {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n@@ -52,9 +56,11 @@\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n+  // =====================================================\r\n   // Construir menú dinámico\r\n+  // =====================================================\r\n   const buildMenuFromData = (categorias) => {\r\n     menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n@@ -107,14 +113,39 @@\n       menuCategorias.appendChild(li);\r\n     });\r\n   };\r\n \r\n+  // =====================================================\r\n   // Cargar JSON\r\n+  // =====================================================\r\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n       productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n       buildMenuFromData(data.categorias||[]);\r\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n+\r\n+  // =====================================================\r\n+  // Ocultar promo-bar y top-bar al hacer scroll\r\n+  // =====================================================\r\n+  let lastScroll = 0;\r\n+  const promoBar = document.querySelector(\".promo-bar\");\r\n+  const topBar = document.getElementById(\"top-bar\");\r\n+\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+\r\n+    if (currentScroll > lastScroll && currentScroll > 50) {\r\n+      // 🔽 Bajando scroll → ocultar\r\n+      promoBar?.classList.add(\"oculto\");\r\n+      topBar?.classList.add(\"oculto\");\r\n+    } else {\r\n+      // 🔼 Subiendo scroll → mostrar\r\n+      promoBar?.classList.remove(\"oculto\");\r\n+      topBar?.classList.remove(\"oculto\");\r\n+    }\r\n+\r\n+    lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n+  });\r\n });\r\n"
                },
                {
                    "date": 1759298946427,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,16 +1,24 @@\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n+  // =========================\r\n+  // ELEMENTOS PRINCIPALES\r\n+  // =========================\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n   const contenedorProductos = document.getElementById(\"catalogo\");\r\n+  const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo\r\n+  const topBar = document.querySelector(\".top-bar\");     // Barra superior\r\n+  const header = document.querySelector(\".main-header\"); // Header principal\r\n+  const body = document.body;\r\n+\r\n   let productosGlobal = [];\r\n \r\n-  // =====================================================\r\n+  // =========================\r\n   // Abrir / cerrar menú lateral\r\n-  // =====================================================\r\n+  // =========================\r\n   const abrirMenu = () => { \r\n     nav.classList.add(\"activo\"); \r\n     overlayMenu.classList.add(\"activo\"); \r\n   };\r\n@@ -24,11 +32,11 @@\n   menuToggle?.addEventListener(\"click\", abrirMenu);\r\n   closeMenu?.addEventListener(\"click\", cerrarMenu);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenu);\r\n \r\n-  // =====================================================\r\n+  // =========================\r\n   // Mostrar productos filtrados por subcategoría\r\n-  // =====================================================\r\n+  // =========================\r\n   const mostrarProductosPorSubcategoria = (id) => {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n@@ -50,17 +58,16 @@\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n \r\n-    // Auto-scroll al contenedor de productos\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // =====================================================\r\n+  // =========================\r\n   // Construir menú dinámico\r\n-  // =====================================================\r\n+  // =========================\r\n   const buildMenuFromData = (categorias) => {\r\n     menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n@@ -78,34 +85,29 @@\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\"; \r\n           aSub.textContent = sub.nombre;\r\n \r\n-          // Clic en subcategoría → mostrar productos y cerrar menú\r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            // Limpiar todas las clases activas\r\n             menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n             \r\n-            // Marcar la categoría y subcategoría como activas\r\n             li.classList.add(\"active\"); \r\n             liSub.classList.add(\"active\");\r\n \r\n-            cerrarMenu(); // Cierra menú lateral\r\n+            cerrarMenu();\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n \r\n         li.appendChild(ulSub);\r\n \r\n-        // Toggle categoría al hacer clic\r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           const abierto = li.classList.contains(\"active\");\r\n-          // Cerrar todas las demás categorías\r\n           menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n           if(!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n@@ -113,11 +115,11 @@\n       menuCategorias.appendChild(li);\r\n     });\r\n   };\r\n \r\n-  // =====================================================\r\n+  // =========================\r\n   // Cargar JSON\r\n-  // =====================================================\r\n+  // =========================\r\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n       productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n@@ -125,17 +127,15 @@\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n-  // =====================================================\r\n+  // =========================\r\n   // Ocultar promo-bar y top-bar al hacer scroll\r\n-  // =====================================================\r\n+  // =========================\r\n   let lastScroll = 0;\r\n-  const promoBar = document.querySelector(\".promo-bar\");\r\n-  const topBar = document.getElementById(\"top-bar\");\r\n \r\n   window.addEventListener(\"scroll\", () => {\r\n-    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+    const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n     if (currentScroll > lastScroll && currentScroll > 50) {\r\n       // 🔽 Bajando scroll → ocultar\r\n       promoBar?.classList.add(\"oculto\");\r\n"
                },
                {
                    "date": 1759299250268,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -116,36 +116,39 @@\n     });\r\n   };\r\n \r\n   // =========================\r\n-  // Cargar JSON\r\n-  // =========================\r\n-  fetch(\"productos.json\")\r\n-    .then(resp => resp.json())\r\n-    .then(data => {\r\n-      productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n-      buildMenuFromData(data.categorias||[]);\r\n-      console.log(\"Menú cargado correctamente\");\r\n-    })\r\n-    .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n+// Cargar JSON\r\n+// =========================\r\n+fetch(\"productos.json\")\r\n+  .then(resp => resp.json())\r\n+  .then(data => {\r\n+    productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n+    buildMenuFromData(data.categorias||[]);\r\n+    console.log(\"Menú cargado correctamente\");\r\n+  })\r\n+  .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n-  // =========================\r\n-  // Ocultar promo-bar y top-bar al hacer scroll\r\n-  // =========================\r\n-  let lastScroll = 0;\r\n+// =========================\r\n+// Ocultar promo-bar y top-bar al hacer scroll\r\n+// =========================\r\n+let lastScroll = 0;\r\n \r\n-  window.addEventListener(\"scroll\", () => {\r\n-    const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+window.addEventListener(\"scroll\", () => {\r\n+  const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-    if (currentScroll > lastScroll && currentScroll > 50) {\r\n-      // 🔽 Bajando scroll → ocultar\r\n-      promoBar?.classList.add(\"oculto\");\r\n-      topBar?.classList.add(\"oculto\");\r\n-    } else {\r\n-      // 🔼 Subiendo scroll → mostrar\r\n-      promoBar?.classList.remove(\"oculto\");\r\n-      topBar?.classList.remove(\"oculto\");\r\n-    }\r\n+  if (currentScroll > lastScroll && currentScroll > 50) {\r\n+    // 🔽 Bajando scroll → ocultar barras\r\n+    promoBar?.classList.add(\"oculto\");\r\n+    topBar?.classList.add(\"oculto\");\r\n+    header.style.top = \"0\";       // Header sube al top\r\n+    body.style.paddingTop = \"0\";   // Quitar espacio extra si hay padding\r\n+  } else {\r\n+    // 🔼 Subiendo scroll → mostrar barras\r\n+    promoBar?.classList.remove(\"oculto\");\r\n+    topBar?.classList.remove(\"oculto\");\r\n+    header.style.top = \"72px\";     // Ajustar según altura combinada de barras\r\n+    body.style.paddingTop = \"72px\"; // Mantener espacio si quieres que no tape contenido\r\n+  }\r\n \r\n-    lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n-  });\r\n+  lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n });\r\n"
                },
                {
                    "date": 1759299367152,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,9 @@\n-document.addEventListener(\"DOMContentLoaded\", () => {\r\n+\r\n   // =========================\r\n   // ELEMENTOS PRINCIPALES\r\n   // =========================\r\n+document.addEventListener(\"DOMContentLoaded\", () => {\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n@@ -14,11 +15,11 @@\n   const body = document.body;\r\n \r\n   let productosGlobal = [];\r\n \r\n-  // =========================\r\n+  // =====================================================\r\n   // Abrir / cerrar menú lateral\r\n-  // =========================\r\n+  // =====================================================\r\n   const abrirMenu = () => { \r\n     nav.classList.add(\"activo\"); \r\n     overlayMenu.classList.add(\"activo\"); \r\n   };\r\n@@ -32,11 +33,11 @@\n   menuToggle?.addEventListener(\"click\", abrirMenu);\r\n   closeMenu?.addEventListener(\"click\", cerrarMenu);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenu);\r\n \r\n-  // =========================\r\n+  // =====================================================\r\n   // Mostrar productos filtrados por subcategoría\r\n-  // =========================\r\n+  // =====================================================\r\n   const mostrarProductosPorSubcategoria = (id) => {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n@@ -58,16 +59,17 @@\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n \r\n+    // Auto-scroll al contenedor de productos\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // =========================\r\n+  // =====================================================\r\n   // Construir menú dinámico\r\n-  // =========================\r\n+  // =====================================================\r\n   const buildMenuFromData = (categorias) => {\r\n     menuCategorias.innerHTML = \"\";\r\n \r\n     categorias.forEach(cat => {\r\n@@ -89,14 +91,16 @@\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n+            // Limpiar todas las clases activas\r\n             menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n             \r\n+            // Marcar la categoría y subcategoría como activas\r\n             li.classList.add(\"active\"); \r\n             liSub.classList.add(\"active\");\r\n \r\n-            cerrarMenu();\r\n+            cerrarMenu(); // Cierra menú lateral\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n@@ -106,8 +110,9 @@\n \r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           const abierto = li.classList.contains(\"active\");\r\n+          // Cerrar todas las demás categorías\r\n           menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n           if(!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n@@ -115,40 +120,42 @@\n       menuCategorias.appendChild(li);\r\n     });\r\n   };\r\n \r\n-  // =========================\r\n-// Cargar JSON\r\n-// =========================\r\n-fetch(\"productos.json\")\r\n-  .then(resp => resp.json())\r\n-  .then(data => {\r\n-    productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n-    buildMenuFromData(data.categorias||[]);\r\n-    console.log(\"Menú cargado correctamente\");\r\n-  })\r\n-  .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n+  // =====================================================\r\n+  // Cargar JSON\r\n+  // =====================================================\r\n+  fetch(\"productos.json\")\r\n+    .then(resp => resp.json())\r\n+    .then(data => {\r\n+      productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n+      buildMenuFromData(data.categorias||[]);\r\n+      console.log(\"Menú cargado correctamente\");\r\n+    })\r\n+    .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n-// =========================\r\n-// Ocultar promo-bar y top-bar al hacer scroll\r\n-// =========================\r\n-let lastScroll = 0;\r\n+  // =====================================================\r\n+  // Ocultar promo-bar y top-bar al hacer scroll\r\n+  // =====================================================\r\n+  let lastScroll = 0;\r\n \r\n-window.addEventListener(\"scroll\", () => {\r\n-  const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-  if (currentScroll > lastScroll && currentScroll > 50) {\r\n-    // 🔽 Bajando scroll → ocultar barras\r\n-    promoBar?.classList.add(\"oculto\");\r\n-    topBar?.classList.add(\"oculto\");\r\n-    header.style.top = \"0\";       // Header sube al top\r\n-    body.style.paddingTop = \"0\";   // Quitar espacio extra si hay padding\r\n-  } else {\r\n-    // 🔼 Subiendo scroll → mostrar barras\r\n-    promoBar?.classList.remove(\"oculto\");\r\n-    topBar?.classList.remove(\"oculto\");\r\n-    header.style.top = \"72px\";     // Ajustar según altura combinada de barras\r\n-    body.style.paddingTop = \"72px\"; // Mantener espacio si quieres que no tape contenido\r\n-  }\r\n+    if (currentScroll > lastScroll && currentScroll > 50) {\r\n+      // 🔽 Bajando scroll → ocultar barras\r\n+      promoBar?.classList.add(\"oculto\");\r\n+      topBar?.classList.add(\"oculto\");\r\n+      header.style.top = \"0\";       // Header sube al top\r\n+      body.style.paddingTop = \"0\";   // Quitar espacio extra\r\n+    } else {\r\n+      // 🔼 Subiendo scroll → mostrar barras\r\n+      promoBar?.classList.remove(\"oculto\");\r\n+      topBar?.classList.remove(\"oculto\");\r\n+      header.style.top = \"72px\";     // Ajustar según altura combinada de barras\r\n+      body.style.paddingTop = \"72px\"; // Mantener espacio si quieres que no tape contenido\r\n+    }\r\n \r\n-  lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n-});\r\n+    lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n+  });\r\n+\r\n+}); // 🔹 Cierre correcto de DOMContentLoaded\r\n"
                },
                {
                    "date": 1759300194710,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,7 @@\n-\r\n-  // =========================\r\n-  // ELEMENTOS PRINCIPALES\r\n-  // =========================\r\n+// =========================\r\n+// ELEMENTOS PRINCIPALES\r\n+// =========================\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n@@ -11,13 +10,28 @@\n   const contenedorProductos = document.getElementById(\"catalogo\");\r\n   const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo\r\n   const topBar = document.querySelector(\".top-bar\");     // Barra superior\r\n   const header = document.querySelector(\".main-header\"); // Header principal\r\n+  const banner = document.getElementById(\"banner-carrusel\"); // Carrusel principal\r\n   const body = document.body;\r\n \r\n   let productosGlobal = [];\r\n \r\n   // =====================================================\r\n+  // Función para ajustar padding superior según altura de barras\r\n+  // =====================================================\r\n+  const ajustarPaddingHeader = () => {\r\n+    const totalAltura = (promoBar?.offsetHeight || 0) +\r\n+                        (topBar?.offsetHeight || 0) +\r\n+                        (header?.offsetHeight || 0);\r\n+    body.style.paddingTop = totalAltura + \"px\";\r\n+    if (banner) banner.style.marginTop = totalAltura + \"px\";\r\n+  };\r\n+\r\n+  ajustarPaddingHeader(); // Se aplica al cargar la página\r\n+  window.addEventListener(\"resize\", ajustarPaddingHeader); // Se recalcula al redimensionar ventana\r\n+\r\n+  // =====================================================\r\n   // Abrir / cerrar menú lateral\r\n   // =====================================================\r\n   const abrirMenu = () => { \r\n     nav.classList.add(\"activo\"); \r\n@@ -25,9 +39,8 @@\n   };\r\n   const cerrarMenu = () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n-    // Limpiar clases activas al cerrar menú\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   };\r\n \r\n   menuToggle?.addEventListener(\"click\", abrirMenu);\r\n@@ -59,9 +72,8 @@\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n \r\n-    // Auto-scroll al contenedor de productos\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n@@ -70,9 +82,8 @@\n   // Construir menú dinámico\r\n   // =====================================================\r\n   const buildMenuFromData = (categorias) => {\r\n     menuCategorias.innerHTML = \"\";\r\n-\r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\"; \r\n@@ -80,9 +91,8 @@\n       li.appendChild(a);\r\n \r\n       if(cat.subcategorias?.length){\r\n         const ulSub = document.createElement(\"ul\");\r\n-\r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\"; \r\n@@ -90,29 +100,22 @@\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n-\r\n-            // Limpiar todas las clases activas\r\n             menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-            \r\n-            // Marcar la categoría y subcategoría como activas\r\n             li.classList.add(\"active\"); \r\n             liSub.classList.add(\"active\");\r\n-\r\n-            cerrarMenu(); // Cierra menú lateral\r\n+            cerrarMenu();\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n-\r\n         li.appendChild(ulSub);\r\n \r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           const abierto = li.classList.contains(\"active\");\r\n-          // Cerrar todas las demás categorías\r\n           menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n           if(!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n@@ -136,26 +139,20 @@\n   // =====================================================\r\n   // Ocultar promo-bar y top-bar al hacer scroll\r\n   // =====================================================\r\n   let lastScroll = 0;\r\n-\r\n   window.addEventListener(\"scroll\", () => {\r\n     const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n     if (currentScroll > lastScroll && currentScroll > 50) {\r\n-      // 🔽 Bajando scroll → ocultar barras\r\n       promoBar?.classList.add(\"oculto\");\r\n       topBar?.classList.add(\"oculto\");\r\n-      header.style.top = \"0\";       // Header sube al top\r\n-      body.style.paddingTop = \"0\";   // Quitar espacio extra\r\n     } else {\r\n-      // 🔼 Subiendo scroll → mostrar barras\r\n       promoBar?.classList.remove(\"oculto\");\r\n       topBar?.classList.remove(\"oculto\");\r\n-      header.style.top = \"72px\";     // Ajustar según altura combinada de barras\r\n-      body.style.paddingTop = \"72px\"; // Mantener espacio si quieres que no tape contenido\r\n     }\r\n \r\n     lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n+    ajustarPaddingHeader(); // Ajusta el padding dinámicamente mientras se hace scroll\r\n   });\r\n \r\n-}); // 🔹 Cierre correcto de DOMContentLoaded\r\n+}); // 🔹 Cierre de DOMContentLoaded\r\n"
                },
                {
                    "date": 1759300507662,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,8 @@\n-// =========================\r\n-// ELEMENTOS PRINCIPALES\r\n-// =========================\r\n+\r\n+  // =========================\r\n+  // ELEMENTOS PRINCIPALES\r\n+  // =========================\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n@@ -10,28 +11,13 @@\n   const contenedorProductos = document.getElementById(\"catalogo\");\r\n   const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo\r\n   const topBar = document.querySelector(\".top-bar\");     // Barra superior\r\n   const header = document.querySelector(\".main-header\"); // Header principal\r\n-  const banner = document.getElementById(\"banner-carrusel\"); // Carrusel principal\r\n   const body = document.body;\r\n \r\n   let productosGlobal = [];\r\n \r\n   // =====================================================\r\n-  // Función para ajustar padding superior según altura de barras\r\n-  // =====================================================\r\n-  const ajustarPaddingHeader = () => {\r\n-    const totalAltura = (promoBar?.offsetHeight || 0) +\r\n-                        (topBar?.offsetHeight || 0) +\r\n-                        (header?.offsetHeight || 0);\r\n-    body.style.paddingTop = totalAltura + \"px\";\r\n-    if (banner) banner.style.marginTop = totalAltura + \"px\";\r\n-  };\r\n-\r\n-  ajustarPaddingHeader(); // Se aplica al cargar la página\r\n-  window.addEventListener(\"resize\", ajustarPaddingHeader); // Se recalcula al redimensionar ventana\r\n-\r\n-  // =====================================================\r\n   // Abrir / cerrar menú lateral\r\n   // =====================================================\r\n   const abrirMenu = () => { \r\n     nav.classList.add(\"activo\"); \r\n@@ -39,8 +25,9 @@\n   };\r\n   const cerrarMenu = () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n+    // Limpiar clases activas al cerrar menú\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   };\r\n \r\n   menuToggle?.addEventListener(\"click\", abrirMenu);\r\n@@ -72,8 +59,9 @@\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n \r\n+    // Auto-scroll al contenedor de productos\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n@@ -82,8 +70,9 @@\n   // Construir menú dinámico\r\n   // =====================================================\r\n   const buildMenuFromData = (categorias) => {\r\n     menuCategorias.innerHTML = \"\";\r\n+\r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\"; \r\n@@ -91,8 +80,9 @@\n       li.appendChild(a);\r\n \r\n       if(cat.subcategorias?.length){\r\n         const ulSub = document.createElement(\"ul\");\r\n+\r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\"; \r\n@@ -100,22 +90,29 @@\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n+\r\n+            // Limpiar todas las clases activas\r\n             menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+            \r\n+            // Marcar la categoría y subcategoría como activas\r\n             li.classList.add(\"active\"); \r\n             liSub.classList.add(\"active\");\r\n-            cerrarMenu();\r\n+\r\n+            cerrarMenu(); // Cierra menú lateral\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n+\r\n         li.appendChild(ulSub);\r\n \r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           const abierto = li.classList.contains(\"active\");\r\n+          // Cerrar todas las demás categorías\r\n           menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n           if(!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n@@ -139,20 +136,26 @@\n   // =====================================================\r\n   // Ocultar promo-bar y top-bar al hacer scroll\r\n   // =====================================================\r\n   let lastScroll = 0;\r\n+\r\n   window.addEventListener(\"scroll\", () => {\r\n     const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n     if (currentScroll > lastScroll && currentScroll > 50) {\r\n+      // 🔽 Bajando scroll → ocultar barras\r\n       promoBar?.classList.add(\"oculto\");\r\n       topBar?.classList.add(\"oculto\");\r\n+      header.style.top = \"0\";       // Header sube al top\r\n+      body.style.paddingTop = \"0\";   // Quitar espacio extra\r\n     } else {\r\n+      // 🔼 Subiendo scroll → mostrar barras\r\n       promoBar?.classList.remove(\"oculto\");\r\n       topBar?.classList.remove(\"oculto\");\r\n+      header.style.top = \"72px\";     // Ajustar según altura combinada de barras\r\n+      body.style.paddingTop = \"72px\"; // Mantener espacio si quieres que no tape contenido\r\n     }\r\n \r\n     lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n-    ajustarPaddingHeader(); // Ajusta el padding dinámicamente mientras se hace scroll\r\n   });\r\n \r\n-}); // 🔹 Cierre de DOMContentLoaded\r\n+}); // 🔹 Cierre correcto de DOMContentLoaded\r\n"
                },
                {
                    "date": 1759847664096,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -150,10 +150,10 @@\n     } else {\r\n       // 🔼 Subiendo scroll → mostrar barras\r\n       promoBar?.classList.remove(\"oculto\");\r\n       topBar?.classList.remove(\"oculto\");\r\n-      header.style.top = \"72px\";     // Ajustar según altura combinada de barras\r\n-      body.style.paddingTop = \"72px\"; // Mantener espacio si quieres que no tape contenido\r\n+      header.style.top = \"50px\";     // Ajustar según altura combinada de barras\r\n+      body.style.paddingTop = \"50px\"; // Mantener espacio si quieres que no tape contenido\r\n     }\r\n \r\n     lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n"
                },
                {
                    "date": 1759847801238,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -132,30 +132,27 @@\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n-  // =====================================================\r\n-  // Ocultar promo-bar y top-bar al hacer scroll\r\n-  // =====================================================\r\n-  let lastScroll = 0;\r\n+// =====================================================\r\n+// Ocultar promo-bar y top-bar al hacer scroll (efecto MiFarma)\r\n+// =====================================================\r\n+window.addEventListener(\"scroll\", () => {\r\n+  const scrollY = window.scrollY;\r\n+  const promoBar = document.querySelector(\".promo-bar\");\r\n+  const topBar = document.querySelector(\".top-bar\");\r\n+  const header = document.querySelector(\".header\");\r\n \r\n-  window.addEventListener(\"scroll\", () => {\r\n-    const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+  if (scrollY > 80) {\r\n+    // 🔽 Al bajar: ocultar franjas superiores y fijar header\r\n+    promoBar?.classList.add(\"oculto\");\r\n+    topBar?.classList.add(\"oculto\");\r\n+    header.classList.add(\"fixed\");\r\n+  } else {\r\n+    // 🔼 Al volver arriba: mostrar todo\r\n+    promoBar?.classList.remove(\"oculto\");\r\n+    topBar?.classList.remove(\"oculto\");\r\n+    header.classList.remove(\"fixed\");\r\n+  }\r\n+});\r\n \r\n-    if (currentScroll > lastScroll && currentScroll > 50) {\r\n-      // 🔽 Bajando scroll → ocultar barras\r\n-      promoBar?.classList.add(\"oculto\");\r\n-      topBar?.classList.add(\"oculto\");\r\n-      header.style.top = \"0\";       // Header sube al top\r\n-      body.style.paddingTop = \"0\";   // Quitar espacio extra\r\n-    } else {\r\n-      // 🔼 Subiendo scroll → mostrar barras\r\n-      promoBar?.classList.remove(\"oculto\");\r\n-      topBar?.classList.remove(\"oculto\");\r\n-      header.style.top = \"50px\";     // Ajustar según altura combinada de barras\r\n-      body.style.paddingTop = \"50px\"; // Mantener espacio si quieres que no tape contenido\r\n-    }\r\n-\r\n-    lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n-  });\r\n-\r\n }); // 🔹 Cierre correcto de DOMContentLoaded\r\n"
                },
                {
                    "date": 1759848122172,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -133,26 +133,31 @@\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n // =====================================================\r\n-// Ocultar promo-bar y top-bar al hacer scroll (efecto MiFarma)\r\n+// Ocultar promo-bar y top-bar al hacer scroll\r\n // =====================================================\r\n+let lastScroll = 0;\r\n+\r\n window.addEventListener(\"scroll\", () => {\r\n-  const scrollY = window.scrollY;\r\n+  const currentScroll = window.scrollY;\r\n   const promoBar = document.querySelector(\".promo-bar\");\r\n   const topBar = document.querySelector(\".top-bar\");\r\n-  const header = document.querySelector(\".header\");\r\n+  const header = document.querySelector(\".main-header\");\r\n+  const body = document.body;\r\n \r\n-  if (scrollY > 80) {\r\n-    // 🔽 Al bajar: ocultar franjas superiores y fijar header\r\n+  if (currentScroll > lastScroll && currentScroll > 50) {\r\n+    // 🔽 Bajando → ocultar barras y subir header\r\n     promoBar?.classList.add(\"oculto\");\r\n     topBar?.classList.add(\"oculto\");\r\n     header.classList.add(\"fixed\");\r\n-  } else {\r\n-    // 🔼 Al volver arriba: mostrar todo\r\n+    body.style.paddingTop = \"0\"; // quitar espacio visual\r\n+  } else if (currentScroll < lastScroll && currentScroll < 100) {\r\n+    // 🔼 Subiendo o cerca del top → mostrar barras\r\n     promoBar?.classList.remove(\"oculto\");\r\n     topBar?.classList.remove(\"oculto\");\r\n     header.classList.remove(\"fixed\");\r\n+    body.style.paddingTop = \"70px\"; // altura combinada (promo + top)\r\n   }\r\n+\r\n+  lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n });\r\n-\r\n-}); // 🔹 Cierre correcto de DOMContentLoaded\r\n"
                },
                {
                    "date": 1759848176205,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -133,31 +133,33 @@\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n // =====================================================\r\n-// Ocultar promo-bar y top-bar al hacer scroll\r\n+// Ocultar promo-bar y top-bar al hacer scroll (efecto MiFarma)\r\n // =====================================================\r\n-let lastScroll = 0;\r\n-\r\n window.addEventListener(\"scroll\", () => {\r\n-  const currentScroll = window.scrollY;\r\n+  const scrollY = window.scrollY;\r\n   const promoBar = document.querySelector(\".promo-bar\");\r\n   const topBar = document.querySelector(\".top-bar\");\r\n-  const header = document.querySelector(\".main-header\");\r\n+  const header = document.querySelector(\".main-header\"); // usa tu clase real\r\n   const body = document.body;\r\n \r\n-  if (currentScroll > lastScroll && currentScroll > 50) {\r\n-    // 🔽 Bajando → ocultar barras y subir header\r\n+  if (scrollY > 80) {\r\n+    // 🔽 Al bajar: ocultar franjas superiores y fijar header\r\n     promoBar?.classList.add(\"oculto\");\r\n     topBar?.classList.add(\"oculto\");\r\n     header.classList.add(\"fixed\");\r\n-    body.style.paddingTop = \"0\"; // quitar espacio visual\r\n-  } else if (currentScroll < lastScroll && currentScroll < 100) {\r\n-    // 🔼 Subiendo o cerca del top → mostrar barras\r\n+\r\n+    // Quita cualquier espacio superior visual\r\n+    body.style.paddingTop = \"0\";\r\n+  } else {\r\n+    // 🔼 Al volver arriba: mostrar todo y restaurar posición\r\n     promoBar?.classList.remove(\"oculto\");\r\n     topBar?.classList.remove(\"oculto\");\r\n     header.classList.remove(\"fixed\");\r\n-    body.style.paddingTop = \"70px\"; // altura combinada (promo + top)\r\n+\r\n+    // Restaura espacio para que no se solape el contenido\r\n+    body.style.paddingTop = \"70px\"; // 🔹 30px promo + 40px top-bar\r\n   }\r\n+});\r\n \r\n-  lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n-});\r\n+}); // 🔹 Cierre correcto de DOMContentLoaded\r\n"
                },
                {
                    "date": 1759848482401,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -149,17 +149,19 @@\n     topBar?.classList.add(\"oculto\");\r\n     header.classList.add(\"fixed\");\r\n \r\n     // Quita cualquier espacio superior visual\r\n+    header.style.top = \"0\";\r\n     body.style.paddingTop = \"0\";\r\n   } else {\r\n     // 🔼 Al volver arriba: mostrar todo y restaurar posición\r\n     promoBar?.classList.remove(\"oculto\");\r\n     topBar?.classList.remove(\"oculto\");\r\n     header.classList.remove(\"fixed\");\r\n \r\n-    // Restaura espacio para que no se solape el contenido\r\n-    body.style.paddingTop = \"70px\"; // 🔹 30px promo + 40px top-bar\r\n+    // Restaura posición y espacio\r\n+    header.style.top = \"70px\"; // 🔹 30px promo + 40px top-bar\r\n+    body.style.paddingTop = \"70px\";\r\n   }\r\n });\r\n \r\n }); // 🔹 Cierre correcto de DOMContentLoaded\r\n"
                },
                {
                    "date": 1759848865329,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -139,29 +139,20 @@\n window.addEventListener(\"scroll\", () => {\r\n   const scrollY = window.scrollY;\r\n   const promoBar = document.querySelector(\".promo-bar\");\r\n   const topBar = document.querySelector(\".top-bar\");\r\n-  const header = document.querySelector(\".main-header\"); // usa tu clase real\r\n-  const body = document.body;\r\n+  const header = document.querySelector(\".header\");\r\n \r\n   if (scrollY > 80) {\r\n     // 🔽 Al bajar: ocultar franjas superiores y fijar header\r\n     promoBar?.classList.add(\"oculto\");\r\n     topBar?.classList.add(\"oculto\");\r\n     header.classList.add(\"fixed\");\r\n-\r\n-    // Quita cualquier espacio superior visual\r\n-    header.style.top = \"0\";\r\n-    body.style.paddingTop = \"0\";\r\n   } else {\r\n-    // 🔼 Al volver arriba: mostrar todo y restaurar posición\r\n+    // 🔼 Al volver arriba: mostrar todo\r\n     promoBar?.classList.remove(\"oculto\");\r\n     topBar?.classList.remove(\"oculto\");\r\n     header.classList.remove(\"fixed\");\r\n-\r\n-    // Restaura posición y espacio\r\n-    header.style.top = \"70px\"; // 🔹 30px promo + 40px top-bar\r\n-    body.style.paddingTop = \"70px\";\r\n   }\r\n });\r\n \r\n }); // 🔹 Cierre correcto de DOMContentLoaded\r\n"
                },
                {
                    "date": 1759848878593,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -132,27 +132,30 @@\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n-// =====================================================\r\n-// Ocultar promo-bar y top-bar al hacer scroll (efecto MiFarma)\r\n-// =====================================================\r\n-window.addEventListener(\"scroll\", () => {\r\n-  const scrollY = window.scrollY;\r\n-  const promoBar = document.querySelector(\".promo-bar\");\r\n-  const topBar = document.querySelector(\".top-bar\");\r\n-  const header = document.querySelector(\".header\");\r\n+  // =====================================================\r\n+  // Ocultar promo-bar y top-bar al hacer scroll\r\n+  // =====================================================\r\n+  let lastScroll = 0;\r\n \r\n-  if (scrollY > 80) {\r\n-    // 🔽 Al bajar: ocultar franjas superiores y fijar header\r\n-    promoBar?.classList.add(\"oculto\");\r\n-    topBar?.classList.add(\"oculto\");\r\n-    header.classList.add(\"fixed\");\r\n-  } else {\r\n-    // 🔼 Al volver arriba: mostrar todo\r\n-    promoBar?.classList.remove(\"oculto\");\r\n-    topBar?.classList.remove(\"oculto\");\r\n-    header.classList.remove(\"fixed\");\r\n-  }\r\n-});\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n+    if (currentScroll > lastScroll && currentScroll > 50) {\r\n+      // 🔽 Bajando scroll → ocultar barras\r\n+      promoBar?.classList.add(\"oculto\");\r\n+      topBar?.classList.add(\"oculto\");\r\n+      header.style.top = \"0\";       // Header sube al top\r\n+      body.style.paddingTop = \"0\";   // Quitar espacio extra\r\n+    } else {\r\n+      // 🔼 Subiendo scroll → mostrar barras\r\n+      promoBar?.classList.remove(\"oculto\");\r\n+      topBar?.classList.remove(\"oculto\");\r\n+      header.style.top = \"50px\";     // Ajustar según altura combinada de barras\r\n+      body.style.paddingTop = \"50px\"; // Mantener espacio si quieres que no tape contenido\r\n+    }\r\n+\r\n+    lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n+  });\r\n+\r\n }); // 🔹 Cierre correcto de DOMContentLoaded\r\n"
                },
                {
                    "date": 1759848894528,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -150,10 +150,10 @@\n     } else {\r\n       // 🔼 Subiendo scroll → mostrar barras\r\n       promoBar?.classList.remove(\"oculto\");\r\n       topBar?.classList.remove(\"oculto\");\r\n-      header.style.top = \"50px\";     // Ajustar según altura combinada de barras\r\n-      body.style.paddingTop = \"50px\"; // Mantener espacio si quieres que no tape contenido\r\n+      header.style.top = \"72px\";     // Ajustar según altura combinada de barras\r\n+      body.style.paddingTop = \"72px\"; // Mantener espacio si quieres que no tape contenido\r\n     }\r\n \r\n     lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n"
                },
                {
                    "date": 1759849811591,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -135,27 +135,32 @@\n \r\n   // =====================================================\r\n   // Ocultar promo-bar y top-bar al hacer scroll\r\n   // =====================================================\r\n+  document.addEventListener('DOMContentLoaded', () => {\r\n+  const promoBar = document.querySelector('.promo-bar');\r\n+  const topBar = document.getElementById('top-bar');\r\n+  const header = document.querySelector('.main-header');\r\n+  const body = document.body;\r\n+\r\n   let lastScroll = 0;\r\n \r\n-  window.addEventListener(\"scroll\", () => {\r\n+  window.addEventListener('scroll', () => {\r\n     const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n     if (currentScroll > lastScroll && currentScroll > 50) {\r\n       // 🔽 Bajando scroll → ocultar barras\r\n-      promoBar?.classList.add(\"oculto\");\r\n-      topBar?.classList.add(\"oculto\");\r\n-      header.style.top = \"0\";       // Header sube al top\r\n-      body.style.paddingTop = \"0\";   // Quitar espacio extra\r\n+      promoBar?.classList.add('oculto');\r\n+      topBar?.classList.add('oculto');\r\n+      header.style.top = '0';\r\n+      body.style.paddingTop = '0';\r\n     } else {\r\n       // 🔼 Subiendo scroll → mostrar barras\r\n-      promoBar?.classList.remove(\"oculto\");\r\n-      topBar?.classList.remove(\"oculto\");\r\n-      header.style.top = \"72px\";     // Ajustar según altura combinada de barras\r\n-      body.style.paddingTop = \"72px\"; // Mantener espacio si quieres que no tape contenido\r\n+      promoBar?.classList.remove('oculto');\r\n+      topBar?.classList.remove('oculto');\r\n+      header.style.top = '72px'; // 30 + 42\r\n+      body.style.paddingTop = '72px';\r\n     }\r\n \r\n     lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n-\r\n-}); // 🔹 Cierre correcto de DOMContentLoaded\r\n+});\r\n"
                },
                {
                    "date": 1759850255714,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -132,35 +132,26 @@\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n-  // =====================================================\r\n+// =====================================================\r\n   // Ocultar promo-bar y top-bar al hacer scroll\r\n   // =====================================================\r\n-  document.addEventListener('DOMContentLoaded', () => {\r\n-  const promoBar = document.querySelector('.promo-bar');\r\n-  const topBar = document.getElementById('top-bar');\r\n-  const header = document.querySelector('.main-header');\r\n-  const body = document.body;\r\n-\r\n   let lastScroll = 0;\r\n-\r\n   window.addEventListener('scroll', () => {\r\n     const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n     if (currentScroll > lastScroll && currentScroll > 50) {\r\n-      // 🔽 Bajando scroll → ocultar barras\r\n       promoBar?.classList.add('oculto');\r\n       topBar?.classList.add('oculto');\r\n       header.style.top = '0';\r\n       body.style.paddingTop = '0';\r\n     } else {\r\n-      // 🔼 Subiendo scroll → mostrar barras\r\n       promoBar?.classList.remove('oculto');\r\n       topBar?.classList.remove('oculto');\r\n-      header.style.top = '72px'; // 30 + 42\r\n+      header.style.top = '72px';\r\n       body.style.paddingTop = '72px';\r\n     }\r\n \r\n     lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n-});\r\n+});\n\\ No newline at end of file\n"
                },
                {
                    "date": 1759851065668,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -132,26 +132,23 @@\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n-// =====================================================\r\n-  // Ocultar promo-bar y top-bar al hacer scroll\r\n-  // =====================================================\r\n-  let lastScroll = 0;\r\n-  window.addEventListener('scroll', () => {\r\n+// ================================\r\n+// Ocultar top-bar al hacer scroll\r\n+// ================================\r\n+  window.addEventListener(\"scroll\", () => {\r\n     const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n     if (currentScroll > lastScroll && currentScroll > 50) {\r\n-      promoBar?.classList.add('oculto');\r\n-      topBar?.classList.add('oculto');\r\n-      header.style.top = '0';\r\n-      body.style.paddingTop = '0';\r\n+      // 🔽 Bajando → ocultar top-bar\r\n+      if (topBar) topBar.classList.add(\"oculto\");\r\n+      if (header) header.style.top = \"0\";\r\n     } else {\r\n-      promoBar?.classList.remove('oculto');\r\n-      topBar?.classList.remove('oculto');\r\n\\ No newline at end of file\n-      header.style.top = '72px';\r\n-      body.style.paddingTop = '72px';\r\n+      // 🔼 Subiendo → mostrar top-bar\r\n+      if (topBar) topBar.classList.remove(\"oculto\");\r\n+      if (header) header.style.top = topBar.offsetHeight + \"px\";\r\n     }\r\n \r\n     lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n-});\n+});\r\n"
                },
                {
                    "date": 1759851468930,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -135,19 +135,21 @@\n \r\n // ================================\r\n // Ocultar top-bar al hacer scroll\r\n // ================================\r\n-  window.addEventListener(\"scroll\", () => {\r\n+window.addEventListener('scroll', () => {\r\n     const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n     if (currentScroll > lastScroll && currentScroll > 50) {\r\n-      // 🔽 Bajando → ocultar top-bar\r\n-      if (topBar) topBar.classList.add(\"oculto\");\r\n-      if (header) header.style.top = \"0\";\r\n+      // 🔽 Bajando → ocultar\r\n+      promoBar?.classList.add('oculto');\r\n+      topBar?.classList.add('oculto');\r\n+      header.classList.add('fixed');\r\n     } else {\r\n-      // 🔼 Subiendo → mostrar top-bar\r\n-      if (topBar) topBar.classList.remove(\"oculto\");\r\n-      if (header) header.style.top = topBar.offsetHeight + \"px\";\r\n+      // 🔼 Subiendo → mostrar\r\n+      promoBar?.classList.remove('oculto');\r\n+      topBar?.classList.remove('oculto');\r\n+      header.classList.remove('fixed');\r\n     }\r\n \r\n     lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n"
                },
                {
                    "date": 1759851572167,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -135,8 +135,9 @@\n \r\n // ================================\r\n // Ocultar top-bar al hacer scroll\r\n // ================================\r\n+ let lastScroll = 0;\r\n window.addEventListener('scroll', () => {\r\n     const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n     if (currentScroll > lastScroll && currentScroll > 50) {\r\n"
                },
                {
                    "date": 1759852687724,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -132,26 +132,29 @@\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n-// ================================\r\n-// Ocultar top-bar al hacer scroll\r\n-// ================================\r\n- let lastScroll = 0;\r\n-window.addEventListener('scroll', () => {\r\n-    const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+ // =========================\r\n+  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+  // =========================\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-    if (currentScroll > lastScroll && currentScroll > 50) {\r\n-      // 🔽 Bajando → ocultar\r\n-      promoBar?.classList.add('oculto');\r\n-      topBar?.classList.add('oculto');\r\n-      header.classList.add('fixed');\r\n+    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+      // Scrolleando hacia abajo → oculta barras\r\n+      promoBar?.classList.add(\"hidden\");\r\n+      topBar?.classList.add(\"hidden\");\r\n+\r\n+      header.style.top = \"0\";\r\n+      body.style.paddingTop = \"0\";\r\n     } else {\r\n-      // 🔼 Subiendo → mostrar\r\n-      promoBar?.classList.remove('oculto');\r\n-      topBar?.classList.remove('oculto');\r\n-      header.classList.remove('fixed');\r\n+      // Scrolleando hacia arriba → muestra barras\r\n+      promoBar?.classList.remove(\"hidden\");\r\n+      topBar?.classList.remove(\"hidden\");\r\n+\r\n+      header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n+      body.style.paddingTop = \"180px\"; // Ajusta el espacio total del header\r\n     }\r\n \r\n-    lastScroll = currentScroll <= 0 ? 0 : currentScroll;\r\n+    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n });\r\n"
                },
                {
                    "date": 1759853378225,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -131,30 +131,29 @@\n       buildMenuFromData(data.categorias||[]);\r\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n+// =========================\r\n+// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+// =========================\r\n \r\n- // =========================\r\n-  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-  // =========================\r\n-  window.addEventListener(\"scroll\", () => {\r\n-    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+let lastScrollTop = 0;\r\n \r\n-    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-      // Scrolleando hacia abajo → oculta barras\r\n-      promoBar?.classList.add(\"hidden\");\r\n-      topBar?.classList.add(\"hidden\");\r\n+window.addEventListener(\"scroll\", () => {\r\n+  let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-      header.style.top = \"0\";\r\n-      body.style.paddingTop = \"0\";\r\n-    } else {\r\n-      // Scrolleando hacia arriba → muestra barras\r\n-      promoBar?.classList.remove(\"hidden\");\r\n-      topBar?.classList.remove(\"hidden\");\r\n+  const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n \r\n-      header.style.top = \"72px\"; // Ajusta según altura real de tus barras\r\n-      body.style.paddingTop = \"180px\"; // Ajusta el espacio total del header\r\n-    }\r\n+  if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+    promoBar?.classList.add(\"hidden\");\r\n+    topBar?.classList.add(\"hidden\");\r\n+    header?.style.top = \"0\";\r\n+    body.style.paddingTop = \"0\";\r\n+  } else {\r\n+    promoBar?.classList.remove(\"hidden\");\r\n+    topBar?.classList.remove(\"hidden\");\r\n+    header?.style.top = `${totalAltura}px`;\r\n+    body.style.paddingTop = `${totalAltura}px`;\r\n+  }\r\n \r\n-    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n-  });\r\n+  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n });\r\n"
                },
                {
                    "date": 1759853480396,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,7 @@\n-\r\n-  // =========================\r\n-  // ELEMENTOS PRINCIPALES\r\n-  // =========================\r\n+// =========================\r\n+// ELEMENTOS PRINCIPALES\r\n+// =========================\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n@@ -25,9 +24,8 @@\n   };\r\n   const cerrarMenu = () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n-    // Limpiar clases activas al cerrar menú\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   };\r\n \r\n   menuToggle?.addEventListener(\"click\", abrirMenu);\r\n@@ -59,9 +57,8 @@\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n \r\n-    // Auto-scroll al contenedor de productos\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n@@ -91,16 +88,13 @@\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            // Limpiar todas las clases activas\r\n             menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-            \r\n-            // Marcar la categoría y subcategoría como activas\r\n             li.classList.add(\"active\"); \r\n             liSub.classList.add(\"active\");\r\n \r\n-            cerrarMenu(); // Cierra menú lateral\r\n+            cerrarMenu();\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n@@ -110,9 +104,8 @@\n \r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           const abierto = li.classList.contains(\"active\");\r\n-          // Cerrar todas las demás categorías\r\n           menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n           if(!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n@@ -131,29 +124,33 @@\n       buildMenuFromData(data.categorias||[]);\r\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n-// =========================\r\n-// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-// =========================\r\n \r\n-let lastScrollTop = 0;\r\n+  // =========================\r\n+  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+  // =========================\r\n+  let lastScrollTop = 0;\r\n \r\n-window.addEventListener(\"scroll\", () => {\r\n-  let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-  const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n+    const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n \r\n-  if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-    promoBar?.classList.add(\"hidden\");\r\n-    topBar?.classList.add(\"hidden\");\r\n-    header?.style.top = \"0\";\r\n-    body.style.paddingTop = \"0\";\r\n-  } else {\r\n-    promoBar?.classList.remove(\"hidden\");\r\n-    topBar?.classList.remove(\"hidden\");\r\n-    header?.style.top = `${totalAltura}px`;\r\n-    body.style.paddingTop = `${totalAltura}px`;\r\n-  }\r\n+    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+      // Scrolleando hacia abajo → ocultar barras\r\n+      promoBar?.classList.add(\"hidden\");\r\n+      topBar?.classList.add(\"hidden\");\r\n+      header?.style.top = \"0\";\r\n+      body.style.paddingTop = \"0\";\r\n+    } else {\r\n+      // Scrolleando hacia arriba → mostrar barras\r\n+      promoBar?.classList.remove(\"hidden\");\r\n+      topBar?.classList.remove(\"hidden\");\r\n+      header?.style.top = `${totalAltura}px`;\r\n+      body.style.paddingTop = `${totalAltura}px`;\r\n+    }\r\n \r\n-  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+  });\r\n+\r\n });\r\n"
                },
                {
                    "date": 1759853649869,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -125,32 +125,30 @@\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n-  // =========================\r\n-  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-  // =========================\r\n-  let lastScrollTop = 0;\r\n+// =========================\r\n+// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+// =========================\r\n+let lastScrollTop = 0;\r\n \r\n-  window.addEventListener(\"scroll\", () => {\r\n-    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+window.addEventListener(\"scroll\", () => {   // ⬅️ aquí usar llaves {}\r\n+  let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-    const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n+  const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n \r\n-    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-      // Scrolleando hacia abajo → ocultar barras\r\n-      promoBar?.classList.add(\"hidden\");\r\n-      topBar?.classList.add(\"hidden\");\r\n-      header?.style.top = \"0\";\r\n-      body.style.paddingTop = \"0\";\r\n-    } else {\r\n-      // Scrolleando hacia arriba → mostrar barras\r\n-      promoBar?.classList.remove(\"hidden\");\r\n-      topBar?.classList.remove(\"hidden\");\r\n-      header?.style.top = `${totalAltura}px`;\r\n-      body.style.paddingTop = `${totalAltura}px`;\r\n-    }\r\n+  if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+    promoBar?.classList.add(\"hidden\");\r\n+    topBar?.classList.add(\"hidden\");\r\n+    header?.style.top = \"0\";\r\n+    body.style.paddingTop = \"0\";\r\n+  } else {\r\n+    promoBar?.classList.remove(\"hidden\");\r\n+    topBar?.classList.remove(\"hidden\");\r\n+    header?.style.top = `${totalAltura}px`;\r\n+    body.style.paddingTop = `${totalAltura}px`;\r\n+  }\r\n \r\n-    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n-  });\r\n+  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+});  // ⬅️ cerrar scroll listener\r\n \r\n-});\r\n+}); // ⬅️ cerrar DOMContentLoaded\r\n"
                },
                {
                    "date": 1759853736155,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -130,9 +130,9 @@\n // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n // =========================\r\n let lastScrollTop = 0;\r\n \r\n-window.addEventListener(\"scroll\", () => {   // ⬅️ aquí usar llaves {}\r\n+window.addEventListener(\"scroll\", () => {  // ⬅️ LLAVES obligatorias\r\n   let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n   const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n \r\n@@ -148,7 +148,6 @@\n     body.style.paddingTop = `${totalAltura}px`;\r\n   }\r\n \r\n   lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n-});  // ⬅️ cerrar scroll listener\r\n-\r\n-}); // ⬅️ cerrar DOMContentLoaded\r\n+});\r\n+});\n\\ No newline at end of file\n"
                },
                {
                    "date": 1759853841350,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -128,25 +128,25 @@\n \r\n // =========================\r\n // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n // =========================\r\n-let lastScrollTop = 0;\r\n+let lastScrollTop = 0; // declaración global para el scroll\r\n \r\n-window.addEventListener(\"scroll\", () => {  // ⬅️ LLAVES obligatorias\r\n+window.addEventListener(\"scroll\", () => {\r\n   let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-  const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n-\r\n   if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n     promoBar?.classList.add(\"hidden\");\r\n     topBar?.classList.add(\"hidden\");\r\n+\r\n     header?.style.top = \"0\";\r\n     body.style.paddingTop = \"0\";\r\n   } else {\r\n     promoBar?.classList.remove(\"hidden\");\r\n     topBar?.classList.remove(\"hidden\");\r\n-    header?.style.top = `${totalAltura}px`;\r\n-    body.style.paddingTop = `${totalAltura}px`;\r\n+\r\n+    header?.style.top = \"72px\";\r\n+    body.style.paddingTop = \"180px\";\r\n   }\r\n \r\n   lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n });\r\n"
                },
                {
                    "date": 1759853917480,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -128,25 +128,25 @@\n \r\n // =========================\r\n // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n // =========================\r\n-let lastScrollTop = 0; // declaración global para el scroll\r\n+let lastScrollTop = 0; // Declaración global\r\n \r\n window.addEventListener(\"scroll\", () => {\r\n   let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n+  const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n+\r\n   if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n     promoBar?.classList.add(\"hidden\");\r\n     topBar?.classList.add(\"hidden\");\r\n-\r\n     header?.style.top = \"0\";\r\n     body.style.paddingTop = \"0\";\r\n   } else {\r\n     promoBar?.classList.remove(\"hidden\");\r\n     topBar?.classList.remove(\"hidden\");\r\n-\r\n-    header?.style.top = \"72px\";\r\n-    body.style.paddingTop = \"180px\";\r\n+    header?.style.top = `${totalAltura}px`;\r\n+    body.style.paddingTop = `${totalAltura}px`;\r\n   }\r\n \r\n   lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n });\r\n"
                },
                {
                    "date": 1759854090695,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -128,11 +128,14 @@\n \r\n // =========================\r\n // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n // =========================\r\n+// =========================\r\n+// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+// =========================\r\n let lastScrollTop = 0; // Declaración global\r\n \r\n-window.addEventListener(\"scroll\", () => {\r\n+window.addEventListener(\"scroll\", () => {  // ⬅️ llaves obligatorias\r\n   let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n   const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n \r\n"
                },
                {
                    "date": 1759854189986,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -128,17 +128,16 @@\n \r\n // =========================\r\n // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n // =========================\r\n-// =========================\r\n-// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-// =========================\r\n-let lastScrollTop = 0; // Declaración global\r\n+let lastScrollTop = 0; // declaración global antes del listener\r\n \r\n-window.addEventListener(\"scroll\", () => {  // ⬅️ llaves obligatorias\r\n+window.addEventListener(\"scroll\", () => { // ⬅️ llaves obligatorias\r\n   let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-  const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n+  const totalAltura = (promoBar?.offsetHeight || 0) \r\n+                     + (topBar?.offsetHeight || 0) \r\n+                     + (header?.offsetHeight || 0);\r\n \r\n   if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n     promoBar?.classList.add(\"hidden\");\r\n     topBar?.classList.add(\"hidden\");\r\n@@ -150,7 +149,7 @@\n     header?.style.top = `${totalAltura}px`;\r\n     body.style.paddingTop = `${totalAltura}px`;\r\n   }\r\n \r\n-  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll; // ✅ asignación correcta\r\n });\r\n\\ No newline at end of file\n-});\n+});\r\n"
                },
                {
                    "date": 1759854291016,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -128,28 +128,29 @@\n \r\n // =========================\r\n // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n // =========================\r\n-let lastScrollTop = 0; // declaración global antes del listener\r\n+ let lastScrollTop = 0;\r\n \r\n-window.addEventListener(\"scroll\", () => { // ⬅️ llaves obligatorias\r\n-  let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-  const totalAltura = (promoBar?.offsetHeight || 0) \r\n-                     + (topBar?.offsetHeight || 0) \r\n-                     + (header?.offsetHeight || 0);\r\n+    const totalAltura = (promoBar?.offsetHeight || 0) \r\n+                       + (topBar?.offsetHeight || 0) \r\n+                       + (header?.offsetHeight || 0);\r\n \r\n-  if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-    promoBar?.classList.add(\"hidden\");\r\n-    topBar?.classList.add(\"hidden\");\r\n-    header?.style.top = \"0\";\r\n-    body.style.paddingTop = \"0\";\r\n-  } else {\r\n-    promoBar?.classList.remove(\"hidden\");\r\n-    topBar?.classList.remove(\"hidden\");\r\n-    header?.style.top = `${totalAltura}px`;\r\n\\ No newline at end of file\n-    body.style.paddingTop = `${totalAltura}px`;\r\n-  }\r\n+    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+      promoBar?.classList.add(\"hidden\");\r\n+      topBar?.classList.add(\"hidden\");\r\n+      header?.style.top = \"0\";\r\n+      body.style.paddingTop = \"0\";\r\n+    } else {\r\n+      promoBar?.classList.remove(\"hidden\");\r\n+      topBar?.classList.remove(\"hidden\");\r\n+      header?.style.top = `${totalAltura}px`;\r\n+      body.style.paddingTop = `${totalAltura}px`;\r\n+    }\r\n \r\n-  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll; // ✅ asignación correcta\r\n-});\r\n-});\n+    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+  });\r\n+\r\n+}); // <- cierra el DOMContentLoaded\n\\ No newline at end of file\n"
                },
                {
                    "date": 1759854466692,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,24 +1,20 @@\n-// =========================\r\n-// ELEMENTOS PRINCIPALES\r\n-// =========================\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n+\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n   const contenedorProductos = document.getElementById(\"catalogo\");\r\n-  const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo\r\n-  const topBar = document.querySelector(\".top-bar\");     // Barra superior\r\n-  const header = document.querySelector(\".main-header\"); // Header principal\r\n+  const promoBar = document.querySelector(\".promo-bar\");\r\n+  const topBar = document.querySelector(\".top-bar\");\r\n+  const header = document.querySelector(\".main-header\");\r\n   const body = document.body;\r\n \r\n   let productosGlobal = [];\r\n \r\n-  // =====================================================\r\n   // Abrir / cerrar menú lateral\r\n-  // =====================================================\r\n   const abrirMenu = () => { \r\n     nav.classList.add(\"activo\"); \r\n     overlayMenu.classList.add(\"activo\"); \r\n   };\r\n@@ -31,20 +27,17 @@\n   menuToggle?.addEventListener(\"click\", abrirMenu);\r\n   closeMenu?.addEventListener(\"click\", cerrarMenu);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenu);\r\n \r\n-  // =====================================================\r\n-  // Mostrar productos filtrados por subcategoría\r\n-  // =====================================================\r\n+  // Mostrar productos filtrados\r\n   const mostrarProductosPorSubcategoria = (id) => {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n     if (!filtrados.length) { \r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\"; \r\n       return; \r\n     }\r\n-\r\n     filtrados.forEach(prod => {\r\n       const precio = prod.precio_con_descuento ?? prod.precio;\r\n       const card = document.createElement(\"div\");\r\n       card.className = \"producto-card\";\r\n@@ -56,20 +49,16 @@\n         <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n-\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // =====================================================\r\n   // Construir menú dinámico\r\n-  // =====================================================\r\n   const buildMenuFromData = (categorias) => {\r\n     menuCategorias.innerHTML = \"\";\r\n-\r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\"; \r\n@@ -77,9 +66,8 @@\n       li.appendChild(a);\r\n \r\n       if(cat.subcategorias?.length){\r\n         const ulSub = document.createElement(\"ul\");\r\n-\r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\"; \r\n@@ -87,20 +75,17 @@\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n-\r\n             menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n             li.classList.add(\"active\"); \r\n             liSub.classList.add(\"active\");\r\n-\r\n             cerrarMenu();\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n-\r\n         li.appendChild(ulSub);\r\n \r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n@@ -113,11 +98,9 @@\n       menuCategorias.appendChild(li);\r\n     });\r\n   };\r\n \r\n-  // =====================================================\r\n   // Cargar JSON\r\n-  // =====================================================\r\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n       productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n@@ -125,12 +108,12 @@\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n-// =========================\r\n-// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-// =========================\r\n- let lastScrollTop = 0;\r\n+  // =========================\r\n+  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+  // =========================\r\n+  let lastScrollTop = 0;\r\n \r\n   window.addEventListener(\"scroll\", () => {\r\n     let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n@@ -152,5 +135,5 @@\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n \r\n-}); // <- cierra el DOMContentLoaded\n\\ No newline at end of file\n+}); // <- cierra DOMContentLoaded\r\n"
                },
                {
                    "date": 1759854533428,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -134,6 +134,4 @@\n     }\r\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n-\r\n-}); // <- cierra DOMContentLoaded\r\n"
                },
                {
                    "date": 1759854875389,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -115,13 +115,10 @@\n   let lastScrollTop = 0;\r\n \r\n   window.addEventListener(\"scroll\", () => {\r\n     let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+    const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n \r\n-    const totalAltura = (promoBar?.offsetHeight || 0) \r\n-                       + (topBar?.offsetHeight || 0) \r\n-                       + (header?.offsetHeight || 0);\r\n-\r\n     if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n       promoBar?.classList.add(\"hidden\");\r\n       topBar?.classList.add(\"hidden\");\r\n       header?.style.top = \"0\";\r\n@@ -134,4 +131,6 @@\n     }\r\n \r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n+\r\n+}); // <- ÚNICO cierre DOMContentLoaded\r\n"
                },
                {
                    "date": 1759855216301,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -111,26 +111,33 @@\n \r\n   // =========================\r\n   // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n   // =========================\r\n-  let lastScrollTop = 0;\r\n \r\n-  window.addEventListener(\"scroll\", () => {\r\n-    let currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n-    const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n+let lastScrollTop = 0;\r\n \r\n-    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-      promoBar?.classList.add(\"hidden\");\r\n-      topBar?.classList.add(\"hidden\");\r\n-      header?.style.top = \"0\";\r\n-      body.style.paddingTop = \"0\";\r\n-    } else {\r\n-      promoBar?.classList.remove(\"hidden\");\r\n-      topBar?.classList.remove(\"hidden\");\r\n-      header?.style.top = `${totalAltura}px`;\r\n-      body.style.paddingTop = `${totalAltura}px`;\r\n-    }\r\n+window.addEventListener(\"scroll\", () => {\r\n+  const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+  const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n \r\n-    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n-  });\r\n+  if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+    // Scroll hacia abajo: ocultar barras\r\n+    if (promoBar) promoBar.classList.add(\"hidden\");\r\n+    if (topBar) topBar.classList.add(\"hidden\");\r\n+    if (header) header.style.top = \"0px\";\r\n+    body.style.paddingTop = \"0px\";\r\n+  } else {\r\n+    // Scroll hacia arriba: mostrar barras\r\n+    if (promoBar) promoBar.classList.remove(\"hidden\");\r\n+    if (topBar) topBar.classList.remove(\"hidden\");\r\n+    if (header) header.style.top = `${totalAltura}px`;\r\n+    body.style.paddingTop = `${totalAltura}px`;\r\n+  }\r\n \r\n-}); // <- ÚNICO cierre DOMContentLoaded\r\n+  // Actualizar último scroll de forma segura\r\n+  if (currentScroll <= 0) {\r\n+    lastScrollTop = 0;\r\n+  } else {\r\n+    lastScrollTop = currentScroll;\r\n+  }\r\n+});\r\n+});\n\\ No newline at end of file\n"
                },
                {
                    "date": 1759855338734,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,43 +1,52 @@\n+\r\n+  // =========================\r\n+  // ELEMENTOS PRINCIPALES\r\n+  // =========================\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n-\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n   const contenedorProductos = document.getElementById(\"catalogo\");\r\n-  const promoBar = document.querySelector(\".promo-bar\");\r\n-  const topBar = document.querySelector(\".top-bar\");\r\n-  const header = document.querySelector(\".main-header\");\r\n+  const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo\r\n+  const topBar = document.querySelector(\".top-bar\");     // Barra superior\r\n+  const header = document.querySelector(\".main-header\"); // Header principal\r\n   const body = document.body;\r\n \r\n   let productosGlobal = [];\r\n \r\n+  // =====================================================\r\n   // Abrir / cerrar menú lateral\r\n+  // =====================================================\r\n   const abrirMenu = () => { \r\n     nav.classList.add(\"activo\"); \r\n     overlayMenu.classList.add(\"activo\"); \r\n   };\r\n   const cerrarMenu = () => {\r\n     nav.classList.remove(\"activo\");\r\n     overlayMenu.classList.remove(\"activo\");\r\n+    // Limpiar clases activas al cerrar menú\r\n     menuCategorias.querySelectorAll(\"li.active\").forEach(li => li.classList.remove(\"active\"));\r\n   };\r\n \r\n   menuToggle?.addEventListener(\"click\", abrirMenu);\r\n   closeMenu?.addEventListener(\"click\", cerrarMenu);\r\n   overlayMenu?.addEventListener(\"click\", cerrarMenu);\r\n \r\n-  // Mostrar productos filtrados\r\n+  // =====================================================\r\n+  // Mostrar productos filtrados por subcategoría\r\n+  // =====================================================\r\n   const mostrarProductosPorSubcategoria = (id) => {\r\n     if (!contenedorProductos) return;\r\n     contenedorProductos.innerHTML = \"\";\r\n     const filtrados = productosGlobal.filter(p => Number(p.subcategoria) === Number(id));\r\n     if (!filtrados.length) { \r\n       contenedorProductos.innerHTML = \"<p>No hay productos en esta subcategoría.</p>\"; \r\n       return; \r\n     }\r\n+\r\n     filtrados.forEach(prod => {\r\n       const precio = prod.precio_con_descuento ?? prod.precio;\r\n       const card = document.createElement(\"div\");\r\n       card.className = \"producto-card\";\r\n@@ -49,16 +58,21 @@\n         <button onclick=\"agregarAlCarrito(${prod.id})\">Agregar al carrito</button>\r\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n+\r\n+    // Auto-scroll al contenedor de productos\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n+  // =====================================================\r\n   // Construir menú dinámico\r\n+  // =====================================================\r\n   const buildMenuFromData = (categorias) => {\r\n     menuCategorias.innerHTML = \"\";\r\n+\r\n     categorias.forEach(cat => {\r\n       const li = document.createElement(\"li\");\r\n       const a = document.createElement(\"a\");\r\n       a.href = \"#\"; \r\n@@ -66,8 +80,9 @@\n       li.appendChild(a);\r\n \r\n       if(cat.subcategorias?.length){\r\n         const ulSub = document.createElement(\"ul\");\r\n+\r\n         cat.subcategorias.forEach(sub => {\r\n           const liSub = document.createElement(\"li\");\r\n           const aSub = document.createElement(\"a\");\r\n           aSub.href = \"#\"; \r\n@@ -75,22 +90,29 @@\n \r\n           aSub.addEventListener(\"click\", e => {\r\n             e.preventDefault();\r\n             mostrarProductosPorSubcategoria(sub.id);\r\n+\r\n+            // Limpiar todas las clases activas\r\n             menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+            \r\n+            // Marcar la categoría y subcategoría como activas\r\n             li.classList.add(\"active\"); \r\n             liSub.classList.add(\"active\");\r\n-            cerrarMenu();\r\n+\r\n+            cerrarMenu(); // Cierra menú lateral\r\n           });\r\n \r\n           liSub.appendChild(aSub);\r\n           ulSub.appendChild(liSub);\r\n         });\r\n+\r\n         li.appendChild(ulSub);\r\n \r\n         a.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           const abierto = li.classList.contains(\"active\");\r\n+          // Cerrar todas las demás categorías\r\n           menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n           if(!abierto) li.classList.add(\"active\");\r\n         });\r\n       }\r\n@@ -98,9 +120,11 @@\n       menuCategorias.appendChild(li);\r\n     });\r\n   };\r\n \r\n+  // =====================================================\r\n   // Cargar JSON\r\n+  // =====================================================\r\n   fetch(\"productos.json\")\r\n     .then(resp => resp.json())\r\n     .then(data => {\r\n       productosGlobal = [...(data.productos||[]), ...(data.ofertas||[])];\r\n@@ -109,11 +133,10 @@\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n   // =========================\r\n-  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-  // =========================\r\n-\r\n+// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+// =========================\r\n let lastScrollTop = 0;\r\n \r\n window.addEventListener(\"scroll\", () => {\r\n   const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n"
                },
                {
                    "date": 1759855728762,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -135,32 +135,34 @@\n \r\n   // =========================\r\n // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n // =========================\r\n+// =========================\r\n+// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+// =========================\r\n let lastScrollTop = 0;\r\n \r\n window.addEventListener(\"scroll\", () => {\r\n   const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n-  const totalAltura = (promoBar?.offsetHeight || 0) + (topBar?.offsetHeight || 0) + (header?.offsetHeight || 0);\r\n+  const promoHeight = promoBar?.offsetHeight || 0;\r\n+  const topHeight = topBar?.offsetHeight || 0;\r\n+  const headerHeight = header?.offsetHeight || 0;\r\n+  const totalAltura = promoHeight + topHeight + headerHeight;\r\n \r\n   if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-    // Scroll hacia abajo: ocultar barras\r\n+    // Scroll hacia abajo: sube la top-bar desde arriba y oculta promo\r\n     if (promoBar) promoBar.classList.add(\"hidden\");\r\n-    if (topBar) topBar.classList.add(\"hidden\");\r\n-    if (header) header.style.top = \"0px\";\r\n+    if (topBar) topBar.style.top = `-${topHeight}px`; // se mueve hacia arriba\r\n+    if (header) header.style.top = `0px`;\r\n     body.style.paddingTop = \"0px\";\r\n   } else {\r\n-    // Scroll hacia arriba: mostrar barras\r\n+    // Scroll hacia arriba: muestra todo\r\n     if (promoBar) promoBar.classList.remove(\"hidden\");\r\n-    if (topBar) topBar.classList.remove(\"hidden\");\r\n+    if (topBar) topBar.style.top = `${promoHeight}px`; // se coloca debajo de promo\r\n     if (header) header.style.top = `${totalAltura}px`;\r\n     body.style.paddingTop = `${totalAltura}px`;\r\n   }\r\n \r\n-  // Actualizar último scroll de forma segura\r\n-  if (currentScroll <= 0) {\r\n-    lastScrollTop = 0;\r\n-  } else {\r\n-    lastScrollTop = currentScroll;\r\n-  }\r\n+  // Actualizar último scroll\r\n+  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n });\r\n });\n\\ No newline at end of file\n"
                },
                {
                    "date": 1759855885327,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -135,11 +135,8 @@\n \r\n   // =========================\r\n // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n // =========================\r\n-// =========================\r\n-// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-// =========================\r\n let lastScrollTop = 0;\r\n \r\n window.addEventListener(\"scroll\", () => {\r\n   const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n"
                },
                {
                    "date": 1760036192801,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -161,5 +161,8 @@\n \r\n   // Actualizar último scroll\r\n   lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n });\r\n-});\n\\ No newline at end of file\n+});\r\n+window.addEventListener(\"load\", () => {\r\n+  document.body.classList.add(\"loaded\");\r\n+});\r\n"
                },
                {
                    "date": 1760037305858,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -158,11 +158,5 @@\n     if (header) header.style.top = `${totalAltura}px`;\r\n     body.style.paddingTop = `${totalAltura}px`;\r\n   }\r\n \r\n-  // Actualizar último scroll\r\n-  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n-});\r\n-});\r\n-window.addEventListener(\"load\", () => {\r\n-  document.body.classList.add(\"loaded\");\r\n-});\r\n+ \n\\ No newline at end of file\n"
                },
                {
                    "date": 1760037316124,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -158,5 +158,8 @@\n     if (header) header.style.top = `${totalAltura}px`;\r\n     body.style.paddingTop = `${totalAltura}px`;\r\n   }\r\n \r\n- \n\\ No newline at end of file\n+  // Actualizar último scroll\r\n+  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+});\r\n+});\r\n"
                },
                {
                    "date": 1760037984601,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -138,28 +138,31 @@\n // =========================\r\n let lastScrollTop = 0;\r\n \r\n window.addEventListener(\"scroll\", () => {\r\n-  const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n-  const promoHeight = promoBar?.offsetHeight || 0;\r\n-  const topHeight = topBar?.offsetHeight || 0;\r\n-  const headerHeight = header?.offsetHeight || 0;\r\n-  const totalAltura = promoHeight + topHeight + headerHeight;\r\n+    const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+    const promoHeight = promoBar?.offsetHeight || 0;\r\n+    const topHeight = topBar?.offsetHeight || 0;\r\n+    const headerHeight = header?.offsetHeight || 0;\r\n+    const totalAltura = promoHeight + topHeight + headerHeight;\r\n \r\n-  if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-    // Scroll hacia abajo: sube la top-bar desde arriba y oculta promo\r\n-    if (promoBar) promoBar.classList.add(\"hidden\");\r\n-    if (topBar) topBar.style.top = `-${topHeight}px`; // se mueve hacia arriba\r\n-    if (header) header.style.top = `0px`;\r\n-    body.style.paddingTop = \"0px\";\r\n-  } else {\r\n-    // Scroll hacia arriba: muestra todo\r\n-    if (promoBar) promoBar.classList.remove(\"hidden\");\r\n-    if (topBar) topBar.style.top = `${promoHeight}px`; // se coloca debajo de promo\r\n-    if (header) header.style.top = `${totalAltura}px`;\r\n-    body.style.paddingTop = `${totalAltura}px`;\r\n-  }\r\n+    // 🔹 Scroll hacia abajo: ocultar barras superiores y subir header\r\n+    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+      if (promoBar) promoBar.classList.add(\"oculto\");\r\n+      if (topBar) topBar.classList.add(\"oculto\");\r\n+      if (header) header.classList.add(\"fixed\");\r\n \r\n-  // Actualizar último scroll\r\n-  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+      body.classList.add(\"scrolled\");\r\n+    } \r\n+    // 🔹 Scroll hacia arriba: mostrar todo de nuevo\r\n+    else if (currentScroll < lastScrollTop) {\r\n+      if (promoBar) promoBar.classList.remove(\"oculto\");\r\n+      if (topBar) topBar.classList.remove(\"oculto\");\r\n+      if (header) header.classList.remove(\"fixed\");\r\n+\r\n+      body.classList.remove(\"scrolled\");\r\n+    }\r\n+\r\n+    // Actualizar último scroll\r\n+    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n+  });\r\n });\r\n-});\r\n"
                },
                {
                    "date": 1760038258158,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -137,32 +137,42 @@\n // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n // =========================\r\n let lastScrollTop = 0;\r\n \r\n-window.addEventListener(\"scroll\", () => {\r\n-    const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+// 🔹 Ajustar el padding inicial del body\r\n+  const ajustarPadding = () => {\r\n     const promoHeight = promoBar?.offsetHeight || 0;\r\n     const topHeight = topBar?.offsetHeight || 0;\r\n     const headerHeight = header?.offsetHeight || 0;\r\n     const totalAltura = promoHeight + topHeight + headerHeight;\r\n+    body.style.paddingTop = `${totalAltura}px`;\r\n+  };\r\n \r\n-    // 🔹 Scroll hacia abajo: ocultar barras superiores y subir header\r\n+  ajustarPadding();\r\n+  window.addEventListener(\"resize\", ajustarPadding);\r\n+\r\n+  // 🔹 Evento de scroll\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+\r\n     if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-      if (promoBar) promoBar.classList.add(\"oculto\");\r\n-      if (topBar) topBar.classList.add(\"oculto\");\r\n-      if (header) header.classList.add(\"fixed\");\r\n-\r\n+      // Scroll hacia abajo → ocultar barras\r\n+      promoBar?.classList.add(\"oculto\");\r\n+      topBar?.classList.add(\"oculto\");\r\n+      header?.classList.add(\"fixed\");\r\n       body.classList.add(\"scrolled\");\r\n-    } \r\n-    // 🔹 Scroll hacia arriba: mostrar todo de nuevo\r\n-    else if (currentScroll < lastScrollTop) {\r\n-      if (promoBar) promoBar.classList.remove(\"oculto\");\r\n-      if (topBar) topBar.classList.remove(\"oculto\");\r\n-      if (header) header.classList.remove(\"fixed\");\r\n \r\n+      // 🔸 cuando se fija el header, solo deja el alto del header visible\r\n+      body.style.paddingTop = `${header.offsetHeight}px`;\r\n+    } else if (currentScroll < lastScrollTop) {\r\n+      // Scroll hacia arriba → mostrar todo\r\n+      promoBar?.classList.remove(\"oculto\");\r\n+      topBar?.classList.remove(\"oculto\");\r\n+      header?.classList.remove(\"fixed\");\r\n       body.classList.remove(\"scrolled\");\r\n+\r\n+      ajustarPadding(); // vuelve a su altura completa\r\n     }\r\n \r\n-    // Actualizar último scroll\r\n     lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n   });\r\n-});\r\n+});\n\\ No newline at end of file\n"
                },
                {
                    "date": 1760040057017,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -132,47 +132,48 @@\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n-  // =========================\r\n+ // =========================\r\n // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n // =========================\r\n let lastScrollTop = 0;\r\n \r\n // 🔹 Ajustar el padding inicial del body\r\n-  const ajustarPadding = () => {\r\n-    const promoHeight = promoBar?.offsetHeight || 0;\r\n-    const topHeight = topBar?.offsetHeight || 0;\r\n-    const headerHeight = header?.offsetHeight || 0;\r\n-    const totalAltura = promoHeight + topHeight + headerHeight;\r\n-    body.style.paddingTop = `${totalAltura}px`;\r\n-  };\r\n+const ajustarPadding = () => {\r\n+  const promoHeight = promoBar?.offsetHeight || 0;\r\n+  const topHeight = topBar?.offsetHeight || 0;\r\n+  const headerHeight = header?.offsetHeight || 0;\r\n+  const totalAltura = promoHeight + topHeight + headerHeight;\r\n+  body.style.paddingTop = `${totalAltura}px`;\r\n+};\r\n \r\n-  ajustarPadding();\r\n-  window.addEventListener(\"resize\", ajustarPadding);\r\n+// Esperar que todo cargue para evitar saltos\r\n+window.addEventListener(\"load\", ajustarPadding);\r\n+window.addEventListener(\"resize\", ajustarPadding);\r\n \r\n-  // 🔹 Evento de scroll\r\n-  window.addEventListener(\"scroll\", () => {\r\n-    const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+// 🔹 Evento de scroll\r\n+window.addEventListener(\"scroll\", () => {\r\n+  const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-      // Scroll hacia abajo → ocultar barras\r\n-      promoBar?.classList.add(\"oculto\");\r\n-      topBar?.classList.add(\"oculto\");\r\n-      header?.classList.add(\"fixed\");\r\n-      body.classList.add(\"scrolled\");\r\n+  if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n+    // 🔽 Bajando → ocultar barras y fijar header\r\n+    promoBar?.classList.add(\"oculto\");\r\n+    topBar?.classList.add(\"oculto\");\r\n+    header?.classList.add(\"fixed\");\r\n+    body.classList.add(\"scrolled\");\r\n \r\n-      // 🔸 cuando se fija el header, solo deja el alto del header visible\r\n-      body.style.paddingTop = `${header.offsetHeight}px`;\r\n-    } else if (currentScroll < lastScrollTop) {\r\n-      // Scroll hacia arriba → mostrar todo\r\n-      promoBar?.classList.remove(\"oculto\");\r\n-      topBar?.classList.remove(\"oculto\");\r\n-      header?.classList.remove(\"fixed\");\r\n-      body.classList.remove(\"scrolled\");\r\n+    // Mantener padding solo del header\r\n+    body.style.paddingTop = `${header.offsetHeight}px`;\r\n+  } else if (currentScroll < lastScrollTop - 10) {\r\n+    // 🔼 Subiendo → mostrar todo\r\n+    promoBar?.classList.remove(\"oculto\");\r\n+    topBar?.classList.remove(\"oculto\");\r\n+    header?.classList.remove(\"fixed\");\r\n+    body.classList.remove(\"scrolled\");\r\n \r\n-      ajustarPadding(); // vuelve a su altura completa\r\n-    }\r\n+    ajustarPadding();\r\n+  }\r\n \r\n-    lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;\r\n-  });\r\n+  lastScrollTop = Math.max(currentScroll, 0);\r\n+});\r\n });\n\\ No newline at end of file\n"
                },
                {
                    "date": 1760050430737,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,14 +108,14 @@\n \r\n         li.appendChild(ulSub);\r\n \r\n         a.addEventListener(\"click\", e => {\r\n-          e.preventDefault();\r\n-          const abierto = li.classList.contains(\"active\");\r\n-          // Cerrar todas las demás categorías\r\n-          menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-          if(!abierto) li.classList.add(\"active\");\r\n-        });\r\n+  e.preventDefault();\r\n+  const abierto = li.classList.contains(\"active\");\r\n+  // Cerrar todas las demás categorías\r\n+  menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+  if(!abierto) li.classList.add(\"active\");\r\n+});\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n     });\r\n"
                },
                {
                    "date": 1760050489661,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -109,13 +109,25 @@\n         li.appendChild(ulSub);\r\n \r\n         a.addEventListener(\"click\", e => {\r\n   e.preventDefault();\r\n-  const abierto = li.classList.contains(\"active\");\r\n+\r\n+  // Alternar la categoría clickeada\r\n+  const esActivo = li.classList.contains(\"active\");\r\n+  \r\n   // Cerrar todas las demás categorías\r\n-  menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-  if(!abierto) li.classList.add(\"active\");\r\n+  menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => {\r\n+    if(liAct !== li) liAct.classList.remove(\"active\");\r\n+  });\r\n+\r\n+  // Abrir o cerrar la categoría clickeada\r\n+  if(!esActivo){\r\n+    li.classList.add(\"active\");\r\n+  } else {\r\n+    li.classList.remove(\"active\");\r\n+  }\r\n });\r\n+\r\n       }\r\n \r\n       menuCategorias.appendChild(li);\r\n     });\r\n"
                },
                {
                    "date": 1760050590191,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -65,75 +65,76 @@\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-  // =====================================================\r\n-  // Construir menú dinámico\r\n-  // =====================================================\r\n-  const buildMenuFromData = (categorias) => {\r\n-    menuCategorias.innerHTML = \"\";\r\n+ // =====================================================\r\n+// Construir menú dinámico\r\n+// =====================================================\r\n+const buildMenuFromData = (categorias) => {\r\n+  menuCategorias.innerHTML = \"\";\r\n \r\n-    categorias.forEach(cat => {\r\n-      const li = document.createElement(\"li\");\r\n-      const a = document.createElement(\"a\");\r\n-      a.href = \"#\"; \r\n-      a.textContent = cat.nombre;\r\n-      li.appendChild(a);\r\n+  categorias.forEach(cat => {\r\n+    const li = document.createElement(\"li\");\r\n+    const a = document.createElement(\"a\");\r\n+    a.href = \"#\"; \r\n+    a.textContent = cat.nombre;\r\n+    li.appendChild(a);\r\n \r\n-      if(cat.subcategorias?.length){\r\n-        const ulSub = document.createElement(\"ul\");\r\n+    if(cat.subcategorias?.length){\r\n+      const ulSub = document.createElement(\"ul\");\r\n \r\n-        cat.subcategorias.forEach(sub => {\r\n-          const liSub = document.createElement(\"li\");\r\n-          const aSub = document.createElement(\"a\");\r\n-          aSub.href = \"#\"; \r\n-          aSub.textContent = sub.nombre;\r\n+      cat.subcategorias.forEach(sub => {\r\n+        const liSub = document.createElement(\"li\");\r\n+        const aSub = document.createElement(\"a\");\r\n+        aSub.href = \"#\"; \r\n+        aSub.textContent = sub.nombre;\r\n \r\n-          aSub.addEventListener(\"click\", e => {\r\n-            e.preventDefault();\r\n-            mostrarProductosPorSubcategoria(sub.id);\r\n+        aSub.addEventListener(\"click\", e => {\r\n+          e.preventDefault();\r\n+          mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            // Limpiar todas las clases activas\r\n-            menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-            \r\n-            // Marcar la categoría y subcategoría como activas\r\n-            li.classList.add(\"active\"); \r\n-            liSub.classList.add(\"active\");\r\n+          // Limpiar todas las clases activas\r\n+          menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+          \r\n+          // Marcar la categoría y subcategoría como activas\r\n+          li.classList.add(\"active\"); \r\n+          liSub.classList.add(\"active\");\r\n \r\n-            cerrarMenu(); // Cierra menú lateral\r\n-          });\r\n-\r\n-          liSub.appendChild(aSub);\r\n-          ulSub.appendChild(liSub);\r\n+          cerrarMenu(); // Cierra menú lateral\r\n         });\r\n \r\n-        li.appendChild(ulSub);\r\n+        liSub.appendChild(aSub);\r\n+        ulSub.appendChild(liSub);\r\n+      });\r\n \r\n-        a.addEventListener(\"click\", e => {\r\n-  e.preventDefault();\r\n+      li.appendChild(ulSub);\r\n \r\n-  // Alternar la categoría clickeada\r\n-  const esActivo = li.classList.contains(\"active\");\r\n-  \r\n-  // Cerrar todas las demás categorías\r\n-  menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => {\r\n-    if(liAct !== li) liAct.classList.remove(\"active\");\r\n-  });\r\n+      // Listener para abrir/cerrar categoría principal\r\n+      a.addEventListener(\"click\", e => {\r\n+        e.preventDefault();\r\n \r\n-  // Abrir o cerrar la categoría clickeada\r\n-  if(!esActivo){\r\n-    li.classList.add(\"active\");\r\n-  } else {\r\n-    li.classList.remove(\"active\");\r\n-  }\r\n-});\r\n+        // Verificar si la categoría ya estaba abierta\r\n+        const esActivo = li.classList.contains(\"active\");\r\n+        \r\n+        // Cerrar todas las demás categorías\r\n+        menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => {\r\n+          if(liAct !== li) liAct.classList.remove(\"active\");\r\n+        });\r\n \r\n-      }\r\n+        // Abrir o cerrar la categoría clickeada\r\n+        if(!esActivo){\r\n+          li.classList.add(\"active\");\r\n+        } else {\r\n+          li.classList.remove(\"active\");\r\n+        }\r\n+      });\r\n+    }\r\n \r\n-      menuCategorias.appendChild(li);\r\n-    });\r\n-  };\r\n+    menuCategorias.appendChild(li);\r\n+  });\r\n+};\r\n \r\n+\r\n   // =====================================================\r\n   // Cargar JSON\r\n   // =====================================================\r\n   fetch(\"productos.json\")\r\n"
                },
                {
                    "date": 1760050600856,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -132,9 +132,8 @@\n     menuCategorias.appendChild(li);\r\n   });\r\n };\r\n \r\n-\r\n   // =====================================================\r\n   // Cargar JSON\r\n   // =====================================================\r\n   fetch(\"productos.json\")\r\n"
                },
                {
                    "date": 1760050892679,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -65,75 +65,75 @@\n   };\r\n \r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n- // =====================================================\r\n+// =====================================================\r\n // Construir menú dinámico\r\n // =====================================================\r\n const buildMenuFromData = (categorias) => {\r\n   menuCategorias.innerHTML = \"\";\r\n \r\n   categorias.forEach(cat => {\r\n     const li = document.createElement(\"li\");\r\n     const a = document.createElement(\"a\");\r\n-    a.href = \"#\"; \r\n+    a.href = \"#\";\r\n     a.textContent = cat.nombre;\r\n     li.appendChild(a);\r\n \r\n+    // Subcategorías\r\n     if(cat.subcategorias?.length){\r\n       const ulSub = document.createElement(\"ul\");\r\n \r\n       cat.subcategorias.forEach(sub => {\r\n         const liSub = document.createElement(\"li\");\r\n         const aSub = document.createElement(\"a\");\r\n-        aSub.href = \"#\"; \r\n+        aSub.href = \"#\";\r\n         aSub.textContent = sub.nombre;\r\n \r\n         aSub.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n           mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-          // Limpiar todas las clases activas\r\n-          menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n-          \r\n-          // Marcar la categoría y subcategoría como activas\r\n-          li.classList.add(\"active\"); \r\n+          // Limpiar solo subcategorías activas\r\n+          menuCategorias.querySelectorAll(\"li ul li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+\r\n+          // Marcar subcategoría como activa\r\n           liSub.classList.add(\"active\");\r\n \r\n-          cerrarMenu(); // Cierra menú lateral\r\n+          cerrarMenu();\r\n         });\r\n \r\n         liSub.appendChild(aSub);\r\n         ulSub.appendChild(liSub);\r\n       });\r\n \r\n       li.appendChild(ulSub);\r\n+    }\r\n \r\n-      // Listener para abrir/cerrar categoría principal\r\n-      a.addEventListener(\"click\", e => {\r\n-        e.preventDefault();\r\n+    // Listener de la categoría (abre/cierra subcategorías)\r\n+    a.addEventListener(\"click\", e => {\r\n+      e.preventDefault();\r\n \r\n-        // Verificar si la categoría ya estaba abierta\r\n-        const esActivo = li.classList.contains(\"active\");\r\n-        \r\n-        // Cerrar todas las demás categorías\r\n-        menuCategorias.querySelectorAll(\"li.active\").forEach(liAct => {\r\n-          if(liAct !== li) liAct.classList.remove(\"active\");\r\n-        });\r\n+      const esActivo = li.classList.contains(\"active\");\r\n \r\n-        // Abrir o cerrar la categoría clickeada\r\n-        if(!esActivo){\r\n-          li.classList.add(\"active\");\r\n-        } else {\r\n-          li.classList.remove(\"active\");\r\n-        }\r\n+      // Cerrar todas las demás categorías\r\n+      menuCategorias.querySelectorAll(\"li\").forEach(liAct => {\r\n+        if(liAct !== li) liAct.classList.remove(\"active\");\r\n       });\r\n-    }\r\n \r\n+      // Abrir o cerrar la categoría clickeada\r\n+      if(!esActivo){\r\n+        li.classList.add(\"active\");\r\n+      } else {\r\n+        li.classList.remove(\"active\");\r\n+      }\r\n+    });\r\n+\r\n     menuCategorias.appendChild(li);\r\n   });\r\n };\r\n \r\n+\r\n   // =====================================================\r\n   // Cargar JSON\r\n   // =====================================================\r\n   fetch(\"productos.json\")\r\n"
                },
                {
                    "date": 1760050983796,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,34 +73,36 @@\n   menuCategorias.innerHTML = \"\";\r\n \r\n   categorias.forEach(cat => {\r\n     const li = document.createElement(\"li\");\r\n+\r\n+    // Enlace de categoría\r\n     const a = document.createElement(\"a\");\r\n     a.href = \"#\";\r\n     a.textContent = cat.nombre;\r\n     li.appendChild(a);\r\n \r\n     // Subcategorías\r\n-    if(cat.subcategorias?.length){\r\n+    if (cat.subcategorias?.length) {\r\n       const ulSub = document.createElement(\"ul\");\r\n \r\n       cat.subcategorias.forEach(sub => {\r\n         const liSub = document.createElement(\"li\");\r\n         const aSub = document.createElement(\"a\");\r\n         aSub.href = \"#\";\r\n         aSub.textContent = sub.nombre;\r\n \r\n+        // Click en subcategoría\r\n         aSub.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n-          mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-          // Limpiar solo subcategorías activas\r\n+          // Limpiar subcategorías activas\r\n           menuCategorias.querySelectorAll(\"li ul li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n \r\n-          // Marcar subcategoría como activa\r\n-          liSub.classList.add(\"active\");\r\n+          liSub.classList.add(\"active\"); // Activar subcategoría\r\n+          mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-          cerrarMenu();\r\n+          cerrarMenu(); // cerrar sidebar\r\n         });\r\n \r\n         liSub.appendChild(aSub);\r\n         ulSub.appendChild(liSub);\r\n@@ -108,25 +110,23 @@\n \r\n       li.appendChild(ulSub);\r\n     }\r\n \r\n-    // Listener de la categoría (abre/cierra subcategorías)\r\n+    // Click en categoría\r\n     a.addEventListener(\"click\", e => {\r\n       e.preventDefault();\r\n \r\n+      // Alternar la categoría clickeada\r\n       const esActivo = li.classList.contains(\"active\");\r\n \r\n       // Cerrar todas las demás categorías\r\n       menuCategorias.querySelectorAll(\"li\").forEach(liAct => {\r\n         if(liAct !== li) liAct.classList.remove(\"active\");\r\n       });\r\n \r\n       // Abrir o cerrar la categoría clickeada\r\n-      if(!esActivo){\r\n-        li.classList.add(\"active\");\r\n-      } else {\r\n-        li.classList.remove(\"active\");\r\n-      }\r\n+      if (!esActivo) li.classList.add(\"active\");\r\n+      else li.classList.remove(\"active\");\r\n     });\r\n \r\n     menuCategorias.appendChild(li);\r\n   });\r\n"
                },
                {
                    "date": 1760051196661,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,10 +73,8 @@\n   menuCategorias.innerHTML = \"\";\r\n \r\n   categorias.forEach(cat => {\r\n     const li = document.createElement(\"li\");\r\n-\r\n-    // Enlace de categoría\r\n     const a = document.createElement(\"a\");\r\n     a.href = \"#\";\r\n     a.textContent = cat.nombre;\r\n     li.appendChild(a);\r\n@@ -90,50 +88,38 @@\n         const aSub = document.createElement(\"a\");\r\n         aSub.href = \"#\";\r\n         aSub.textContent = sub.nombre;\r\n \r\n-        // Click en subcategoría\r\n         aSub.addEventListener(\"click\", e => {\r\n           e.preventDefault();\r\n+          mostrarProductosPorSubcategoria(sub.id);\r\n \r\n           // Limpiar subcategorías activas\r\n           menuCategorias.querySelectorAll(\"li ul li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n \r\n-          liSub.classList.add(\"active\"); // Activar subcategoría\r\n-          mostrarProductosPorSubcategoria(sub.id);\r\n-\r\n-          cerrarMenu(); // cerrar sidebar\r\n+          liSub.classList.add(\"active\"); // marcar subcategoría\r\n+          // No cerramos la categoría padre para que se mantenga abierta\r\n         });\r\n \r\n         liSub.appendChild(aSub);\r\n         ulSub.appendChild(liSub);\r\n       });\r\n \r\n       li.appendChild(ulSub);\r\n-    }\r\n \r\n-    // Click en categoría\r\n-    a.addEventListener(\"click\", e => {\r\n-      e.preventDefault();\r\n-\r\n-      // Alternar la categoría clickeada\r\n-      const esActivo = li.classList.contains(\"active\");\r\n-\r\n-      // Cerrar todas las demás categorías\r\n-      menuCategorias.querySelectorAll(\"li\").forEach(liAct => {\r\n-        if(liAct !== li) liAct.classList.remove(\"active\");\r\n+      // Click en categoría principal\r\n+      a.addEventListener(\"click\", e => {\r\n+        e.preventDefault();\r\n+        li.classList.toggle(\"active\"); // abre o cierra la sublista\r\n       });\r\n+    }\r\n \r\n-      // Abrir o cerrar la categoría clickeada\r\n-      if (!esActivo) li.classList.add(\"active\");\r\n-      else li.classList.remove(\"active\");\r\n-    });\r\n-\r\n     menuCategorias.appendChild(li);\r\n   });\r\n };\r\n \r\n \r\n+\r\n   // =====================================================\r\n   // Cargar JSON\r\n   // =====================================================\r\n   fetch(\"productos.json\")\r\n"
                },
                {
                    "date": 1760051624390,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,14 +1,14 @@\n-\r\n-  // =========================\r\n-  // ELEMENTOS PRINCIPALES\r\n-  // =========================\r\n+// =========================\r\n+// ELEMENTOS PRINCIPALES\r\n+// =========================\r\n document.addEventListener(\"DOMContentLoaded\", () => {\r\n   const menuToggle = document.getElementById(\"menu-toggle\");\r\n   const nav = document.getElementById(\"nav\");\r\n   const overlayMenu = document.getElementById(\"overlay-menu\");\r\n   const closeMenu = document.getElementById(\"close-menu\");\r\n   const menuCategorias = document.getElementById('menu-categorias');\r\n+  const toggleCategoriasBtn = document.getElementById(\"toggle-categorias\");\r\n   const contenedorProductos = document.getElementById(\"catalogo\");\r\n   const promoBar = document.querySelector(\".promo-bar\"); // Barra de promo\r\n   const topBar = document.querySelector(\".top-bar\");     // Barra superior\r\n   const header = document.querySelector(\".main-header\"); // Header principal\r\n@@ -59,66 +59,73 @@\n       `;\r\n       contenedorProductos.appendChild(card);\r\n     });\r\n \r\n-    // Auto-scroll al contenedor de productos\r\n     contenedorProductos.scrollIntoView({ behavior: \"smooth\" });\r\n   };\r\n-\r\n   window.mostrarProductosPorSubcategoria = mostrarProductosPorSubcategoria;\r\n \r\n-// =====================================================\r\n-// Construir menú dinámico\r\n-// =====================================================\r\n-const buildMenuFromData = (categorias) => {\r\n-  menuCategorias.innerHTML = \"\";\r\n+  // =====================================================\r\n+  // Ocultar la lista de categorías al inicio\r\n+  // =====================================================\r\n+  if(menuCategorias) menuCategorias.style.display = \"none\";\r\n \r\n-  categorias.forEach(cat => {\r\n-    const li = document.createElement(\"li\");\r\n-    const a = document.createElement(\"a\");\r\n-    a.href = \"#\";\r\n-    a.textContent = cat.nombre;\r\n-    li.appendChild(a);\r\n+  toggleCategoriasBtn?.addEventListener(\"click\", e => {\r\n+    e.preventDefault();\r\n+    if(!menuCategorias) return;\r\n+    menuCategorias.style.display = menuCategorias.style.display === \"block\" ? \"none\" : \"block\";\r\n+  });\r\n \r\n-    // Subcategorías\r\n-    if (cat.subcategorias?.length) {\r\n-      const ulSub = document.createElement(\"ul\");\r\n+  // =====================================================\r\n+  // Construir menú dinámico con subcategorías\r\n+  // =====================================================\r\n+  const buildMenuFromData = (categorias) => {\r\n+    menuCategorias.innerHTML = \"\";\r\n \r\n-      cat.subcategorias.forEach(sub => {\r\n-        const liSub = document.createElement(\"li\");\r\n-        const aSub = document.createElement(\"a\");\r\n-        aSub.href = \"#\";\r\n-        aSub.textContent = sub.nombre;\r\n+    categorias.forEach(cat => {\r\n+      const li = document.createElement(\"li\");\r\n+      const a = document.createElement(\"a\");\r\n+      a.href = \"#\";\r\n+      a.textContent = cat.nombre;\r\n+      li.appendChild(a);\r\n \r\n-        aSub.addEventListener(\"click\", e => {\r\n-          e.preventDefault();\r\n-          mostrarProductosPorSubcategoria(sub.id);\r\n+      // Subcategorías\r\n+      if (cat.subcategorias?.length) {\r\n+        const ulSub = document.createElement(\"ul\");\r\n \r\n-          // Limpiar subcategorías activas\r\n-          menuCategorias.querySelectorAll(\"li ul li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+        cat.subcategorias.forEach(sub => {\r\n+          const liSub = document.createElement(\"li\");\r\n+          const aSub = document.createElement(\"a\");\r\n+          aSub.href = \"#\";\r\n+          aSub.textContent = sub.nombre;\r\n \r\n-          liSub.classList.add(\"active\"); // marcar subcategoría\r\n-          // No cerramos la categoría padre para que se mantenga abierta\r\n-        });\r\n+          aSub.addEventListener(\"click\", e => {\r\n+            e.preventDefault();\r\n+            mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-        liSub.appendChild(aSub);\r\n-        ulSub.appendChild(liSub);\r\n-      });\r\n+            // Limpiar subcategorías activas\r\n+            menuCategorias.querySelectorAll(\"li ul li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n \r\n-      li.appendChild(ulSub);\r\n+            liSub.classList.add(\"active\"); // marcar subcategoría\r\n+            // No cerramos la categoría padre para que se mantenga abierta\r\n+          });\r\n \r\n-      // Click en categoría principal\r\n-      a.addEventListener(\"click\", e => {\r\n-        e.preventDefault();\r\n-        li.classList.toggle(\"active\"); // abre o cierra la sublista\r\n-      });\r\n-    }\r\n+          liSub.appendChild(aSub);\r\n+          ulSub.appendChild(liSub);\r\n+        });\r\n \r\n-    menuCategorias.appendChild(li);\r\n-  });\r\n-};\r\n+        li.appendChild(ulSub);\r\n \r\n+        // Click en categoría principal → alterna subcategorías\r\n+        a.addEventListener(\"click\", e => {\r\n+          e.preventDefault();\r\n+          li.classList.toggle(\"active\");\r\n+        });\r\n+      }\r\n \r\n+      menuCategorias.appendChild(li);\r\n+    });\r\n+  };\r\n \r\n   // =====================================================\r\n   // Cargar JSON\r\n   // =====================================================\r\n@@ -130,48 +137,40 @@\n       console.log(\"Menú cargado correctamente\");\r\n     })\r\n     .catch(e => console.error(\"Error cargando productos.json:\", e));\r\n \r\n- // =========================\r\n-// OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n-// =========================\r\n-let lastScrollTop = 0;\r\n+  // =========================\r\n+  // OCULTAR/MOSTRAR BARRAS AL SCROLL\r\n+  // =========================\r\n+  let lastScrollTop = 0;\r\n \r\n-// 🔹 Ajustar el padding inicial del body\r\n-const ajustarPadding = () => {\r\n-  const promoHeight = promoBar?.offsetHeight || 0;\r\n-  const topHeight = topBar?.offsetHeight || 0;\r\n-  const headerHeight = header?.offsetHeight || 0;\r\n-  const totalAltura = promoHeight + topHeight + headerHeight;\r\n-  body.style.paddingTop = `${totalAltura}px`;\r\n-};\r\n+  const ajustarPadding = () => {\r\n+    const promoHeight = promoBar?.offsetHeight || 0;\r\n+    const topHeight = topBar?.offsetHeight || 0;\r\n+    const headerHeight = header?.offsetHeight || 0;\r\n+    const totalAltura = promoHeight + topHeight + headerHeight;\r\n+    body.style.paddingTop = `${totalAltura}px`;\r\n+  };\r\n \r\n-// Esperar que todo cargue para evitar saltos\r\n-window.addEventListener(\"load\", ajustarPadding);\r\n-window.addEventListener(\"resize\", ajustarPadding);\r\n+  window.addEventListener(\"load\", ajustarPadding);\r\n+  window.addEventListener(\"resize\", ajustarPadding);\r\n \r\n-// 🔹 Evento de scroll\r\n-window.addEventListener(\"scroll\", () => {\r\n-  const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n+  window.addEventListener(\"scroll\", () => {\r\n+    const currentScroll = window.pageYOffset || document.documentElement.scrollTop;\r\n \r\n-  if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n-    // 🔽 Bajando → ocultar barras y fijar header\r\n-    promoBar?.classList.add(\"oculto\");\r\n-    topBar?.classList.add(\"oculto\");\r\n-    header?.classList.add(\"fixed\");\r\n-    body.classList.add(\"scrolled\");\r\n+    if (currentScroll > lastScrollTop && currentScroll > 100) {\r\n\\ No newline at end of file\n+      promoBar?.classList.add(\"oculto\");\r\n+      topBar?.classList.add(\"oculto\");\r\n+      header?.classList.add(\"fixed\");\r\n+      body.classList.add(\"scrolled\");\r\n+      body.style.paddingTop = `${header.offsetHeight}px`;\r\n+    } else if (currentScroll < lastScrollTop - 10) {\r\n+      promoBar?.classList.remove(\"oculto\");\r\n+      topBar?.classList.remove(\"oculto\");\r\n+      header?.classList.remove(\"fixed\");\r\n+      body.classList.remove(\"scrolled\");\r\n+      ajustarPadding();\r\n+    }\r\n \r\n-    // Mantener padding solo del header\r\n-    body.style.paddingTop = `${header.offsetHeight}px`;\r\n-  } else if (currentScroll < lastScrollTop - 10) {\r\n-    // 🔼 Subiendo → mostrar todo\r\n-    promoBar?.classList.remove(\"oculto\");\r\n-    topBar?.classList.remove(\"oculto\");\r\n-    header?.classList.remove(\"fixed\");\r\n-    body.classList.remove(\"scrolled\");\r\n-\r\n-    ajustarPadding();\r\n-  }\r\n-\r\n-  lastScrollTop = Math.max(currentScroll, 0);\r\n+    lastScrollTop = Math.max(currentScroll, 0);\r\n+  });\r\n });\r\n-});\n"
                },
                {
                    "date": 1760052568445,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,15 +66,14 @@\n \r\n   // =====================================================\r\n   // Ocultar la lista de categorías al inicio\r\n   // =====================================================\r\n-  if(menuCategorias) menuCategorias.style.display = \"none\";\r\n+  const toggleCategorias = document.getElementById('toggle-categorias'); // El enlace \"Categorías\"\r\n \r\n-  toggleCategoriasBtn?.addEventListener(\"click\", e => {\r\n-    e.preventDefault();\r\n-    if(!menuCategorias) return;\r\n-    menuCategorias.style.display = menuCategorias.style.display === \"block\" ? \"none\" : \"block\";\r\n-  });\r\n+toggleCategorias?.addEventListener('click', e => {\r\n+  e.preventDefault();\r\n+  menuCategorias.classList.toggle('activo'); // Muestra u oculta los li principales\r\n+});\r\n \r\n   // =====================================================\r\n   // Construir menú dinámico con subcategorías\r\n   // =====================================================\r\n@@ -172,5 +171,5 @@\n     }\r\n \r\n     lastScrollTop = Math.max(currentScroll, 0);\r\n   });\r\n-});\n\\ No newline at end of file\n+});\r\n"
                },
                {
                    "date": 1760052980790,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,58 +74,61 @@\n   menuCategorias.classList.toggle('activo'); // Muestra u oculta los li principales\r\n });\r\n \r\n   // =====================================================\r\n-  // Construir menú dinámico con subcategorías\r\n-  // =====================================================\r\n-  const buildMenuFromData = (categorias) => {\r\n-    menuCategorias.innerHTML = \"\";\r\n+// Construir menú dinámico con subcategorías\r\n+// =====================================================\r\n+const buildMenuFromData = (categorias) => {\r\n+  menuCategorias.innerHTML = \"\";\r\n \r\n-    categorias.forEach(cat => {\r\n-      const li = document.createElement(\"li\");\r\n-      const a = document.createElement(\"a\");\r\n-      a.href = \"#\";\r\n-      a.textContent = cat.nombre;\r\n-      li.appendChild(a);\r\n+  categorias.forEach(cat => {\r\n+    const li = document.createElement(\"li\");\r\n+    const a = document.createElement(\"a\");\r\n+    a.href = \"#\";\r\n+    a.textContent = cat.nombre;\r\n+    li.appendChild(a);\r\n \r\n-      // Subcategorías\r\n-      if (cat.subcategorias?.length) {\r\n-        const ulSub = document.createElement(\"ul\");\r\n+    // Subcategorías\r\n+    if (cat.subcategorias?.length) {\r\n+      const ulSub = document.createElement(\"ul\");\r\n \r\n-        cat.subcategorias.forEach(sub => {\r\n-          const liSub = document.createElement(\"li\");\r\n-          const aSub = document.createElement(\"a\");\r\n-          aSub.href = \"#\";\r\n-          aSub.textContent = sub.nombre;\r\n+      cat.subcategorias.forEach(sub => {\r\n+        const liSub = document.createElement(\"li\");\r\n+        const aSub = document.createElement(\"a\");\r\n+        aSub.href = \"#\";\r\n+        aSub.textContent = sub.nombre;\r\n \r\n-          aSub.addEventListener(\"click\", e => {\r\n-            e.preventDefault();\r\n-            mostrarProductosPorSubcategoria(sub.id);\r\n+        aSub.addEventListener(\"click\", e => {\r\n+          e.preventDefault();\r\n+          mostrarProductosPorSubcategoria(sub.id);\r\n \r\n-            // Limpiar subcategorías activas\r\n-            menuCategorias.querySelectorAll(\"li ul li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n+          // Limpiar subcategorías activas\r\n+          menuCategorias.querySelectorAll(\"li ul li.active\").forEach(liAct => liAct.classList.remove(\"active\"));\r\n \r\n-            liSub.classList.add(\"active\"); // marcar subcategoría\r\n-            // No cerramos la categoría padre para que se mantenga abierta\r\n-          });\r\n+          liSub.classList.add(\"active\"); // marcar subcategoría activa\r\n \r\n-          liSub.appendChild(aSub);\r\n-          ulSub.appendChild(liSub);\r\n+          // 🔹 Cerrar menú lateral al seleccionar subcategoría\r\n+          cerrarMenu();\r\n         });\r\n \r\n-        li.appendChild(ulSub);\r\n+        liSub.appendChild(aSub);\r\n+        ulSub.appendChild(liSub);\r\n+      });\r\n \r\n-        // Click en categoría principal → alterna subcategorías\r\n-        a.addEventListener(\"click\", e => {\r\n-          e.preventDefault();\r\n-          li.classList.toggle(\"active\");\r\n-        });\r\n-      }\r\n+      li.appendChild(ulSub);\r\n \r\n-      menuCategorias.appendChild(li);\r\n-    });\r\n-  };\r\n+      // Click en categoría principal → alterna subcategorías\r\n+      a.addEventListener(\"click\", e => {\r\n+        e.preventDefault();\r\n+        li.classList.toggle(\"active\");\r\n+      });\r\n+    }\r\n \r\n+    menuCategorias.appendChild(li);\r\n+  });\r\n+};\r\n+\r\n+\r\n   // =====================================================\r\n   // Cargar JSON\r\n   // =====================================================\r\n   fetch(\"productos.json\")\r\n"
                }
            ],
            "date": 1756837676171,
            "name": "Commit-0",
            "content": "// Seleccionamos elementos\r\nconst menuToggle = document.getElementById(\"menu-toggle\");\r\nconst nav = document.getElementById(\"nav\");\r\n\r\n// Función para abrir menú\r\nfunction showMenu() {\r\n  nav.classList.add(\"active\");\r\n  if (window.innerWidth <= 768) {\r\n    menuToggle.textContent = \"✖\"; // Cambiar icono en móvil\r\n  }\r\n}\r\n\r\n// Función para cerrar menú\r\nfunction hideMenu() {\r\n  nav.classList.remove(\"active\");\r\n  if (window.innerWidth <= 768) {\r\n    menuToggle.textContent = \"☰\"; // Restaurar icono en móvil\r\n  }\r\n}\r\n\r\n// --- DESKTOP: hover ---\r\nfunction activarEventosDesktop() {\r\n  menuToggle.addEventListener(\"mouseenter\", showMenu);\r\n  nav.addEventListener(\"mouseenter\", showMenu);\r\n\r\n  menuToggle.addEventListener(\"mouseleave\", () => {\r\n    setTimeout(() => {\r\n      if (!nav.matches(\":hover\") && !menuToggle.matches(\":hover\")) {\r\n        hideMenu();\r\n      }\r\n    }, 200);\r\n  });\r\n\r\n  nav.addEventListener(\"mouseleave\", () => {\r\n    setTimeout(() => {\r\n      if (!nav.matches(\":hover\") && !menuToggle.matches(\":hover\")) {\r\n        hideMenu();\r\n      }\r\n    }, 200);\r\n  });\r\n}\r\n\r\n// --- MOBILE: click ---\r\nfunction activarEventosMobile() {\r\n  menuToggle.addEventListener(\"click\", () => {\r\n    if (nav.classList.contains(\"active\")) {\r\n      hideMenu();\r\n    } else {\r\n      showMenu();\r\n    }\r\n  });\r\n}\r\n\r\n// --- Inicialización según ancho ---\r\nfunction inicializarMenu() {\r\n  if (window.innerWidth > 768) {\r\n    activarEventosDesktop();\r\n    hideMenu();\r\n  } else {\r\n    activarEventosMobile();\r\n    hideMenu();\r\n  }\r\n}\r\n\r\n// Ejecutar al cargar\r\ndocument.addEventListener(\"DOMContentLoaded\", inicializarMenu);\r\n\r\n// Reajustar al redimensionar\r\nwindow.addEventListener(\"resize\", () => {\r\n  hideMenu();\r\n  inicializarMenu();\r\n});\r\n"
        }
    ]
}